{"version":3,"file":"_id_-CqAVmqCd.js","sources":["../../../../pages/base/companies/[id].vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport { useCompanies } from '~/stores/companies';\r\nimport {useRoute} from \"vue-router\";\r\nimport TheTextContent from \"~/components/UI/TheTextContent.vue\";\r\nimport TheBreadcrumbs from \"~/components/UI/TheBreadcrumbs.vue\";\r\nimport ChatWindowSettingContent from \"~/components/Chat/ChatContent/ChatWindowSetting/ChatWindowSettingContent.vue\";\r\nimport TheModal from \"~/components/UI/TheModal.vue\";\r\nimport TheCheckbox from \"~/components/UI/TheCheckbox.vue\";\r\nimport TheInput from \"~/components/UI/TheInput.vue\";\r\n\r\nconst route = useRoute()\r\nconst currentCompany = useCompanies();\r\nconst params = {\r\n  page: 1,\r\n  limit: 1,\r\n}\r\n\r\nconst showModuleModal = ref(false)\r\nconst showAdminModal = ref(false)\r\nconst companyModules = ref([])\r\nlet adminForm = ref({\r\n  email: '',\r\n  password: '',\r\n  first_name: '',\r\n  last_name: '',\r\n  patronymic: '',\r\n  phone: '',\r\n  company_id: ''\r\n})\r\n\r\nconst openModuleModal = () => {\r\n  showModuleModal.value = !showModuleModal.value\r\n}\r\nconst openAdminModal = () => {\r\n  showAdminModal.value = !showAdminModal.value\r\n}\r\n\r\nconst changeModules = () => {\r\n  openModuleModal()\r\n  let array = []\r\n  companyModules.value.forEach((item) => {\r\n    if(item.value){\r\n      array.push(item.id)\r\n    }\r\n  })\r\n  currentCompany.editModules({id: route.params.id, data: array})\r\n}\r\n\r\nconst createAdministrator = () => {\r\n  openAdminModal()\r\n  adminForm.value.company_id = route.params.id\r\n  currentCompany.createAdministrator({data: adminForm.value, company_id: route.params.id})\r\n}\r\n\r\nwatchEffect(() => {\r\n  currentCompany.loadCompany({id: route.params.id})\r\n  currentCompany.loadModules()\r\n  currentCompany.loadCompanyAdministrators({company_id: route.params.id})\r\n})\r\n\r\nwatch(() => currentCompany.modules, (newModules) => {\r\n  companyModules.value = [];\r\n\r\n  currentCompany.modules.forEach((module) => {\r\n    const isModuleExists = currentCompany.company.modules.some(companyModule => companyModule.id === module.id);\r\n\r\n    companyModules.value.push({\r\n      ...module,\r\n      value: isModuleExists\r\n    });\r\n  });\r\n});\r\n\r\nwatchSyncEffect(() => {\r\n  useSeoMeta({\r\n    title: `${currentCompany.company.name}`\r\n  })\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <TheTextContent>\r\n      {{ $t('Страница компании ' + currentCompany.company.name) }}\r\n    </TheTextContent>\r\n    <div>\r\n      <div class=\"flex items-center gap-x-4\">\r\n        <TheBreadcrumbs :breadcrumb-link=\"'/base/companies'\">\r\n          {{ $t('Список компаний') }}\r\n        </TheBreadcrumbs>\r\n        <div>\r\n          <svg width=\"15px\" height=\"15px\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path class=\"dark:stroke-white stroke-black\"\r\n                  d=\"M14 12C14 14.7614 11.7614 17 9 17H7C4.23858 17 2 14.7614 2 12C2 9.23858 4.23858 7 7 7H7.5M10 12C10 9.23858 12.2386 7 15 7H17C19.7614 7 22 9.23858 22 12C22 14.7614 19.7614 17 17 17H16.5\"\r\n                  stroke-width=\"2\" stroke-linecap=\"round\"/>\r\n          </svg>\r\n        </div>\r\n        <TheBreadcrumbs>\r\n          {{ currentCompany.company.name }}\r\n        </TheBreadcrumbs>\r\n      </div>\r\n      <div class=\"flex items-start gap-10 w-full max-md:flex-col\">\r\n        <div class=\"flex flex-col gap-4 mt-10 w-8/12 max-md:w-full\">\r\n          <div class=\"flex flex-col gap-2\">\r\n            <p>\r\n              {{ $t('Описание') }}:\r\n            </p>\r\n            <p>\r\n              {{ currentCompany.company.description }}\r\n            </p>\r\n          </div>\r\n          <div class=\"flex flex-col gap-2\">\r\n            <p>\r\n              {{ $t('Email') }}:\r\n            </p>\r\n            <p>\r\n              {{ currentCompany.company.email }}\r\n            </p>\r\n          </div>\r\n          <div class=\"flex flex-col gap-2\">\r\n            <p>\r\n              {{ $t('Адрес') }}:\r\n            </p>\r\n            <p>\r\n              {{ currentCompany.company.address }}\r\n            </p>\r\n          </div>\r\n          <div class=\"flex flex-col gap-2\">\r\n            <p>\r\n              {{ $t('Администраторы компании') }}:\r\n            </p>\r\n            <div class=\"bg-bgWhite p-3 rounded-lg flex flex-col gap-3 items-start\">\r\n              <UITheButton\r\n                  @click=\"openAdminModal\"\r\n                  class=\"mb-2 border p-3 rounded-lg !text-black dark:!text-white\"\r\n              >\r\n                Добавить\r\n              </UITheButton>\r\n              <div\r\n                  v-for=\"(item, index) in currentCompany.company_administrators\"\r\n                  class=\"bg-bgWhite p-3 w-full border rounded-lg\"\r\n              >\r\n                {{ item.last_name + ' ' + item.first_name }}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"flex flex-col gap-2 w-4/12 max-md:w-full\">\r\n          <p>\r\n            {{ $t('Модули компании') }}:\r\n          </p>\r\n          <div\r\n              class=\"flex flex-col gap-3 bg-bgWhite p-3 rounded-lg max-h-[400px] min-h-[400px] h-full overflow-y-scroll\">\r\n            <UITheButton\r\n                @click=\"openModuleModal\"\r\n                class=\"mb-2 border p-3 rounded-lg !text-black dark:!text-white\"\r\n            >\r\n              Изменить\r\n            </UITheButton>\r\n            <div\r\n                v-for=\"(item, index) in currentCompany.company.modules\"\r\n                class=\"bg-bgWhite p-3 w-full border rounded-lg\"\r\n            >\r\n              {{ item.name }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <TheModal\r\n        :type=\"'resize'\"\r\n        v-if=\"showModuleModal\"\r\n        @showModal=\"\"\r\n    >\r\n      <button class=\"absolute top-3 right-3\" @click=\"openModuleModal\">\r\n        x\r\n      </button>\r\n      <div\r\n          class=\"flex flex-col gap-2 min-h-[400px] min-w-[400px] max-md:min-w-full\"\r\n      >\r\n        <p>\r\n          {{ $t('Модули') }}:\r\n        </p>\r\n        <div class=\"grid grid-cols-2 gap-3 max-md:grid-cols-1\">\r\n          <div\r\n              v-for=\"(item, index) in companyModules\"\r\n              class=\"bg-[#8881] p-3 w-full border rounded-lg\"\r\n          >\r\n            <TheCheckbox\r\n                :item=\"item\"\r\n            />\r\n          </div>\r\n        </div>\r\n        <UITheButton\r\n            class=\"mt-2 !text-black dark:!text-white\"\r\n            @click=\"changeModules\"\r\n        >\r\n          Сохранить\r\n        </UITheButton>\r\n      </div>\r\n    </TheModal>\r\n    <TheModal\r\n        :type=\"'resize'\"\r\n        v-if=\"showAdminModal\"\r\n        @showModal=\"\"\r\n    >\r\n      <button class=\"absolute top-3 right-3\" @click=\"openAdminModal\">\r\n        x\r\n      </button>\r\n      <div\r\n          class=\"flex flex-col gap-5\"\r\n      >\r\n        <p>\r\n          Создание администратора:\r\n        </p>\r\n        <div class=\"flex items-center gap-5 max-md:flex-col\">\r\n          <TheInput\r\n              :type=\"'default'\"\r\n              v-model=\"adminForm.first_name\"\r\n              class=\"bg-transparent bg-opacity-0 rounded-lg border-2 border-semiCyan outline-none max-md:w-full\"\r\n              type=\"text\"\r\n              placeholder=\"Имя\"\r\n          />\r\n          <TheInput\r\n              :type=\"'default'\"\r\n              v-model=\"adminForm.last_name\"\r\n              class=\"bg-transparent bg-opacity-0 rounded-lg border-2 border-semiCyan outline-none max-md:w-full\"\r\n              type=\"text\"\r\n              placeholder=\"Фамилия\"\r\n          />\r\n          <TheInput\r\n              :type=\"'default'\"\r\n              v-model=\"adminForm.patronymic\"\r\n              class=\"bg-transparent bg-opacity-0 rounded-lg border-2 border-semiCyan outline-none max-md:w-full\"\r\n              type=\"text\"\r\n              placeholder=\"Отчество\"\r\n          />\r\n        </div>\r\n        <div class=\"grid grid-cols-2 items-center gap-5 max-md:grid-cols-1\">\r\n          <TheInput\r\n              :type=\"'default'\"\r\n              v-model=\"adminForm.email\"\r\n              class=\"w-full bg-transparent bg-opacity-0 rounded-lg border-2 border-semiCyan outline-none\"\r\n              type=\"email\"\r\n              placeholder=\"Email\"\r\n          />\r\n          <TheInput\r\n              :type=\"'default'\"\r\n              v-model=\"adminForm.password\"\r\n              class=\"w-full bg-transparent bg-opacity-0 rounded-lg border-2 border-semiCyan outline-none\"\r\n              type=\"password\"\r\n              placeholder=\"Пароль\"\r\n          />\r\n        </div>\r\n        <TheInput\r\n            :type=\"'default'\"\r\n            v-model=\"adminForm.phone\"\r\n            class=\"w-[300px] max-md:w-full mx-auto bg-transparent bg-opacity-0 rounded-lg border-2 border-semiCyan outline-none\"\r\n            type=\"phone\"\r\n            placeholder=\"Номер телефона\"\r\n        />\r\n        <UITheButton\r\n            class=\"mt-2 !text-black dark:!text-white\"\r\n            @click=\"createAdministrator\"\r\n        >\r\n          Сохранить\r\n        </UITheButton>\r\n      </div>\r\n    </TheModal>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAUA,UAAM,QAAQ;AACd,UAAM,iBAAiB;AAMjB,UAAA,kBAAkB,IAAI,KAAK;AAC3B,UAAA,iBAAiB,IAAI,KAAK;AAC1B,UAAA,iBAAiB,IAAI,CAAA,CAAE;AAC7B,QAAI,YAAY,IAAI;AAAA,MAClB,OAAO;AAAA,MACP,UAAU;AAAA,MACV,YAAY;AAAA,MACZ,WAAW;AAAA,MACX,YAAY;AAAA,MACZ,OAAO;AAAA,MACP,YAAY;AAAA,IAAA,CACb;AAED,UAAM,kBAAkB,MAAM;AACZ,sBAAA,QAAQ,CAAC,gBAAgB;AAAA,IAAA;AAE3C,UAAM,iBAAiB,MAAM;AACZ,qBAAA,QAAQ,CAAC,eAAe;AAAA,IAAA;AAGzC,UAAM,gBAAgB,MAAM;AACV;AAChB,UAAI,QAAQ,CAAA;AACG,qBAAA,MAAM,QAAQ,CAAC,SAAS;AACrC,YAAG,KAAK,OAAM;AACN,gBAAA,KAAK,KAAK,EAAE;AAAA,QACpB;AAAA,MAAA,CACD;AACc,qBAAA,YAAY,EAAC,IAAI,MAAM,OAAO,IAAI,MAAM,OAAM;AAAA,IAAA;AAG/D,UAAM,sBAAsB,MAAM;AACjB;AACL,gBAAA,MAAM,aAAa,MAAM,OAAO;AAC3B,qBAAA,oBAAoB,EAAC,MAAM,UAAU,OAAO,YAAY,MAAM,OAAO,GAAA,CAAG;AAAA,IAAA;AAGzF,gBAAY,MAAM;AAChB,qBAAe,YAAY,EAAC,IAAI,MAAM,OAAO,IAAG;AAChD,qBAAe,YAAY;AAC3B,qBAAe,0BAA0B,EAAC,YAAY,MAAM,OAAO,IAAG;AAAA,IAAA,CACvE;AAED,UAAM,MAAM,eAAe,SAAS,CAAC,eAAe;AAClD,qBAAe,QAAQ;AAER,qBAAA,QAAQ,QAAQ,CAAC,WAAW;AACnC,cAAA,iBAAiB,eAAe,QAAQ,QAAQ,KAAK,CAAiB,kBAAA,cAAc,OAAO,OAAO,EAAE;AAE1G,uBAAe,MAAM,KAAK;AAAA,UACxB,GAAG;AAAA,UACH,OAAO;AAAA,QAAA,CACR;AAAA,MAAA,CACF;AAAA,IAAA,CACF;AAED,oBAAgB,MAAM;AACT,iBAAA;AAAA,QACT,OAAO,GAAG,eAAe,QAAQ,IAAI;AAAA,MAAA,CACtC;AAAA,IAAA,CACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}