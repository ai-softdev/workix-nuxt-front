{"version":3,"file":"chat-DlwsdOlC.js","sources":["../../../../components/Chat/ChatNav/UI/ChatNavHeaderElem.vue","../../../../components/Chat/ChatGroup/ChatGroupCreate.vue","../../../../components/Chat/ChatNav/ChatNavHeader.vue","../../../../components/Chat/ChatNav/ChatNavContentUser.vue","../../../../components/Chat/ChatNav/ChatNavContent.vue","../../../../components/Chat/ChatNav.vue","../../../../pages/base/chat.vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport {useChat} from \"~/stores/chat\";\r\nimport ChatNavHeaderSlot from \"~/components/Chat/ChatNav/UI/ChatNavHeaderSlot.vue\";\r\n\r\nconst chat = useChat()\r\ndefineProps({\r\n  activeNav: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"   select-none\">\r\n    <div\r\n        class=\"grid grid-cols-3 gap-2 transition-all duration-200 pb-3 border-b\"\r\n    >\r\n<!--      after:w-[60px] after:h-[5px] after:bg-semiCyan after:rounded-t-full after:transition-all after:absolute after:bottom-0-->\r\n<!--      :class=\"{'after:left-[0%]' : chat.displayChat === 'all', 'after:left-[36%] max-md:after:left-[45%] max-[625px]:after:left-[43%] max-[500px]:after:left-[42%] max-[488px]:after:left-[41.5%] max-[414px]:after:left-[40%] max-[385px]:after:left-[38%]' : chat.displayChat === 'users', 'after:left-[75%] max-md:after:left-[91%] max-[700px]:after:left-[89%] max-[580px]:after:left-[87%] max-[500px]:after:left-[85%] max-[500px]:after:left-[83%] max-[390px]:after:left-[81%] max-[345px]:after:left-[79%]' : chat.displayChat === 'groups'}\"-->\r\n      <ChatNavHeaderSlot\r\n          :active=\"chat.displayChat === 'all'\"\r\n          @click=\"chat.displayChat = 'all'\"\r\n      >\r\n        <template v-slot:ChatNavHeaderSvg>\r\n          <svg width=\"25\" height=\"26\" viewBox=\"0 0 25 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M5.61123 12.1009C5.53872 11.6336 5.50109 11.1549 5.50109 10.6673C5.50109 5.51266 9.70726 1.33398 14.8958 1.33398C20.0844 1.33398 24.2905 5.51266 24.2905 10.6673C24.2905 11.8318 24.076 12.9464 23.6839 13.9742C23.6024 14.1877 23.5616 14.2945 23.5432 14.3778C23.5249 14.4604 23.5177 14.5185 23.5158 14.6031C23.5138 14.6884 23.5253 14.7824 23.5485 14.9703L24.0181 18.7856C24.069 19.1986 24.0944 19.4051 24.0257 19.5552C23.9655 19.6868 23.8586 19.7912 23.7258 19.8484C23.5741 19.9136 23.3682 19.8834 22.9565 19.8231L19.2404 19.2784C19.0463 19.2499 18.9493 19.2357 18.8609 19.2363C18.7735 19.2367 18.7131 19.2431 18.6274 19.2611C18.541 19.2793 18.4305 19.3207 18.2096 19.4034C17.1791 19.7895 16.0623 20.0007 14.8958 20.0007C14.4079 20.0007 13.9288 19.9637 13.461 19.8925M7.40465 24.6673C10.8637 24.6673 13.6678 21.7945 13.6678 18.2507C13.6678 14.7068 10.8637 11.834 7.40465 11.834C3.9456 11.834 1.14149 14.7068 1.14149 18.2507C1.14149 18.963 1.2548 19.6482 1.46395 20.2885C1.55236 20.5591 1.59656 20.6945 1.61108 20.7869C1.62622 20.8835 1.62887 20.9376 1.62323 21.0351C1.61783 21.1286 1.59445 21.2342 1.5477 21.4453L0.834473 24.6673L4.32841 24.1901C4.51912 24.1641 4.61447 24.1511 4.69774 24.1517C4.78541 24.1522 4.83195 24.157 4.91793 24.1742C4.99959 24.1904 5.12099 24.2332 5.36379 24.319C6.00349 24.5447 6.6901 24.6673 7.40465 24.6673Z\" stroke=\"black\" stroke-width=\"1.4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\r\n          </svg>\r\n        </template>\r\n        <template v-slot:ChatNavHeaderText>\r\n          {{ $t('Все') }}\r\n        </template>\r\n      </ChatNavHeaderSlot>\r\n      <ChatNavHeaderSlot\r\n          :active=\"chat.displayChat === 'users'\"\r\n          @click=\"chat.displayChat = 'users'\"\r\n      >\r\n        <template v-slot:ChatNavHeaderSvg>\r\n          <svg width=\"25\" height=\"26\" viewBox=\"0 0 25 26\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M4.70349 21.6788C5.4132 20.0067 7.07021 18.834 9.00114 18.834H16.0011C17.9321 18.834 19.5891 20.0067 20.2988 21.6788M17.1678 10.084C17.1678 12.6613 15.0784 14.7507 12.5011 14.7507C9.92381 14.7507 7.83447 12.6613 7.83447 10.084C7.83447 7.50665 9.92381 5.41732 12.5011 5.41732C15.0784 5.41732 17.1678 7.50665 17.1678 10.084ZM24.1678 13.0007C24.1678 19.4439 18.9444 24.6673 12.5011 24.6673C6.05781 24.6673 0.834473 19.4439 0.834473 13.0007C0.834473 6.55733 6.05781 1.33398 12.5011 1.33398C18.9444 1.33398 24.1678 6.55733 24.1678 13.0007Z\" stroke=\"black\" stroke-width=\"1.4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\r\n          </svg>\r\n        </template>\r\n        <template v-slot:ChatNavHeaderText>\r\n          {{ $t('Личные') }}\r\n        </template>\r\n      </ChatNavHeaderSlot>\r\n      <ChatNavHeaderSlot\r\n          :active=\"chat.displayChat === 'groups'\"\r\n          @click=\"chat.displayChat = 'groups'\"\r\n      >\r\n        <template v-slot:ChatNavHeaderSvg>\r\n          <svg width=\"29\" height=\"28\" viewBox=\"0 0 29 28\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path d=\"M26.1678 24.5V22.1667C26.1678 19.9922 24.6805 18.1651 22.6678 17.647M18.5845 3.83922C20.2947 4.53151 21.5011 6.20819 21.5011 8.16667C21.5011 10.1251 20.2947 11.8019 18.5845 12.4941M20.3345 24.5C20.3345 22.3256 20.3345 21.2385 19.9792 20.3808C19.5056 19.2374 18.5971 18.3289 17.4536 17.8552C16.596 17.5 15.5089 17.5 13.3345 17.5H9.83447C7.66007 17.5 6.57288 17.5 5.71529 17.8552C4.57181 18.3289 3.66334 19.2374 3.1897 20.3808C2.83447 21.2385 2.83447 22.3256 2.83447 24.5M16.2511 8.16667C16.2511 10.744 14.1618 12.8333 11.5845 12.8333C9.00714 12.8333 6.91781 10.744 6.91781 8.16667C6.91781 5.58934 9.00714 3.5 11.5845 3.5C14.1618 3.5 16.2511 5.58934 16.2511 8.16667Z\" stroke=\"black\" stroke-width=\"1.4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\r\n          </svg>\r\n        </template>\r\n        <template v-slot:ChatNavHeaderText>\r\n          {{ $t('Группы') }}\r\n        </template>\r\n      </ChatNavHeaderSlot>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>","<script setup lang=\"ts\">\r\nimport TheButton from \"~/components/UI/TheButton.vue\";\r\nimport TheModal from \"~/components/UI/TheModal.vue\";\r\nimport {useChat} from \"~/stores/chat\";\r\nimport {useAuthStore} from \"~/stores/auth\";\r\nimport {useRouter} from \"vue-router\";\r\nimport TheFileInput from \"~/components/UI/TheFileInput.vue\";\r\nimport {Preview} from \"vue-advanced-cropper\";\r\nimport ChatUserCheckbox from \"~/components/Chat/UI/ChatUserCheckbox.vue\";\r\nimport {toast} from \"vue3-toastify\";\r\n\r\nconst userCount = ref([])\r\nconst groupName = ref<HTMLElement | null>(null)\r\nconst groupTitle = ref('')\r\nconst titleChecked = false\r\nconst chat = useChat()\r\nconst router = useRouter()\r\nconst currentUser = useAuthStore()\r\nconst setFocus = () => {\r\n  nextTick(() => {\r\n    groupName.value?.focus()\r\n  })\r\n}\r\nonMounted(() => {\r\n  groupTitle.value.trim()\r\n})\r\n\r\n\r\n</script>\r\n\r\n<template>\r\n  <div>\r\n    <TheButton\r\n        class=\"mb-6 !flex !items-center !justify-center gap-x-4 !p-2.5 hover:!bg-golden text-center w-full border !border-gainsboro rounded-full !text-black !transition-all ease-in-out duration-300\"\r\n        @click=\"chat.showGroupCreate = true; setFocus()\"\r\n    >\r\n      + {{ $t('Создать группу') }}\r\n    </TheButton>\r\n    <TheModal @click=\"setFocus()\" v-if=\"chat.showGroupCreate\"\r\n              @showModal=\"chat.showGroupCreate = false; chat.showGroupCreateChoice = false;  groupTitle = ''; chat.file = ''; chat.src = ''; chat.fileUpload = null; chat.results = {coordinates: null, image: null}\"\r\n              :type=\"'resize'\">\r\n      <div @click=\"setFocus()\" class=\"flex select-none gap-x-6 items-center\">\r\n        <div class=\"relative\" @mouseenter=\"chat.showImageChange = true\" @mouseleave=\"chat.showImageChange = false\">\r\n          <Transition name=\"fade\">\r\n            <TheFileInput :toward=\"'chat'\"/>\r\n          </Transition>\r\n          <div v-if=\"chat.results.image\">\r\n            <preview class=\"w-[80px] h-[80px] rounded-full\" :image=\"chat.results.image\"\r\n                     :coordinates=\"chat.results.coordinates\"/>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <p class=\"text-sm tracking-wider text-semiCyan transition-all\" :class=\"{'!text-red-400 transition-all' : titleChecked}\">{{ $t('Название группы') }}</p>\r\n          <input ref=\"groupName\" v-model=\"groupTitle\" class=\"border-b-2 bg-transparent border-b-semiCyan !outline-none transition-all\"\r\n                 :class=\"{'border-b-red-400 transition-all' : titleChecked}\" @change=\"titleChecked = false\"\r\n                 type=\"text\"/>\r\n        </div>\r\n      </div>\r\n      <div class=\"flex select-none text-sm justify-end gap-x-4 \">\r\n        <TheButton type=\"chat\"\r\n                   @click=\"chat.showGroupCreate = false; chat.showGroupCreateChoice = false; chat.isGroup = false; chat.file = ''; chat.src = '';  groupTitle = ''; chat.fileUpload = null; chat.results = {coordinates: null, image: null}\">\r\n          {{ $t('Отмена') }}\r\n        </TheButton>\r\n        <TheButton type=\"chat\" @click=\"()=>{\r\n          if(!groupTitle.length || !groupTitle.trim()) {\r\n           toast.error('Заполните поле', {autoClose: 1500, theme: 'auto'})\r\n           titleChecked = true\r\n          } else {\r\n            chat.showGroupCreate = false\r\n            chat.showGroupCreateChoice = true\r\n          }\r\n        }\">\r\n          {{ $t('Далее') }}\r\n        </TheButton>\r\n      </div>\r\n    </TheModal>\r\n    <TheModal :type=\"'resizeSendWindow'\" class=\"\" v-if=\"chat.showGroupCreateChoice\"\r\n              @showModal=\"chat.showGroupCreateChoice = false; chat.showGroupCreate = false; groupTitle = ''; chat.file = ''; chat.src = ''; chat.fileUpload = null; chat.results = {coordinates: null, image: null}\">\r\n      <p class=\"tracking-wider px-4 pt-4\">{{ $t('Добавить участников') }} <span\r\n        class=\"text-sm text-gray-400 ml-2\">{{ userCount.length + '/1000' }}</span></p>\r\n      <div class=\"w-full px-4 relative flex items-center\">\r\n        <div class=\"absolute rotate-90 ml-2\">\r\n          <svg class=\"dark:stroke-white stroke-black\" width=\"25px\" height=\"25px\" viewBox=\"0 0 24 24\" fill=\"none\"\r\n               xmlns=\"http://www.w3.org/2000/svg\">\r\n            <path\r\n              d=\"M14.9536 14.9458L21 21M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z\"\r\n              stroke-width=\"1.2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\r\n          </svg>\r\n        </div>\r\n        <input type=\"text\" class=\"w-full dark:bg-gray-700 outline-none pl-10 h-[50px]\" placeholder=\"Поиск...\"/>\r\n      </div>\r\n      <ChatUserCheckbox v-for=\"item in chat.get_chat_list.results.filter(e=> !e.is_group)\" :item=\"item\"/>\r\n      <div class=\"w-full px-4 h-[50px] flex items-center justify-end text-sm gap-x-4\">\r\n        <TheButton v-if=\"!chat.showSettingChat\" type=\"chat\"\r\n                   @click=\"chat.showGroupCreateChoice = false; chat.showGroupCreate = true; setFocus()\">\r\n          {{ $t('Назад') }}\r\n        </TheButton>\r\n        <TheButton v-else type=\"chat\" @click=\"chat.showGroupCreateChoice = false;\">\r\n          {{ $t('Отмена') }}\r\n        </TheButton>\r\n        <TheButton type=\"chat\" v-if=\"!chat.showSettingChat\"\r\n                   @click=\"chat.showGroupCreateChoice = false; chat.isGroup = true; chat.createChatUser({users: userCount.filter(e=>e.id).map(e=>e.id), name: groupTitle, photo: chat.fileUpload}).then(res=>{chat.isGroup = false})\">\r\n          {{ $t('Создать') }}\r\n        </TheButton>\r\n        <TheButton v-else type=\"chat\"\r\n                   @click=\"\">\r\n          {{ $t('Добавить') }}\r\n        </TheButton>\r\n      </div>\r\n    </TheModal>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>","<script setup lang=\"ts\">\r\nimport {useRoute} from \"vue-router\";\r\nimport {useUserStore} from \"~/stores/users\";\r\nimport {useChat} from \"~/stores/chat\";\r\nimport ChatNavHeaderElem from \"~/components/Chat/ChatNav/UI/ChatNavHeaderElem.vue\";\r\nimport TheButton from \"~/components/UI/TheButton.vue\";\r\nimport ChatGroupCreate from \"~/components/Chat/ChatGroup/ChatGroupCreate.vue\";\r\n\r\nconst userStore = useUserStore()\r\nconst chat = useChat()\r\nconst route = useRoute()\r\ndefineProps({\r\n  activeNav: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"px-4 pt-4\">\r\n    <form\r\n        @submit.prevent=\"userStore.searchUser({search: chat.searchElem})\"\r\n        class=\"relative\"\r\n    >\r\n      <label\r\n          @click=\"userStore.searchUser({search: chat.searchElem})\"\r\n          for=\"search-chat\"\r\n          class=\"absolute top-2.5 right-3\"\r\n      >\r\n        <img src=\"/icons/chat-search.svg\" alt=\"chat-search\">\r\n      </label>\r\n      <input\r\n          id=\"search-chat\"\r\n          v-model=\"chat.searchElem\"\r\n          class=\"w-full hover:bg-gray-50 focus:border-golden px-4 py-2.5 border rounded-full max-md:w-9/12 max-md:mx-auto block text-sm bg-white focus:bg-gray-50 text-black dark:focus:opacity-100 transition-all dark:bg-gray-600 dark:text-white outline-none\"\r\n          type=\"text\"\r\n          placeholder=\"Поиск...\"\r\n          :class=\"{'max-md:hidden' : !chat.activeChatNav && route.path !== '/base/chat'}\"\r\n      >\r\n    </form>\r\n    <div class=\"mt-6\" v-if=\"chat.windowWidth < 768 || chat.windowWidth > 768\">\r\n      <ChatGroupCreate/>\r\n      <ChatNavHeaderElem/>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>","<script setup lang=\"ts\">\r\nimport {useChat} from \"~/stores/chat\";\r\nimport {useAuthStore} from \"~/stores/auth\";\r\nimport {useUserStore} from \"~/stores/users\";\r\nimport {useRoute} from \"vue-router\";\r\nimport TheChatAvatar from \"~/components/Chat/ChatNav/UI/TheChatAvatar.vue\";\r\nimport nuxtStorage from \"nuxt-storage/nuxt-storage\";\r\nconst userStore = useUserStore()\r\nconst chatStore = useChat()\r\nconst user = useAuthStore()\r\nconst route = useRoute()\r\n\r\ndefineProps({\r\n  dragClass: {\r\n    type: Boolean,\r\n    default: false,\r\n  }\r\n})\r\n\r\nfunction message(chat_id: Number) {\r\n  let socket = new WebSocket(`wss://buildwithus.ai-softdev.com/ws/chat/${chat_id}?token=${nuxtStorage.localStorage.getData('token')}`)\r\n  socket.onmessage = (data) => {\r\n    let msg = JSON.parse(data.data.message)\r\n    console.log(msg)\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <NuxtLink :to=\"`/base/chat/${chat.id}`\"\r\n            v-for=\"chat in chatStore.get_chat_list.results?.filter((e)=> chatStore.displayChat === 'all' || e.is_group === true && chatStore.displayChat === 'groups' || e.is_group === false && chatStore.displayChat === 'users')\"\r\n            @click=\"chatStore.activeChatNav = false; message(chat.id);  chatStore.showPinnedWindow = false; chatStore.messageUpdate = {}; chatStore.messageForwarded = {}; chatStore.messageReplied = { }; chatStore.showChatInfo = false; chatStore.showGroupCreateChoice = false\"\r\n            class=\"flex justify-between px-4 gap-x-2 dark:hover:bg-gray-500 hover:bg-azure  hover:!bg-opacity-10 cursor-pointer transition-all duration-200 py-2\"\r\n            @dragenter=\"chat.id ? dragClass = true : dragClass = false\"\r\n            @dragleave=\"dragClass = false\"\r\n            :class=\"{'dark:hover:!bg-semiCyan ' : route.path === `/base/chat/${chat.id}`, 'hover:!bg-cyan' : route.path === `/base/chat/${chat.id}`, '!bg-blue-400' : dragClass && chat.id === chat.id}\">\r\n    <div class=\"flex gap-x-2\">\r\n      <TheChatAvatar :chat=\"chat\"/>\r\n      <div class=\"text-sm break-words\">\r\n        <p v-if=\"chat.user?.id !== user.user.id && chat.user?.id\" class=\"text-black dark:text-white font-bold\">\r\n          {{ user.user.id !== chat.user?.id ? (chat.user.first_name + ' ' + chat.user.last_name) : (user.user.first_name + ' ' + user.user.last_name)}}</p>\r\n        <p v-else-if=\"!chat.user?.id && !chat.is_group\" class=\"text-black font-bold dark:text-white\">{{ $t('Избранное') }}</p>\r\n        <p v-else-if=\"chat.is_group\" class=\"text-black dark:text-white font-bold\">{{chat.name}}</p>\r\n        <p v-if=\"chat.last_message.text && !chat.last_message.file_name\" class=\"text-gray-400\" :class=\"{'text-gray-500 dark:text-white' : route.path === `/base/chat/${chat.id}`}\">\r\n          {{ chat.last_message.text?.length > 15 ? chat.last_message.text.slice(0, 15) + '...' : chat.last_message.text }}</p>\r\n        <p v-else-if=\"chat.last_message.text && chat.last_message.file_name\" class=\"text-gray-400\" :class=\"{'text-gray-500 dark:text-white' : route.path === `/base/chat/${chat.id}`}\"><span>{{chat.last_message.file_name.length > 20 ? chat.last_message.file_name.slice(0,15) + '...' : chat.last_message.file_name}}</span>{{', ' + chat.last_message.text}}</p>\r\n        <p v-else-if=\"!chat.last_message.text && chat.last_message.file_name\" class=\"text-gray-400\" :class=\"{'text-gray-500 dark:text-white' : route.path === `/base/chat/${chat.id}`}\">{{chat.last_message.file_name.length > 20 ? chat.last_message.file_name.slice(0,20) + '...' : chat.last_message.file_name}}</p>\r\n      </div>\r\n    </div>\r\n    <div class=\"text-[12px] flex gap-x-1\">\r\n      <div v-if=\"chat.user?.id\">\r\n        <svg v-if=\"chat.last_message.sender.id === user.user.id\" class=\"fill-semiCyan\" :class=\"{'fill-white' : route.path === `/base/chat/${chat.id}`}\" width=\"20px\"\r\n             height=\"20px\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n          <path v-if=\"chat.last_message.text?.length > 0\" fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M15.4933 6.93502C15.8053 7.20743 15.8374 7.68122 15.565 7.99325L7.70786 16.9933C7.56543 17.1564 7.35943 17.25 7.14287 17.25C6.9263 17.25 6.72031 17.1564 6.57788 16.9933L3.43502 13.3933C3.16261 13.0812 3.19473 12.6074 3.50677 12.335C3.8188 12.0626 4.29259 12.0947 4.565 12.4068L7.14287 15.3596L14.435 7.00677C14.7074 6.69473 15.1812 6.66261 15.4933 6.93502Z\"/>\r\n          <path v-if=\"chat.last_message.read !== false\" fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n                d=\"M20.5175 7.01946C20.8174 7.30513 20.829 7.77986 20.5433 8.07981L11.9716 17.0798C11.8201 17.2389 11.6065 17.3235 11.3872 17.3114C11.1679 17.2993 10.9649 17.1917 10.8318 17.0169L10.4035 16.4544C10.1526 16.1249 10.2163 15.6543 10.5458 15.4034C10.8289 15.1878 11.2161 15.2044 11.4787 15.4223L19.4571 7.04531C19.7428 6.74537 20.2175 6.73379 20.5175 7.01946Z\"/>\r\n        </svg>\r\n      </div>\r\n      <p class=\"text-gray-400\" :class=\"{'text-white' : route.path === `/base/chat/${chat.id}`}\">\r\n        {{ chat.last_message.created_at ? new Date(chat.last_message.created_at).toLocaleTimeString().slice(0, 5) : '' }}</p>\r\n    </div>\r\n  </NuxtLink>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>","<script setup lang=\"ts\">\r\nimport TheSceleton from \"~/components/UI/TheSceleton.vue\";\r\nimport {useUserStore} from \"~/stores/users\";\r\nimport {useChat} from \"~/stores/chat\";\r\nimport {useAuthStore} from \"~/stores/auth\";\r\nimport {useRoute} from \"vue-router\";\r\nimport ChatNavContentUser from \"~/components/Chat/ChatNav/ChatNavContentUser.vue\";\r\nimport {setFocus} from \"~/hooks/ElemUI\";\r\n\r\nconst userStore = useUserStore()\r\nconst chatStore = useChat()\r\nconst user = useAuthStore()\r\nconst route = useRoute()\r\n\r\n</script>\r\n\r\n\r\n<template>\r\n  <div class=\"h-[80%] max-md:h-[80%] overflow-y-auto mt-4 max-md:w-full\">\r\n    <div\r\n        v-if=\"chatStore.searchElem === ''\"\r\n        class=\"flex flex-col mb-20\"\r\n    >\r\n      <ChatNavContentUser\r\n          v-if=\"userStore.get_user_list.results\"\r\n      />\r\n      <div v-for=\"i in 4\" v-else class=\"flex justify-center relative flex-col items-center mb-2\">\r\n        <TheSceleton class=\"dark:opacity-20 opacity-60\" width=\"90%\" height=\"70px\" border-radius=\"10px\">\r\n        </TheSceleton>\r\n        <div class=\"absolute left-6 max-md:left-10 flex items-center\">\r\n          <TheSceleton class=\"dark:opacity-20\" width=\"50px\" height=\"50px\" border-radius=\"100%\"></TheSceleton>\r\n          <div class=\"ml-4 flex flex-col dark:opacity-20 gap-y-2\">\r\n            <TheSceleton class=\"\" width=\"150px\" height=\"10px\" border-radius=\"4px\"></TheSceleton>\r\n            <TheSceleton class=\"\" width=\"150px\" height=\"10px\" border-radius=\"4px\"></TheSceleton>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div v-if=\"chatStore.searchElem !== ''\" class=\"\">\r\n      <NuxtLink :to=\"`/base/chat/${chatStore.get_user_chat?.id}`\" v-for=\"userSearchList in userStore.get_user_search.results\"\r\n                @click=\"userSearchList.id !== chatStore.get_user_chat.user?.id ? chatStore.createChatUser({user_id: userSearchList.id}) : ()=>{\r\n                  chatStore.flag = false;\r\n                  nextTick(()=>{\r\n                    chatStore.flag = true\r\n                  })\r\n                }; chatStore.showPinnedWindow = false; chatStore.searchElem = '' ; chatStore.activeChatNav = false\"\r\n                class=\"flex items-center px-4 gap-x-2 dark:hover:bg-gray-500 hover:bg-azure !bg-opacity-10 cursor-pointer transition-all duration-200 p-1\"\r\n                :class=\"{'dark:hover:!bg-semiCyan' : route.path === `/base/chat/${userSearchList.id}`, 'hover:!bg-cyan' : route.path === `/base/chat/${userSearchList.id}`}\">\r\n        <img class=\"w-[50px] h-[50px] rounded-full\" :src=\"userSearchList.photo\" alt=\"use-photo\">\r\n        <p class=\"text-sm break-words font-bold\">{{ userSearchList.first_name + ' ' + userSearchList.last_name }}</p>\r\n      </NuxtLink>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>","<script setup lang=\"ts\">\r\nimport {useChat} from \"~/stores/chat\";\r\nimport {useUserStore} from \"~/stores/users\";\r\nimport {useRoute} from \"vue-router\";\r\nimport {useRouter} from \"vue-router\";\r\nimport {useAuthStore} from \"~/stores/auth\";\r\nimport TheSceleton from \"~/components/UI/TheSceleton.vue\";\r\nimport ChatNavHeader from \"~/components/Chat/ChatNav/ChatNavHeader.vue\";\r\nimport ChatNavContent from \"~/components/Chat/ChatNav/ChatNavContent.vue\";\r\ndefineProps({\r\n  activeNav: {\r\n    type:Boolean,\r\n    default: true\r\n  }\r\n})\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst userStore = useUserStore()\r\nconst chatStore = useChat()\r\nconst user = useAuthStore()\r\nonMounted(()=>{\r\n  chatStore.windowWidth = window.innerWidth\r\n})\r\n</script>\r\n\r\n<template>\r\n  <div class=\"h-full\" >\r\n    <ChatNavHeader/>\r\n    <ChatNavContent class=\"\" @dragenter=\"chatStore.showDragInfo = false\"></ChatNavContent>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n*{\r\n  ::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n}\r\n</style>","<script setup lang=\"ts\">\r\nimport {useUserStore} from \"~/stores/users\";\r\nimport {useChat} from \"~/stores/chat\";\r\nimport {useRoute} from \"vue-router\";\r\nimport ChatNav from \"~/components/Chat/ChatNav.vue\"\r\nimport ChatCropper from \"~/components/Chat/UI/ChatCropper.vue\";\r\nimport {useAuthStore} from \"~/stores/auth\";\r\nimport {useCompanies} from \"~/stores/companies\";\r\n\r\nconst windowWidth = ref(0)\r\nconst activeNav = ref(true)\r\nconst route = useRoute()\r\nconst router = useRouter()\r\nconst chatStore = useChat()\r\nconst userStore = useUserStore()\r\nconst loadAuthStore = useAuthStore()\r\nconst company = useCompanies()\r\n\r\nchatStore.loadChatList({page: 1, limit: 100})\r\nuserStore.loadUserList({query: '', user_type: 'user-list', page: 1, limit: 10000})\r\nonMounted(() => {\r\n  windowWidth.value = window.innerWidth\r\n  if (route.path === '/base/chat') {\r\n    activeNav.value = true\r\n  } else if (route.path === `/base/chat/${chatStore.userChat?.id}`) {\r\n    activeNav.value = false\r\n  }\r\n})\r\nonUnmounted(() => {\r\n  chatStore.showGroupCreateChoice = false;\r\n  chatStore.showGroupCreate = false;\r\n  chatStore.file = '';\r\n  chatStore.src = '';\r\n  chatStore.fileUpload = null;\r\n  chatStore.results = {coordinates: null, image: null}\r\n})\r\n\r\n\r\nwatch(() => loadAuthStore.user, (newValue) => {\r\n  if(loadAuthStore?.user?.role?.name_en === 'admin'){\r\n    if (window.history.length > 1) {\r\n      router.push('/base/profile');\r\n    } else {\r\n      router.push('/');\r\n    }\r\n  }\r\n})\r\nwatch(() => company.company, (newValue) => {\r\n  let permission = company.company.modules?.find(item => item.name_en === 'chat')\r\n  if(!permission){\r\n    if (window.history.length > 1) {\r\n      router.push('/base/profile');\r\n    } else {\r\n      router.push('/');\r\n    }\r\n  }\r\n})\r\n\r\nuseSeoMeta({\r\n  title: 'Чат',\r\n  description: 'Интерактивный чат для пользователей'\r\n})\r\n</script>\r\n\r\n\r\n<template>\r\n  <div class=\"!mx-0 !p-10 max-[768px]:!p-0\">\r\n    <div\r\n      class=\"bg-white border flex w-full border-t border-t-gray-100 dark:text-white rounded-3xl shadow-chat overflow-hidden\">\r\n      <div\r\n        class=\"max-md:absolute h-screen overflow-hidden relative z-[12] rounded-l-3xl dark:bg-gray-700 border-r bg-white transition-all duration-300 w-[320px]\"\r\n        :class=\"{'max-md:w-0' : !chatStore.activeChatNav || route.path === `/base/chat/${route.params.id}`, 'max-md:w-full ' : route.path === `/base/chat`, 'w-[320px]' : !userStore.get_user_list.results || !chatStore.activeChatNav}\">\r\n        <ChatNav/>\r\n      </div>\r\n      <div class=\"w-11/12 relative overflow-hidden max-lg:w-9/12 max-md:w-full h-screen\">\r\n        <ClientOnly>\r\n          <NuxtPage></NuxtPage>\r\n          <ChatCropper></ChatCropper>\r\n        </ClientOnly>\r\n        <div v-if=\"route.path === '/base/chat'\"\r\n             class=\"flex items-center justify-center my-auto w-full h-full text-center rounded-full px-2\">\r\n          <p class=\"bg-black bg-opacity-5 px-10 py-2 rounded-full\">\r\n            {{ $t('Выберите контакт для сообщения') }}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n\r\n</style>"],"names":["useRouter"],"mappings":"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"}