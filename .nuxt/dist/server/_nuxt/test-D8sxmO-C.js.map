{"version":3,"file":"test-D8sxmO-C.js","sources":["../../../../stores/test.ts"],"sourcesContent":["import {defineStore} from \"pinia\";\nimport {useAuthStore} from \"~/stores/auth\";\nimport {toast} from \"vue3-toastify\";\nimport axios from \"~/composables/axios\";\nimport type {Router} from \"vue-router\";\nimport nuxtStorage from \"nuxt-storage/nuxt-storage\";\nexport const useTestList = defineStore('test-list', {\n  state: () => ({\n    test: {},\n    testIQ: {},\n    testSpecial: {},\n    currentTest: {},\n    exam: {},\n  }),\n  getters: {\n    get_all_exam(exam) {\n      return this.exam\n    },\n    get_test(test) {\n      return this.test\n    },\n    get_current_test(currentTest) {\n      return this.currentTest\n    },\n    get_all_test(test) {\n      return this.test\n    },\n    get_test_iq(testIQ) {\n      return this.testIQ\n    },\n    get_test_special(testSpecial) {\n      return this.testSpecial\n    }\n  },\n  actions: {\n    async loadAllTest(params: { page: number, limit: number, usual?: number }) {\n      axios.get(`test/test-list?page=${params.page}&limit=${params.limit}&usual=${params.usual}`, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(response => {\n        if(params.usual !== 0) {\n          this.testIQ = response.data\n        } else {\n          this.testSpecial = response.data\n        }\n      })\n    },\n    async loadExam() {\n      axios.get(`exam/exam-list`, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        this.test = res.data\n      })\n    },\n    async loadCurrentTest() {\n      axios.get(`exam/current-test`, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        this.currentTest = res.data\n      }).catch(e=>{\n        useAuthStore().exam_active = false\n      })\n    },\n\n    async testStart(params: { usual: any }, router: Router) {\n      axios.post(`exam/start`, {usual: params.usual}, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        this.test = res.data\n        this.loadCurrentTest()\n        useAuthStore().exam_active = true\n        useAuthStore().loadCurrentUser()\n        router.push('/base/tests/exam')\n      })\n    },\n    async testAnswer(params: { answer: any, test_id: any }, router: Router) {\n      axios.post(`exam/answer`, {\n        test_id: params.test_id,\n        answer: params.answer\n      }, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        this.loadCurrentTest()\n        useAuthStore().loadCurrentUser()\n      }).catch(e => {\n        router.push('/base/tests')\n      })\n    },\n    async createTest(params: { test: any, options: any, answer: any }) {\n      axios.post(`test/create`, {\n        answer_text: params.answer,\n        options_list: params.options,\n        question: params.test.question,\n        department_id: params.test.department_id\n      }, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        this.test = res.data\n        toast.success('Тест успешно создан', {autoClose: 1500, theme: 'auto'})\n      })\n    },\n    async deleteTest(params: { test_id: number }) {\n      axios.delete(`test/delete/${params.test_id}`, {\n        headers: {\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\n        }\n      }).then(res => {\n        toast.success('Тест успешно удалён', {autoClose: 1500, theme: 'auto'})\n        this.test = res.data\n        this.loadAllTest({page: 1, limit: 20})\n      }).catch(e => {\n        toast('Ошибка', {theme: \"auto\", autoClose: 1500})\n      })\n    }\n  }\n})\n"],"names":[],"mappings":"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"}