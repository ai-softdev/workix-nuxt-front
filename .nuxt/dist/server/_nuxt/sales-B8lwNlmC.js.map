{"version":3,"file":"sales-B8lwNlmC.js","sources":["../../../../stores/sales.ts"],"sourcesContent":["import {defineStore} from \"pinia\";\r\nimport axios from \"~/composables/axios\";\r\nimport {toast} from \"vue3-toastify\";\r\nimport nuxtStorage from \"nuxt-storage/nuxt-storage\";\r\nexport const useSales = defineStore('sales', {\r\n    state:() => ({\r\n        sales: {}\r\n    }),\r\n    getters: {\r\n        get_objects(object) {\r\n            return this.objects\r\n        }\r\n    },\r\n    actions: {\r\n        async loadSalesList(params: any) {\r\n            axios.get(`sales/list?page=${params.page}&limit=${params.limit}${params.name ? `&name=${params.name}` : ''}${params.min_price ? `&min_price=${params.min_price}` : ''}${params.max_price ? `&max_price=${params.max_price}` : ''}${params.min_count ? `&min_count=${params.min_count}` : ''}${params.max_count ? `&max_count=${params.max_count}` : ''}${params.order_by ? `&order_by=${params.order_by}` : ''}`, {\r\n                headers: {\r\n                    Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n                }\r\n            }).then(response => {\r\n                this.sales = response.data\r\n            })\r\n        },\r\n        async loadSalesListFile() {\r\n            axios.post(`sales/report`, {}, {\r\n                responseType: 'blob',\r\n                headers: {\r\n                    Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n                }\r\n            }).then(response => {\r\n                console.log(response)\r\n                if(response.status === 201){\r\n                    toast.success('Создание отчёта началось!', {autoClose: 1500, theme: 'auto'})\r\n                } else if (response.status === 200){\r\n                    const url = window.URL.createObjectURL(new Blob([response.data]));\r\n\r\n                    const a = document.createElement('a');\r\n                    a.href = url;\r\n                    a.download = `sales.xlsx`;\r\n                    document.body.appendChild(a);\r\n                    a.click();\r\n\r\n                    window.URL.revokeObjectURL(url);\r\n                    document.body.removeChild(a);\r\n                }\r\n            })\r\n        },\r\n\r\n        async createItem(params: any) {\r\n\r\n            axios.post(`sales/create`, params.form, {\r\n                headers: {\r\n                    Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n                }\r\n            }).then(response => {\r\n                toast.success('Товар успешно создан!', {autoClose: 1500, theme: 'auto'})\r\n            }).catch(e => {\r\n                toast.error(e, {autoClose: 1500, theme: 'auto'})\r\n                throw e;\r\n            })\r\n        },\r\n\r\n        // async loadObject(params: {id: number}) {\r\n        //     axios.get(`object/${params.id}`, {\r\n        //         headers: {\r\n        //             Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n        //         }\r\n        //     }).then(response => {\r\n        //         this.objects = response.data\r\n        //     })\r\n        // },\r\n    }\r\n})"],"names":[],"mappings":";;;;AAIa,MAAA,WAAW,YAAY,SAAS;AAAA,EACzC,OAAM,OAAO;AAAA,IACT,OAAO,CAAC;AAAA,EAAA;AAAA,EAEZ,SAAS;AAAA,IACL,YAAY,QAAQ;AAChB,aAAO,KAAK;AAAA,IAChB;AAAA,EACJ;AAAA,EACA,SAAS;AAAA,IACL,MAAM,cAAc,QAAa;AACvB,YAAA,IAAI,mBAAmB,OAAO,IAAI,UAAU,OAAO,KAAK,GAAG,OAAO,OAAO,SAAS,OAAO,IAAI,KAAK,EAAE,GAAG,OAAO,YAAY,cAAc,OAAO,SAAS,KAAK,EAAE,GAAG,OAAO,YAAY,cAAc,OAAO,SAAS,KAAK,EAAE,GAAG,OAAO,YAAY,cAAc,OAAO,SAAS,KAAK,EAAE,GAAG,OAAO,YAAY,cAAc,OAAO,SAAS,KAAK,EAAE,GAAG,OAAO,WAAW,aAAa,OAAO,QAAQ,KAAK,EAAE,IAAI;AAAA,QAC9Y,SAAS;AAAA,UACL,eAAe,UAAU,YAAY,aAAa,QAAQ,OAAO,CAAC;AAAA,QACtE;AAAA,MAAA,CACH,EAAE,KAAK,CAAY,aAAA;AAChB,aAAK,QAAQ,SAAS;AAAA,MAAA,CACzB;AAAA,IACL;AAAA,IACA,MAAM,oBAAoB;AAChB,YAAA,KAAK,gBAAgB,CAAA,GAAI;AAAA,QAC3B,cAAc;AAAA,QACd,SAAS;AAAA,UACL,eAAe,UAAU,YAAY,aAAa,QAAQ,OAAO,CAAC;AAAA,QACtE;AAAA,MAAA,CACH,EAAE,KAAK,CAAY,aAAA;AAChB,gBAAQ,IAAI,QAAQ;AACjB,YAAA,SAAS,WAAW,KAAI;AACvB,gBAAM,QAAQ,6BAA6B,EAAC,WAAW,MAAM,OAAO,QAAO;AAAA,QAAA,WACpE,SAAS,WAAW,KAAI;AACzB,gBAAA,MAAa,SAAA,IAAI,gBAAgB,IAAI,KAAK,CAAC,SAAS,IAAI,CAAC,CAAC;AAE1D,gBAAA,IAAa,SAAA,cAAc,GAAG;AACpC,YAAE,OAAO;AACT,YAAE,WAAW;AACJ,UAAA,SAAA,KAAK,YAAY,CAAC;AAC3B,YAAE,MAAM;AAED,UAAA,SAAA,IAAI,gBAAgB,GAAG;AACrB,UAAA,SAAA,KAAK,YAAY,CAAC;AAAA,QAC/B;AAAA,MAAA,CACH;AAAA,IACL;AAAA,IAEA,MAAM,WAAW,QAAa;AAEpB,YAAA,KAAK,gBAAgB,OAAO,MAAM;AAAA,QACpC,SAAS;AAAA,UACL,eAAe,UAAU,YAAY,aAAa,QAAQ,OAAO,CAAC;AAAA,QACtE;AAAA,MAAA,CACH,EAAE,KAAK,CAAY,aAAA;AAChB,cAAM,QAAQ,yBAAyB,EAAC,WAAW,MAAM,OAAO,QAAO;AAAA,MAAA,CAC1E,EAAE,MAAM,CAAK,MAAA;AACV,cAAM,MAAM,GAAG,EAAC,WAAW,MAAM,OAAO,QAAO;AACzC,cAAA;AAAA,MAAA,CACT;AAAA,IACL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAWJ;AACJ,CAAC;"}