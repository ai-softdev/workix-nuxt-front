{"version":3,"file":"storage-BXgOH7Oh.js","sources":["../../../../stores/storage.ts"],"sourcesContent":["import {defineStore} from \"pinia\";\r\nimport axios from \"~/composables/axios\";\r\nimport nuxtStorage from \"nuxt-storage/nuxt-storage\";\r\nimport {toast} from \"vue3-toastify\";\r\nimport type {ICurrentCategory, TGoods} from \"~/types/storage\";\r\n\r\nexport const useStorageStore = defineStore('storage', {\r\n  state: () => ({\r\n    isActive: false,\r\n    createCategory: false,\r\n    storageCategoryList: [],\r\n    storageHomeAllList: [],\r\n    storageItem: {} as TGoods,\r\n    currentCategory: {} as ICurrentCategory,\r\n    contextMenuCategory: false,\r\n    scan: ref(null),\r\n    searchGoods: '',\r\n    searchCategory: '',\r\n    streaming: false,\r\n  }),\r\n  getters: {\r\n    getStorageCategoryList: (state) => state.storageCategoryList,\r\n    getStorageSubCategory: (state) => state.currentCategory,\r\n    getStorageHomeAllList: (state) => state.storageHomeAllList,\r\n    getStorageItem: (state) => state.storageItem\r\n  },\r\n  actions: {\r\n    async loadStorageCategoryList(): Promise<void> {\r\n      await axios.get(`store/category/list`, {\r\n        headers: {\r\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n        }\r\n      }).then(res => {\r\n        this.storageCategoryList = res.data\r\n      })\r\n    },\r\n    async loadStorageSubCategory(params: { slug: string | string[], search?: string | number }): Promise<void> {\r\n      await axios.get(`store/subcategory/${params.slug}?search=${params.search}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n        }\r\n      }).then(res => {\r\n        this.currentCategory = res.data\r\n\r\n      }).catch(e => {\r\n      })\r\n    },\r\n    async loadStorageCategorySearch(params: { query: string | number }): Promise<void> {\r\n      await axios.get(`store/category/list?name=${params.query}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n        }\r\n      }).then(res => {\r\n        this.storageCategoryList = res.data\r\n      })\r\n    },\r\n    async loadAllList(): Promise<void> {\r\n      await axios.get(`store/item/list`, {\r\n        headers: {\r\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n        }\r\n      }).then(res => {\r\n        this.storageHomeAllList = res.data\r\n      })\r\n    },\r\n    async loadAllListSearch(params: { search?: any }): Promise<void> {\r\n      await axios.get(`store/item/list?search=${params.search}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n        }\r\n      }).then(res => {\r\n        this.storageHomeAllList = res.data\r\n      })\r\n    },\r\n    async loadItem(params: { itemSlug: string | string[] }): Promise<void> {\r\n      await axios.get(`store/item/${params.itemSlug}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n        }\r\n      }).then(res => {\r\n        this.storageItem = res.data\r\n      })\r\n    },\r\n    async createStorageCategoryOrSubcategory(params: {\r\n      createType?: string,\r\n      name: string,\r\n      category_id?: number\r\n    }): Promise<void> {\r\n      await axios.post(`store/${params.createType}/create`, {\r\n        name: params.name,\r\n        category_id: params.createType === 'subcategory' ? params.category_id : null\r\n      }, {\r\n        headers: {\r\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n        }\r\n      }).then(res => {\r\n        this.loadStorageCategoryList()\r\n        this.createCategory = false\r\n        toast.success('Успешно создано', {autoClose: 1500, theme: 'auto'})\r\n      }).catch(e => {\r\n        toast.error('Возникла ошибка при создании', {autoClose: 1500, theme: 'auto'})\r\n      })\r\n    },\r\n    async updateStorageElem(params: { updateType: string, id: number }): Promise<void> {\r\n      await axios.patch(`store/${params.updateType}/update`, {\r\n        headers: {\r\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n        }\r\n      }).then(res => {\r\n\r\n      }).catch(e => {\r\n\r\n      })\r\n    },\r\n    async deleteStorageElem(params: { deleteType: string, id: number }): Promise<void> {\r\n      await axios.delete(`store/${params.deleteType}/delete/${params.id}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${nuxtStorage.localStorage.getData('token')}`\r\n        }\r\n      }).then(res => {\r\n        if (['subcategory', 'category'].includes(params.deleteType)) {\r\n          this.loadStorageCategoryList()\r\n        }\r\n        toast.success('Успешно удалён', {autoClose: 1500, theme: 'auto'})\r\n      })\r\n    }\r\n  }\r\n})"],"names":[],"mappings":"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"}