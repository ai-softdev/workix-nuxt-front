import{j,N as h,O as g,Z as i,a4 as Z,u as t,a5 as I,a2 as _,_ as f,$,a6 as V,a7 as Oe,k as $e,a as R,b as fe,H as ie,g as Ke,w as ze,L as k,V as w,M as B,x as Me,J as q,a3 as G,P,aa as Je,a9 as Qe,o as et,a8 as tt,a0 as st,a1 as nt,I as Ee}from"./swiper-vue.CGVHF6NK.js";import{u as it}from"./index.qQGwxGZG.js";import{u as U}from"./chat.BHklfPJs.js";import{f as ot,t as te,n as rt,g as ce,h as Se,i as at,j as lt,k as De,l as dt,c as ve,b as ee,m as Le,o as We}from"./entry.BaOklr6S.js";import{u as J}from"./auth.BmU8f0yL.js";import{_ as Te}from"./ContextMenu.DnsCO8a2.js";import{d as ut,s as ht,u as ct,c as Be,a as pt}from"./ElemUI.CoXhQqPn.js";import{l as Q,n as gt}from"./nuxt-storage.LTSgK-Sl.js";import{_ as X}from"./TheModal.vue.B7lTsxX5.js";import{_ as O}from"./TheButton.vue.DmVMkKnk.js";import{_ as Ae}from"./TheTextContent.vue.Bxghit5p.js";import{a as mt,h as He,_ as ft}from"./TheChatAvatar.vue.DUvqXZWe.js";import{T as vt}from"./ThePreloader.Dam3vD6T.js";import{_ as we}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{T as wt}from"./TheCheckbox.C9O7fTBV.js";import{T as je}from"./TheSceleton.BWKwzta9.js";import{_ as ge}from"./TheInput.vue.DPjuIUBj.js";import"./selectMenu.Bo5zmvQa.js";const Ct=""+globalThis.__publicAssetsURL("icons/send-message.svg"),yt=["id"],xt={key:0,class:"text-semiCyan font-bold text-[12px]"},kt={class:"break-words relative"},bt={key:0,class:"text-[12px] text-blueSemiLight tracking-widest"},_t={key:1,class:""},$t=Oe('<div class="bg-blueSemiLight rounded-full p-3"><svg width="25px" height="25px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g opacity="0.5"><path fill-rule="evenodd" clip-rule="evenodd" d="M14 22H10C6.22876 22 4.34315 22 3.17157 20.8284C2 19.6569 2 17.7712 2 14V10C2 6.22876 2 4.34315 3.17157 3.17157C4.34315 2 6.23869 2 10.0298 2C10.6358 2 11.1214 2 11.53 2.01666C11.5166 2.09659 11.5095 2.17813 11.5092 2.26057L11.5 5.09497C11.4999 6.19207 11.4998 7.16164 11.6049 7.94316C11.7188 8.79028 11.9803 9.63726 12.6716 10.3285C13.3628 11.0198 14.2098 11.2813 15.0569 11.3952C15.8385 11.5003 16.808 11.5002 17.9051 11.5001L18 11.5001H21.9574C22 12.0344 22 12.6901 22 13.5629V14C22 17.7712 22 19.6569 20.8284 20.8284C19.6569 22 17.7712 22 14 22Z" fill="#1C274C"></path></g><path d="M11.5092 2.2601L11.5 5.0945C11.4999 6.1916 11.4998 7.16117 11.6049 7.94269C11.7188 8.78981 11.9803 9.6368 12.6716 10.3281C13.3629 11.0193 14.2098 11.2808 15.057 11.3947C15.8385 11.4998 16.808 11.4997 17.9051 11.4996L21.9574 11.4996C21.9698 11.6552 21.9786 11.821 21.9848 11.9995H22C22 11.732 22 11.5983 21.9901 11.4408C21.9335 10.5463 21.5617 9.52125 21.0315 8.79853C20.9382 8.6713 20.8743 8.59493 20.7467 8.44218C19.9542 7.49359 18.911 6.31193 18 5.49953C17.1892 4.77645 16.0787 3.98536 15.1101 3.3385C14.2781 2.78275 13.862 2.50487 13.2915 2.29834C13.1403 2.24359 12.9408 2.18311 12.7846 2.14466C12.4006 2.05013 12.0268 2.01725 11.5 2.00586L11.5092 2.2601Z" fill="#1C274C"></path></svg></div>',1),Mt={class:"float-start break-all"},St={class:"text-sm dark:text-gray-500 text-gray-400 font-bold"},Lt=["src"],Wt={key:1},Tt=["src"],Pt={key:0},Et=i("svg",{class:"fill-semiCyan",width:"13px",height:"13px",viewBox:"0 0 256 256",id:"Flat",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M231.999,107.31445,173.47168,165.8418c4.55664,12.67968,6.44531,33.88965-13.18945,59.98584a15.96991,15.96991,0,0,1-11.64649,6.33007q-.5625.03955-1.124.03956a16.0039,16.0039,0,0,1-11.31934-4.69141L88,179.314,53.65723,213.65674a8.00018,8.00018,0,0,1-11.31446-11.31348L76.686,168,28.2959,119.60986a16.01339,16.01339,0,0,1,1.2832-23.78613C55.00488,75.312,79.34082,79.35205,89.99316,82.69287L148.68555,24l.001-.001a16.02135,16.02135,0,0,1,22.627,0L232,84.68652a15.99888,15.99888,0,0,1-.001,22.62793Z"})],-1),Dt=[Et],jt={key:1,class:"text-[12px] tracking-wider font-light dark:text-gray-400 text-gray-400"},Rt={class:"text-[12px] text-end text-gray-400"},Ut={key:0,class:"fill-semiCyan",width:"20px",height:"20px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Vt=i("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.4933 6.93502C15.8053 7.20743 15.8374 7.68122 15.565 7.99325L7.70786 16.9933C7.56543 17.1564 7.35943 17.25 7.14287 17.25C6.9263 17.25 6.72031 17.1564 6.57788 16.9933L3.43502 13.3933C3.16261 13.0812 3.19473 12.6074 3.50677 12.335C3.8188 12.0626 4.29259 12.0947 4.565 12.4068L7.14287 15.3596L14.435 7.00677C14.7074 6.69473 15.1812 6.66261 15.4933 6.93502Z"},null,-1),Ot={key:0,"fill-rule":"evenodd","clip-rule":"evenodd",d:"M20.5175 7.01946C20.8174 7.30513 20.829 7.77986 20.5433 8.07981L11.9716 17.0798C11.8201 17.2389 11.6065 17.3235 11.3872 17.3114C11.1679 17.2993 10.9649 17.1917 10.8318 17.0169L10.4035 16.4544C10.1526 16.1249 10.2163 15.6543 10.5458 15.4034C10.8289 15.1878 11.2161 15.2044 11.4787 15.4223L19.4571 7.04531C19.7428 6.74537 20.2175 6.73379 20.5175 7.01946Z"},Ie=j({__name:"ChatContentUserElem",props:{item:{type:Object,default:()=>{}},textType:{type:String,default:""}},setup(r){const e=U(),s=J();return new XMLHttpRequest,(n,o)=>{var l,a,d,u;return h(),g("div",{onContextmenu:o[2]||(o[2]=V(()=>{},["prevent"])),id:r.item.id},[i("div",{class:Z(["flex items-end gap-x-2 p-1 rounded-lg",{"max-md:justify-end":r.item.sender.id===t(s).user.id,"w-7/12 max-md:w-full text-center ":r.item.message_type!=="default"}])},[r.item.message_type==="default"?(h(),g("div",{key:0,class:Z(["rounded-full max-md:hidden w-[30px]",{"max-md:!block":t(e).userChat.is_group,"max-md:!hidden":r.item.sender.id===t(s).user.id}])},[I(n.$slots,"userImage")],2)):_("",!0),i("div",{class:Z({"mx-auto py-1 px-4 dark:text-gray-300 text-gray-500 tracking-wider rounded-full dark:!bg-black dark:!bg-opacity-30":r.item.message_type!=="default","!bg-transparent dark:!bg-transparent !p-0 !shadow-none":r.item.message_type==="change"&&r.item.file,"flex flex-col py-1 px-2 gap-x-2 rounded-xl max-w-[40%] max-lg:max-w-[50%] max-md:max-w-[80%] relative before:absolute before:border-l-[5px] before:border-l-transparent before:border-r-[10px] before:border-b-[10px] before:border-r-transparent before:w-[3px] before:h-[3px] before:bottom-0":r.item.message_type==="default","dark:bg-gray-600 bg-gray-200 dark:shadow-none shadow-md max-md:rounded-r-xl max-md:rounded-l-lg":r.item.sender.id!==t(s).user.id,"dark:bg-gray-700 bg-gray-200 dark:shadow-none shadow-md max-md:rounded-l-xl max-md:rounded-r-lg":r.item.sender.id===t(s).user.id,"before:dark:border-b-gray-700 before:border-gray-200 before:-left-1 max-md:before:-right-2 max-md:before:left-auto":r.item.sender.id===t(s).user.id,"before:dark:border-b-gray-600 before:border-gray-200 before:-left-1 max-md:before:-left-1":r.item.sender.id!==t(s).user.id})},[(l=r.item.forwarded_from)!=null&&l.id&&r.item.message_type==="default"?(h(),g("p",xt,[I(n.$slots,"userForwarded")])):_("",!0),i("div",kt,[t(e).userChat.is_group&&!((a=r.item.forwarded_from)!=null&&a.id)&&r.item.sender.id!==t(s).user.id&&r.item.message_type==="default"?(h(),g("p",bt,[I(n.$slots,"userSenderName")])):_("",!0),r.item.file&&r.item.message_type==="default"?(h(),g("div",_t,[r.item.file_name.substr(-4)!==".png"?(h(),g("div",{key:0,class:"flex gap-x-4 p-2 items-center cursor-pointer",onClick:o[0]||(o[0]=c=>t(ut)(r.item))},[$t,i("div",Mt,[i("p",null,f(((d=r.item.file_name)==null?void 0:d.length)>20?r.item.file_name.slice(0,15)+"..."+r.item.file_name.substr(-6):r.item.file_name),1),i("span",St,[$(f(r.item.file_size)+" ",1),i("span",null,f(r.item.file_size>1e3?n.$t("КБ"):n.$t("Б")),1)])])])):_("",!0),r.item.file_name.substr(-4)===".png"?(h(),g("div",{key:1,class:"cursor-pointer max-w-[300px]",onDragstart:o[1]||(o[1]=V(()=>{},["prevent"]))},[i("img",{class:"w-full",src:t(s).get_server_domain+r.item.file,alt:""},null,8,Lt)],32)):_("",!0)])):_("",!0),i("div",{class:Z(["text-sm break-all",{"flex flex-col items-center justify-center":r.item.message_type==="change"&&r.item.file}])},[r.item.text?(h(),g("span",{key:0,class:Z(["",{"dark:!bg-black dark:!bg-opacity-30 py-1 px-4 rounded-full bg-gray-200":r.item.message_type==="change"&&r.item.file}])},[I(n.$slots,"userMessage")],2)):_("",!0),r.item.message_type==="change"&&r.item.file?(h(),g("div",Wt,[i("img",{class:"rounded-full w-[80px] h-[80px] cursor-pointer",src:t(s).get_server_domain+r.item.file,alt:""},null,8,Tt)])):_("",!0),r.item.message_type==="default"?(h(),g("div",{key:2,class:Z(["flex items-center justify-end gap-x-1 float-right ml-2",{"mt-1":((u=r.item.text)==null?void 0:u.length)<=70}])},[r.item.pinned===!0&&!t(e).showPinnedWindow?(h(),g("div",Pt,Dt)):_("",!0),new Date(r.item.updated_at).toLocaleString()!==new Date(r.item.created_at).toLocaleString()?(h(),g("p",jt,f(n.$t("изменено")),1)):_("",!0),i("p",Rt,[I(n.$slots,"userDate")]),i("div",null,[r.item.sender.id===t(s).user.id?(h(),g("svg",Ut,[Vt,r.item.read&&r.item.sender.id===t(s).user.id?(h(),g("path",Ot)):_("",!0)])):_("",!0)])],2)):_("",!0)],2)])],2)],2)],40,yt)}}});function pe(r){var e;const s=te(r);return(e=s==null?void 0:s.$el)!=null?e:s}const Ne=lt?window:void 0;function zt(...r){let e,s,n,o;if(typeof r[0]=="string"||Array.isArray(r[0])?([s,n,o]=r,e=Ne):[e,s,n,o]=r,!e)return ce;Array.isArray(s)||(s=[s]),Array.isArray(n)||(n=[n]);const l=[],a=()=>{l.forEach(p=>p()),l.length=0},d=(p,v,m,C)=>(p.addEventListener(v,m,C),()=>p.removeEventListener(v,m,C)),u=fe(()=>[pe(e),te(o)],([p,v])=>{if(a(),!p)return;const m=dt(v)?{...v}:v;l.push(...s.flatMap(C=>n.map(b=>d(p,C,b,m))))},{immediate:!0,flush:"post"}),c=()=>{u(),a()};return Se(c),c}function Bt(){const r=R(!1),e=Ke();return e&&ie(()=>{r.value=!0},e),r}function At(r){const e=Bt();return $e(()=>(e.value,!!r()))}function Re(r,e,s={}){const{root:n,rootMargin:o="0px",threshold:l=.1,window:a=Ne,immediate:d=!0}=s,u=At(()=>a&&"IntersectionObserver"in a),c=$e(()=>{const b=te(r);return(Array.isArray(b)?b:[b]).map(pe).filter(rt)});let p=ce;const v=R(d),m=u.value?fe(()=>[c.value,pe(n),v.value],([b,L])=>{if(p(),!v.value||!b.length)return;const S=new IntersectionObserver(e,{root:pe(L),rootMargin:o,threshold:l});b.forEach(y=>y&&S.observe(y)),p=()=>{S.disconnect(),p=ce}},{immediate:d,flush:"post"}):ce,C=()=>{p(),m(),v.value=!1};return Se(C),{isSupported:u,isActive:v,pause(){p(),v.value=!1},resume(){v.value=!0},stop:C}}function Ce(r){return typeof Window<"u"&&r instanceof Window?r.document.documentElement:typeof Document<"u"&&r instanceof Document?r.documentElement:r}const Ht={[ot.mounted](r,e){typeof e.value=="function"?Re(r,e.value):Re(r,...e.value)}};function Ze(r){const e=window.getComputedStyle(r);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&r.clientWidth<r.scrollWidth||e.overflowY==="auto"&&r.clientHeight<r.scrollHeight)return!0;{const s=r.parentNode;return!s||s.tagName==="BODY"?!1:Ze(s)}}function It(r){const e=r||window.event,s=e.target;return Ze(s)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}const de=new WeakMap;function Nt(r,e=!1){const s=R(e);let n=null;fe(at(r),a=>{const d=Ce(te(a));if(d){const u=d;de.get(u)||de.set(u,u.style.overflow),s.value&&(u.style.overflow="hidden")}},{immediate:!0});const o=()=>{const a=Ce(te(r));!a||s.value||(De&&(n=zt(a,"touchmove",d=>{It(d)},{passive:!1})),a.style.overflow="hidden",s.value=!0)},l=()=>{var a;const d=Ce(te(r));!d||!s.value||(De&&(n==null||n()),d.style.overflow=(a=de.get(d))!=null?a:"",de.delete(d),s.value=!1)};return Se(l),$e({get(){return s.value},set(a){a?o():l()}})}function Zt(){let r=!1;const e=R(!1);return(s,n)=>{if(e.value=n.value,r)return;r=!0;const o=Nt(s,n.value);fe(e,l=>o.value=l)}}Zt();const Ft={key:0,for:"uploadMessageFiles",class:"dark:hover:bg-gray-700 hover:bg-gray-200 p-2 cursor-pointer flex items-center gap-x-10"},Xt={key:1,class:"dark:hover:bg-gray-700 hover:bg-gray-200 py-2 px-6 cursor-pointer flex items-center"},qt={class:"flex gap-x-6"},Gt={class:"text-[15px] font-mono"},F=j({__name:"ChatContentContextMenuItem",props:{itemType:{type:String,default:""}},setup(r){return(e,s)=>r.itemType==="uploadMessageFiles"?(h(),g("label",Ft,[i("div",null,[I(e.$slots,"ContextMenuSvg")]),i("span",null,[I(e.$slots,"ContextMenuText")]),i("div",null,[I(e.$slots,"ContextMenuContent")])])):(h(),g("div",Xt,[i("div",qt,[i("div",null,[I(e.$slots,"ContextMenuSvg")]),i("p",Gt,[I(e.$slots,"ContextMenuText")])]),i("div",null,[I(e.$slots,"ContextMenuContent")])]))}}),Yt={key:0,class:"my-auto mt-20 h-20 items-center flex justify-center w-4/12 max-lg:w-6/12 max-md:w-10/12 max-ms:w-full mx-auto"},Kt={class:"bg-black bg-opacity-5 px-10 py-2 rounded-full"},Jt=j({__name:"TheChatContentEmpty",setup(r){const e=U();return(s,n)=>t(e).userChat.messages.length===0?(h(),g("div",Yt,[i("p",Kt,f(s.$t("Пока тут ничего нет")),1)])):_("",!0)}}),Qt=i("svg",{class:"stroke-blueSemiLight",width:"40px",height:"40px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M17 9.5L12 14.5L7 9.5","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),es=[Qt],ts={key:0,class:"mr-4 absolute bottom-10 right-0 bg-black dark:bg-opacity-70 z-50 bg-opacity-20 dark:text-white text-white tracking-wide p-4 rounded-lg mb-4 max-[400px]:mx-4 break-words"},ss={class:"text-sm"},ns=i("svg",{class:"stroke-black dark:stroke-white",width:"22px",height:"22px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{"data-v-a06cf116":"",d:"M21.2799 6.40005L11.7399 15.94C10.7899 16.89 7.96987 17.33 7.33987 16.7C6.70987 16.07 7.13987 13.25 8.08987 12.3L17.6399 2.75002C17.8754 2.49308 18.1605 2.28654 18.4781 2.14284C18.7956 1.99914 19.139 1.92124 19.4875 1.9139C19.8359 1.90657 20.1823 1.96991 20.5056 2.10012C20.8289 2.23033 21.1225 2.42473 21.3686 2.67153C21.6147 2.91833 21.8083 3.21243 21.9376 3.53609C22.0669 3.85976 22.1294 4.20626 22.1211 4.55471C22.1128 4.90316 22.0339 5.24635 21.8894 5.5635C21.7448 5.88065 21.5375 6.16524 21.2799 6.40005V6.40005Z","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M11 4H6C4.93913 4 3.92178 4.42142 3.17163 5.17157C2.42149 5.92172 2 6.93913 2 8V18C2 19.0609 2.42149 20.0783 3.17163 20.8284C3.92178 21.5786 4.93913 22 6 22H17C19.21 22 20 20.2 20 18V13","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),is=i("svg",{version:"1.1",id:"Icons",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","xml:space":"preserve",fill:"none",width:"22px",height:"22px",class:"dark:stroke-white stroke-black"},[i("path",{class:"st0",d:`M11.7,8.1V6c0-0.8-0.9-1.3-1.5-0.8l-6.8,6c-0.5,0.4-0.5,1.2,0,1.6l6.8,6c0.6,0.5,1.5,0,1.5-0.8v-2h0.9\r
              c7.1,0,13.5,4.3,16.5,11C29,16.8,21.3,8.6,11.7,8.1z`})],-1),os=i("svg",{class:"dark:stroke-white stroke-black fill-none",width:"22px",height:"22px",version:"1.1",id:"Icons",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32","xml:space":"preserve"},[i("path",{d:`M20.3,8.1V6c0-0.8,0.9-1.3,1.5-0.8l6.8,6c0.5,0.4,0.5,1.2,0,1.6l-6.8,6c-0.6,0.5-1.5,0-1.5-0.8v-2h-0.9\r
              C12.4,16,5.9,20.3,3,27C3,16.8,10.7,8.6,20.3,8.1z`})],-1),rs=i("svg",{class:"dark:fill-white",xmlns:"http://www.w3.org/2000/svg",width:"22px",height:"22px",viewBox:"0 0 261.811 261.811","xml:space":"preserve"},[i("g",null,[i("g",null,[i("path",{d:`M24.715,261.811c-5.492,0-10.645-2.133-14.521-6.01c-8.011-8.017-8.011-21.054-0.006-29.064\r
                      l70.375-70.372L38.51,113.785c-7.073-7.179-7.928-18.303-2.039-26.466c0.855-1.184,21.314-28.839,58.964-28.839\r
                      c2.224,0,4.492,0.101,6.756,0.295L180.62,3.597c8.103-5.729,20.081-4.48,26.863,2.796l44.675,48.037\r
                      c6.919,7.436,7.319,19.006,0.926,26.906l-55.882,69.151c1.979,23.759,1.052,63.069-23.901,77.725\r
                      c-7.959,4.666-18.578,3.26-25.021-3.282l-38.837-39.316l-70.206,70.183C35.365,259.678,30.208,261.811,24.715,261.811z\r
                       M95.43,70.194c-31.735,0-48.763,23.009-49.472,23.987c-2.53,3.502-2.159,8.291,0.883,11.376l50.227,50.865l-78.6,78.594\r
                      c-3.442,3.448-3.442,9.058,0,12.505c3.319,3.328,9.157,3.328,12.482,0l78.531-78.52l47.122,47.7\r
                      c2.762,2.813,7.325,3.407,10.761,1.412c20.957-12.316,19.539-52.303,17.961-68.919l-0.229-2.373l58.878-72.854\r
                      c2.745-3.402,2.573-8.371-0.406-11.567l-44.663-48.031c-2.904-3.116-8.062-3.671-11.545-1.212l-82.042,57.726l-2.213-0.251\r
                      C100.536,70.34,97.952,70.194,95.43,70.194z`})])])],-1),as=i("svg",{class:"dark:fill-white fill-black",width:"22px",height:"22px",viewBox:"0 0 256 256",id:"Flat",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M50.96,37.30957A4,4,0,0,0,45.04,42.69043l38.59424,42.4541c-11.416-2.39062-31.02295-2.76172-51.54444,13.79248a12.01279,12.01279,0,0,0-.96484,17.84424L82.34326,168,45.17188,205.17139a3.99992,3.99992,0,1,0,5.65625,5.65722L88,173.65674l51.02051,51.021a12.00814,12.00814,0,0,0,8.49219,3.51954q.42041,0,.84277-.02979a11.97039,11.97039,0,0,0,8.73047-4.74512c6.33252-8.4165,15.40625-23.479,15.38379-40.55859L205.04,218.69043a4,4,0,1,0,5.91992-5.38086Zm99.7334,181.30322a3.99357,3.99357,0,0,1-6.01563.40821L36.78125,111.124a4.01376,4.01376,0,0,1,.332-5.96045c27.17188-21.91943,52.06543-10.09375,53.09766-9.58593a3.99477,3.99477,0,0,0,3.08984.20019l69.71729,76.689C168.36816,191.2041,157.64355,209.374,150.69336,218.61279ZM232.68652,96a11.92292,11.92292,0,0,1-3.51562,8.48584l-41.4043,41.40381a3.99975,3.99975,0,1,1-5.65625-5.65674l41.4043-41.4043a3.99915,3.99915,0,0,0,0-5.65674L162.8291,32.48535a4.00621,4.00621,0,0,0-5.6582.00049l-37.97559,37.9751a3.99957,3.99957,0,1,1-5.65625-5.65625l37.97559-37.97608a12.01526,12.01526,0,0,1,16.9707-.00049L229.1709,87.51465A11.921,11.921,0,0,1,232.68652,96Z"})],-1),ls=i("svg",{class:"dark:stroke-white stroke-black",width:"23px",height:"23px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{"data-v-a06cf116":"",d:"M10 12V17","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M14 12V17","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M4 7H20","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M6 10V18C6 19.6569 7.34315 21 9 21H15C16.6569 21 18 19.6569 18 18V10","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),ds={class:"p-2"},us=["src"],hs={key:0,class:""},cs=["onClick"],ps={class:"hover:underline hover:text-blueDarkSemiLight cursor-pointer"},gs={key:1,class:"whitespace-pre-line"},ms={class:"text-lg tracking-wider"},fs={class:"flex mt-4 gap-x-4 justify-center"},vs=i("div",{class:"w-full relative flex items-center"},[i("div",{class:"absolute rotate-90 ml-2"},[i("svg",{class:"dark:stroke-white stroke-black",width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M14.9536 14.9458L21 21M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z","stroke-width":"1.2","stroke-linecap":"round","stroke-linejoin":"round"})])]),i("input",{type:"text",class:"w-full dark:bg-gray-700 outline-none pl-10 h-[50px]",placeholder:"Поиск..."})],-1),ws={class:"dark:bg-gray-800 bg-gray-200 flex flex-col gap-y-3 py-4 h-[400px] overflow-y-auto"},Cs=["onClick"],ys={class:"w-9/12 break-words"},xs={key:0,class:"text-sm"},ks={key:1,class:"text-sm"},bs={class:"w-full h-[50px] flex items-center justify-center"},_s={class:"text-lg tracking-wider"},$s={class:"flex mt-4 gap-x-4 justify-center"},Ms={class:"text-lg tracking-wider"},Ss={class:"flex mt-4 gap-x-4 justify-center"},Ls=j({__name:"ChatContentUser",props:{messageObject:{type:Object,default:()=>{}},showDeleteWarn:{type:Boolean,default:!1},showPinnedWarn:{type:Boolean,default:!1},showUnPinWarn:{type:Boolean,default:!1},showDateModal:{type:Boolean,default:!1}},setup(r){const e=ve(),s=ee(),n=U(),o=J(),{x:l,y:a}=Le(),{y:d}=We(),u=R(!1),c=R({getBoundingClientRect:()=>({})}),p=R(null),v=R(1);R(99);const m=R({scrollTop:"",scrollHeight:"",clientHeight:"",root:null});function C({target:{scrollTop:y,clientHeight:x,scrollHeight:z}}){p.value=y,y===0&&(v.value=Number(v.value)+1,n.messageLimit==100&&(n==null||n.loadUserChat({page:v.value,limit:100,id:s.params.id})))}ie(()=>{setTimeout(()=>{const y=m.value;y.scrollTop=y==null?void 0:y.scrollHeight},500)}),ze(()=>{setTimeout(()=>{const y=m.value;y.scrollTop=y==null?void 0:y.scrollHeight},500)});function b(){const y=document.getElementById("messages_block");y==null||y.scrollTo({top:y==null?void 0:y.scrollHeight,behavior:"smooth"})}let L=R(null);function S([{target:y}]){y.dataset.read==="0"&&y.dataset.senderId!==`${o.user.id}`&&n.messagesMakeRead.indexOf(y.id)===-1&&(n.messagesMakeRead.push(y.id),clearTimeout(L),L=setTimeout(()=>{n.makeRead({messages:n.messagesMakeRead})},1e3))}return(y,x)=>{var T;const z=Te,D=Ie;return h(),g("div",{class:"flex flex-col !overflow-x-hidden gap-y-2 check overflow-y-auto",onDragenter:x[23]||(x[23]=V(M=>t(n).showDragInfo=!0,["prevent"])),onScroll:C,ref_key:"messages_block",ref:m,id:"messages_block"},[k(B,{name:"slide-up"},{default:w(()=>{var M,E;return[t(p)<((M=this.$refs.messages_block)==null?void 0:M.scrollHeight)-((E=this.$refs.messages_block)==null?void 0:E.clientHeight)?(h(),g("button",{key:0,onClick:b,class:"absolute bottom-20 right-3 dark:bg-gray-700 bg-white rounded-full"},es)):_("",!0)]}),_:1}),k(B,{name:"fade"},{default:w(()=>[t(n).showVoiceInfo?(h(),g("div",ts,[i("p",ss,f(y.$t("Удерживайте для записи голосового сообщения")),1)])):_("",!0)]),_:1}),k(z,{onContextmenu:x[6]||(x[6]=V(()=>{},["prevent"])),modelValue:t(u),"onUpdate:modelValue":x[7]||(x[7]=M=>Me(u)?u.value=M:null),"virtual-element":t(c)},{default:w(()=>{var M,E;return[((M=t(o).user)==null?void 0:M.id)===((E=r.messageObject.sender)==null?void 0:E.id)&&!r.messageObject.forwarded_from&&r.messageObject.message_type==="default"?(h(),P(F,{key:0,onClick:x[0]||(x[0]=W=>{var H;t(n).messageUpdate={...r.messageObject,updateText:(H=r.messageObject)==null?void 0:H.text},t(n).messageText="",t(n).messageReplied={},t(n).messagePinned={},t(n).messageForwarded={},u.value=!1})},{ContextMenuSvg:w(()=>[ns]),ContextMenuText:w(()=>[$(f(y.$t("Изменить")),1)]),_:1})):_("",!0),r.messageObject.message_type==="default"?(h(),P(F,{key:1,onClick:x[1]||(x[1]=W=>{t(n).messageReplied=r.messageObject,r.messageObject={},t(n).messageUpdate={},u.value=!1})},{ContextMenuSvg:w(()=>[is]),ContextMenuText:w(()=>[$(f(y.$t("Ответить")),1)]),_:1})):_("",!0),r.messageObject.message_type==="default"?(h(),P(F,{key:2,onClick:x[2]||(x[2]=W=>{t(n).showSendWindow=!0,u.value=!1,t(n).messageReplied={},t(n).messageUpdate={}})},{ContextMenuSvg:w(()=>[os]),ContextMenuText:w(()=>[$(f(y.$t("Переслать")),1)]),_:1})):_("",!0),!r.messageObject.pinned&&r.messageObject.message_type==="default"?(h(),P(F,{key:3,onClick:x[3]||(x[3]=W=>{t(n).messagePinned={...r.messageObject},r.showPinnedWarn=!0,u.value=!1})},{ContextMenuSvg:w(()=>[rs]),ContextMenuText:w(()=>[$(f(y.$t("Закрепить")),1)]),_:1})):r.messageObject.pinned&&r.messageObject.message_type==="default"?(h(),P(F,{key:4,onClick:x[4]||(x[4]=W=>{r.showUnPinWarn=!0,u.value=!1})},{ContextMenuSvg:w(()=>[as]),ContextMenuText:w(()=>[$(f(y.$t("Открепить")),1)]),_:1})):_("",!0),k(F,{onClick:x[5]||(x[5]=W=>{r.showDeleteWarn=!0,u.value=!1})},{ContextMenuSvg:w(()=>[ls]),ContextMenuText:w(()=>[$(f(y.$t("Удалить")),1)]),_:1})]}),_:1},8,["modelValue","virtual-element"]),i("div",ds,[(h(!0),g(q,null,G((T=t(n).userChat)==null?void 0:T.messages,(M,E)=>(h(),g("div",{key:E},[i("div",{class:"w-6/12 mx-auto max-md:w-3/12",onContextmenu:x[9]||(x[9]=V(()=>{},["stop"]))},[i("p",{class:"bg-white bg-opacity-20 w-[120px] max-[450px]:w-[90px] py-1 text-sm text-center rounded-full",onClick:x[8]||(x[8]=W=>r.showDateModal=!0)},f(M.date),1)],32),(h(!0),g(q,null,G(M.messages,(W,H)=>Je((h(),P(D,{class:"",id:W.id,"data-read":W.read?1:0,"data-sender-id":W.sender.id,item:W,key:H,onClick:x[10]||(x[10]=N=>r.messageObject={}),onContextmenu:V(()=>{const N=("unref"in y?y.unref:t(t))(t(a))-("unref"in y?y.unref:t(t))(t(d)),Y=("unref"in y?y.unref:t(t))(t(l));t(c).getBoundingClientRect=()=>({width:0,height:0,top:N,left:Y}),u.value=!0,r.messageObject={...W}},["prevent"])},{userForwarded:w(()=>[$(f(y.$t("Переслано от")+" "+W.forwarded_from.name),1)]),userImage:w(()=>[i("img",{class:"w-[30px] h-[30px] rounded-full",src:t(o).get_server_domain+W.sender.photo,alt:""},null,8,us)]),userSenderName:w(()=>[$(f(W.sender.first_name+" "+W.sender.last_name),1)]),userMessage:w(()=>[W.message_type!=="default"&&W.message_type!=="change"?(h(),g("span",hs,[i("button",{onClick:N=>{var Y,oe,Pe;return t(e).push(((oe=(Y=t(n).chatList.results[E])==null?void 0:Y.user)==null?void 0:oe.id)===W.sender.id?`/base/chat/${(Pe=t(n).chatList.results[E])==null?void 0:Pe.id}`:"")},class:"hover:underline hover:text-blueDarkSemiLight cursor-pointer"},f(W.text.split(" ").slice(0,1)[0]),9,cs),i("span",null,f(" "+W.text.split(" ").slice(0,2)[1]+" "),1),i("button",ps,f(W.text.split(" ").slice(2,3)[0]),1)])):(h(),g("span",gs,f(W.text),1))]),userDate:w(()=>[$(f(new Date(W.updated_at).toLocaleTimeString().slice(0,5)),1)]),_:2},1032,["id","data-read","data-sender-id","item","onContextmenu"])),[[t(Ht),[S,{item:W}]]])),128))]))),128))]),k(Jt),k(B,{name:"fade"},{default:w(()=>[r.showDeleteWarn?(h(),P(X,{key:0,type:"resize",onShowModal:x[13]||(x[13]=M=>{r.showDeleteWarn=!1,r.messageObject={}})},{default:w(()=>[i("div",null,[i("p",ms,f(y.$t("Удалить выбранное сообщение?")),1)]),i("div",fs,[k(O,{class:"py-2 px-4 rounded-lg",type:"chat",onClick:x[11]||(x[11]=M=>r.showDeleteWarn=!1)},{default:w(()=>[$(f(y.$t("Отмена")),1)]),_:1}),k(O,{class:"py-2 px-4 rounded-lg",type:"chat",onClick:x[12]||(x[12]=M=>{var E;t(n).deleteMessage({id:(E=r.messageObject)==null?void 0:E.id}),u.value=!1,r.showDeleteWarn=!1})},{default:w(()=>[$(f(y.$t("Удалить")),1)]),_:1})])]),_:1})):t(n).showSendWindow?(h(),P(X,{key:1,type:"resizeSendWindow",class:"overflow-hidden",onShowModal:x[15]||(x[15]=M=>{t(n).showSendWindow=!1,r.messageObject={}})},{default:w(()=>[k(Ae,{class:"mt-2"},{default:w(()=>[$(f(y.$t("Переслать")),1)]),_:1}),vs,i("div",ws,[(h(!0),g(q,null,G(t(n).get_chat_list.results,M=>{var E,W,H,N;return h(),g("div",{onClick:Y=>{r.messageObject.id?t(n).messageForwarded=r.messageObject:t(n).messageForwarded,t(e).push(`/base/chat/${M.id}`),t(n).showSendWindow=!1},class:"flex bg-transparent border-none gap-x-4 items-center w-full dark:hover:bg-gray-600 hover:bg-gray-300 cursor-pointer transition-all px-5"},[k(mt,{user:t(o),chat:M},null,8,["user","chat"]),i("div",ys,[(E=M.user)!=null&&E.id||M.is_group?(h(),g("p",xs,f((W=M.user)!=null&&W.id&&!M.is_group?((H=M.user)==null?void 0:H.first_name)+" "+((N=M.user)==null?void 0:N.last_name):M.name),1)):(h(),g("p",ks,f(y.$t("Избранное")),1))])],8,Cs)}),256))]),i("div",bs,[k(O,{type:"chat",onClick:x[14]||(x[14]=M=>t(n).showSendWindow=!1)},{default:w(()=>[$(f(y.$t("Отмена")),1)]),_:1})])]),_:1})):r.showPinnedWarn?(h(),P(X,{key:2,type:"resize",onShowModal:x[18]||(x[18]=M=>{r.showPinnedWarn=!1,r.messageObject={}})},{default:w(()=>[i("div",null,[i("p",_s,f(y.$t("Закрепить это сообщение?")),1)]),i("div",$s,[k(O,{type:"chat",onClick:x[16]||(x[16]=M=>{r.showPinnedWarn=!1,t(n).messagePinned={}})},{default:w(()=>[$(f(y.$t("Отмена")),1)]),_:1}),k(O,{type:"chat",onClick:x[17]||(x[17]=M=>{var E;t(n).makePinned({messages:[(E=t(n).messagePinned)==null?void 0:E.id]}).then(W=>{t(n).messagePinned={},t(Q).info("Сообщение закреплено",{autoClose:1500,theme:"auto"})}),u.value=!1,r.showPinnedWarn=!1})},{default:w(()=>[$(f(y.$t("Закрепить")),1)]),_:1})])]),_:1})):r.showUnPinWarn?(h(),P(X,{key:3,type:"resize",onShowModal:x[21]||(x[21]=M=>{r.showUnPinWarn=!1,r.messageObject={}})},{default:w(()=>[i("div",null,[i("p",Ms,f(y.$t("Открепить это сообщение?")),1)]),i("div",Ss,[k(O,{type:"chat",onClick:x[19]||(x[19]=M=>r.showUnPinWarn=!1)},{default:w(()=>[$(f(y.$t("Отмена")),1)]),_:1}),k(O,{type:"chat",onClick:x[20]||(x[20]=M=>{var E;t(n).makePinned({messages:[(E=r.messageObject)==null?void 0:E.id]}).then(W=>{t(Q).info("Сообщение откреплено",{autoClose:1500,theme:"auto"})}),u.value=!1,r.showUnPinWarn=!1})},{default:w(()=>[$(f(y.$t("Открепить")),1)]),_:1})])]),_:1})):r.showDateModal?(h(),P(X,{key:4,type:"resize",onShowModal:x[22]||(x[22]=M=>r.showDateModal=!1)})):_("",!0)]),_:1})],544)}}});var ae=new Map;function Ws(r){var e=ae.get(r);e&&e.destroy()}function Ts(r){var e=ae.get(r);e&&e.update()}var re=null;typeof window>"u"?((re=function(r){return r}).destroy=function(r){return r},re.update=function(r){return r}):((re=function(r,e){return r&&Array.prototype.forEach.call(r.length?r:[r],function(s){return function(n){if(n&&n.nodeName&&n.nodeName==="TEXTAREA"&&!ae.has(n)){var o,l=null,a=window.getComputedStyle(n),d=(o=n.value,function(){c({testForHeightReduction:o===""||!n.value.startsWith(o),restoreTextAlign:null}),o=n.value}),u=(function(v){n.removeEventListener("autosize:destroy",u),n.removeEventListener("autosize:update",p),n.removeEventListener("input",d),window.removeEventListener("resize",p),Object.keys(v).forEach(function(m){return n.style[m]=v[m]}),ae.delete(n)}).bind(n,{height:n.style.height,resize:n.style.resize,textAlign:n.style.textAlign,overflowY:n.style.overflowY,overflowX:n.style.overflowX,wordWrap:n.style.wordWrap});n.addEventListener("autosize:destroy",u),n.addEventListener("autosize:update",p),n.addEventListener("input",d),window.addEventListener("resize",p),n.style.overflowX="hidden",n.style.wordWrap="break-word",ae.set(n,{destroy:u,update:p}),p()}function c(v){var m,C,b=v.restoreTextAlign,L=b===void 0?null:b,S=v.testForHeightReduction,y=S===void 0||S,x=a.overflowY;if(n.scrollHeight!==0&&(a.resize==="vertical"?n.style.resize="none":a.resize==="both"&&(n.style.resize="horizontal"),y&&(m=function(D){for(var T=[];D&&D.parentNode&&D.parentNode instanceof Element;)D.parentNode.scrollTop&&T.push([D.parentNode,D.parentNode.scrollTop]),D=D.parentNode;return function(){return T.forEach(function(M){var E=M[0],W=M[1];E.style.scrollBehavior="auto",E.scrollTop=W,E.style.scrollBehavior=null})}}(n),n.style.height=""),C=a.boxSizing==="content-box"?n.scrollHeight-(parseFloat(a.paddingTop)+parseFloat(a.paddingBottom)):n.scrollHeight+parseFloat(a.borderTopWidth)+parseFloat(a.borderBottomWidth),a.maxHeight!=="none"&&C>parseFloat(a.maxHeight)?(a.overflowY==="hidden"&&(n.style.overflow="scroll"),C=parseFloat(a.maxHeight)):a.overflowY!=="hidden"&&(n.style.overflow="hidden"),n.style.height=C+"px",L&&(n.style.textAlign=L),m&&m(),l!==C&&(n.dispatchEvent(new Event("autosize:resized",{bubbles:!0})),l=C),x!==a.overflow&&!L)){var z=a.textAlign;a.overflow==="hidden"&&(n.style.textAlign=z==="start"?"end":"start"),c({restoreTextAlign:z,testForHeightReduction:!0})}}function p(){c({testForHeightReduction:!0,restoreTextAlign:null})}}(s)}),r}).destroy=function(r){return r&&Array.prototype.forEach.call(r.length?r:[r],Ws),r},re.update=function(r){return r&&Array.prototype.forEach.call(r.length?r:[r],Ts),r});var Ps=re;const ye=Ps,Es=["v-model","value"],Ds=j({__name:"TheTextareaAutosize",props:{modelValue:{type:String,default:""}},setup(r){const e=R();return ie(()=>{ye.destroy(e.value),ht(e.value)}),Qe(()=>{ye(e.value),console.log(12312312)}),et(()=>{ye.destroy(e.value)}),(s,n)=>(h(),g("textarea",{onInput:n[0]||(n[0]=o=>s.$emit("update:modelValue",o.target.value)),"v-model":r.modelValue,value:r.modelValue,ref_key:"el",ref:e,class:"bg-whiteLilia placeholder-style p-4 resize-none example break-words dark:bg-gray-700 w-full max-h-[300px] items-center outline-none text-sm",placeholder:"Написать сообщение..."},null,40,Es))}}),Ue=we(Ds,[["__scopeId","data-v-b3e63d48"]]),js={key:0,class:"w-full h-[60px] dark:bg-gray-700 bg-gray-200 border-t border-l border-black dark:border-opacity-20 border-opacity-10 z-10"},Rs={class:"flex items-center p-3 gap-x-2"},Us=i("div",{class:"w-[2px] h-[40px] bg-semiCyan"},null,-1),Vs={class:"text-sm w-full"},Os={class:"dark:text-semiCyan text-blueSemiLight tracking-wide"},zs=i("svg",{class:"fill-gray-500",width:"30px",height:"30px",viewBox:"0 -0.5 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg","data-v-inspector":"components/Chat/ChatContent.vue:55:17"},[i("path",{d:"M6.96967 16.4697C6.67678 16.7626 6.67678 17.2374 6.96967 17.5303C7.26256 17.8232 7.73744 17.8232 8.03033 17.5303L6.96967 16.4697ZM13.0303 12.5303C13.3232 12.2374 13.3232 11.7626 13.0303 11.4697C12.7374 11.1768 12.2626 11.1768 11.9697 11.4697L13.0303 12.5303ZM11.9697 11.4697C11.6768 11.7626 11.6768 12.2374 11.9697 12.5303C12.2626 12.8232 12.7374 12.8232 13.0303 12.5303L11.9697 11.4697ZM18.0303 7.53033C18.3232 7.23744 18.3232 6.76256 18.0303 6.46967C17.7374 6.17678 17.2626 6.17678 16.9697 6.46967L18.0303 7.53033ZM13.0303 11.4697C12.7374 11.1768 12.2626 11.1768 11.9697 11.4697C11.6768 11.7626 11.6768 12.2374 11.9697 12.5303L13.0303 11.4697ZM16.9697 17.5303C17.2626 17.8232 17.7374 17.8232 18.0303 17.5303C18.3232 17.2374 18.3232 16.7626 18.0303 16.4697L16.9697 17.5303ZM11.9697 12.5303C12.2626 12.8232 12.7374 12.8232 13.0303 12.5303C13.3232 12.2374 13.3232 11.7626 13.0303 11.4697L11.9697 12.5303ZM8.03033 6.46967C7.73744 6.17678 7.26256 6.17678 6.96967 6.46967C6.67678 6.76256 6.67678 7.23744 6.96967 7.53033L8.03033 6.46967ZM8.03033 17.5303L13.0303 12.5303L11.9697 11.4697L6.96967 16.4697L8.03033 17.5303ZM13.0303 12.5303L18.0303 7.53033L16.9697 6.46967L11.9697 11.4697L13.0303 12.5303ZM11.9697 12.5303L16.9697 17.5303L18.0303 16.4697L13.0303 11.4697L11.9697 12.5303ZM13.0303 11.4697L8.03033 6.46967L6.96967 7.53033L11.9697 12.5303L13.0303 11.4697Z","data-v-inspector":"components/Chat/ChatContent.vue:57:19"})],-1),Bs=[zs],As=i("svg",{class:"stroke-gray-500",width:"30px",height:"30px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M13.6318 8.22382L13.2654 7.85744C11.7353 6.32736 10.9703 5.56232 10.1409 5.56299C9.86995 5.56321 9.60189 5.61847 9.35297 5.72542C8.59095 6.05283 8.19087 7.05807 7.39072 9.06855L7.33281 9.21406C7.10596 9.78403 6.99254 10.069 6.8104 10.2989C6.67221 10.4733 6.50589 10.6235 6.31829 10.7431C6.071 10.9009 5.77593 10.9846 5.18578 11.1521C4.27067 11.4118 3.81311 11.5417 3.61005 11.8186C3.45915 12.0244 3.39264 12.2802 3.42416 12.5334C3.46657 12.8742 3.80289 13.2105 4.47554 13.8832L7.60603 17.0137C8.27867 17.6863 8.61499 18.0226 8.95577 18.065C9.20903 18.0966 9.46475 18.03 9.67057 17.8791C9.94751 17.6761 10.0774 17.2185 10.3371 16.3034C10.5046 15.7133 10.5883 15.4182 10.7461 15.1709C10.8657 14.9833 11.0159 14.817 11.1903 14.6788C11.4202 14.4967 11.7052 14.3832 12.2751 14.1564L12.4206 14.0985C14.4311 13.2983 15.4364 12.8982 15.7638 12.1362C15.8707 11.8873 15.926 11.6192 15.9262 11.3483C15.9269 10.5189 15.1618 9.7539 13.6318 8.22382Z","stroke-width":"1.5"}),i("path",{d:"M3.34679 18.142L6.04053 15.4482","stroke-width":"1.5","stroke-linecap":"round"}),i("path",{d:"M22 8H17","stroke-width":"1.5","stroke-linecap":"round"}),i("path",{d:"M22 12.5H18","stroke-width":"1.5","stroke-linecap":"round"}),i("path",{d:"M22 17H13","stroke-width":"1.5","stroke-linecap":"round"})],-1),Hs=[As],Is={class:"text-lg tracking-wider"},Ns={class:"flex mt-4 gap-x-4 justify-center"},Zs=j({__name:"TheChatContentPinned",props:{arrayPin:{type:Array,default:()=>[]},showWarnPinned:{type:Boolean,default:!1}},setup(r){ee();const e=U(),s=R({});return tt(()=>{e.arrayPin=e.get_pinned_list,s.value=e.arrayPin[0]}),(n,o)=>(h(),P(B,{name:"slide-down"},{default:w(()=>{var l,a,d;return[t(e).arrayPin.length?(h(),g("div",js,[i("div",Rs,[Us,i("div",Vs,[i("p",Os,f(n.$t("Закреплённое сообщение")),1),i("p",null,f(((l=t(s))==null?void 0:l.text.length)>30?((a=t(s).text)==null?void 0:a.slice(0,30))+"...":(d=t(s))==null?void 0:d.text),1)]),i("div",null,[t(e).arrayPin.length<2?(h(),g("button",{key:0,onClick:o[0]||(o[0]=u=>r.showWarnPinned=!0)},Bs)):(h(),g("button",{key:1,onClick:o[1]||(o[1]=u=>t(e).showPinnedWindow=!t(e).showPinnedWindow)},Hs))])]),r.showWarnPinned?(h(),P(X,{key:0,type:"resize",onShowModal:o[4]||(o[4]=u=>r.showWarnPinned=!1)},{default:w(()=>[i("div",null,[i("p",Is,f(n.$t("Открепить это сообщение?")),1)]),i("div",Ns,[k(O,{type:"chat",onClick:o[2]||(o[2]=u=>r.showWarnPinned=!1)},{default:w(()=>[$(f(n.$t("Отмена")),1)]),_:1}),k(O,{type:"chat",onClick:o[3]||(o[3]=u=>{t(e).makePinned({messages:[t(s).id]}).then(c=>{t(Q).info("Сообщение откреплено",{autoClose:1500,theme:"auto"})}),r.showWarnPinned=!1})},{default:w(()=>[$(f(n.$t("Открепить")),1)]),_:1})])]),_:1})):_("",!0)])):_("",!0)]}),_:1}))}}),Fs=j({__name:"ChatUploadInfo",setup(r){const e=U();return(s,n)=>(h(),P(B,{name:"fade"},{default:w(()=>[t(e).showDragInfo?(h(),g("p",{key:0,onDragleave:n[0]||(n[0]=V(o=>t(e).showDragInfo=!1,["stop"])),onDrop:n[1]||(n[1]=V(()=>{},["prevent"])),onDragend:n[2]||(n[2]=V(()=>{},["prevent"])),class:"bg-black flex bg-opacity-60 z-20 backdrop-blur-sm w-full h-full absolute top-0 bottom-0 right-0 justify-center items-center my-auto text-white tracking-widest"},f(s.$t("Перетащите сюда файлы для отправки")),33)):_("",!0)]),_:1}))}}),Xs={key:0,class:"flex justify-center w-full mx-auto ml-2"},qs=i("svg",{class:"fill-gray-500 dark:hover:fill-gray-300 hover:fill-gray-700 transition-all",width:"35px",height:"35px",viewBox:"0 0 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M5.469 16.688l8.75-8.75c0.094-0.094 0.844-0.844 2.031-1.25 1.656-0.531 3.344-0.094 4.688 1.25 1.375 1.344 1.781 3 1.25 4.656-0.375 1.188-1.156 2-1.25 2.094l-9.406 9.406c-1.625 1.625-5.688 3.719-9.438 0-3.719-3.719-1.594-7.813 0-9.406l10.094-10.125c0.375-0.375 0.969-0.375 1.344 0s0.375 0.969 0 1.344l-10.063 10.125c-0.156 0.125-3.313 3.406 0 6.719 3.219 3.219 6.375 0.344 6.719 0l9.406-9.438s0.531-0.531 0.781-1.281c0.313-1 0.094-1.875-0.781-2.75-1.875-1.875-3.688-0.313-4.031 0l-8.75 8.719c-0.313 0.313-0.531 0.844 0 1.375s1.031 0.281 1.344 0l6.063-6.063c0.375-0.344 1-0.344 1.344 0 0.375 0.375 0.375 1 0 1.375l-6.063 6.031c-0.844 0.813-2.563 1.469-4.031 0-1.5-1.469-0.844-3.219 0-4.031z"})],-1),Gs=[qs],Ys={key:1,class:"flex justify-center items-center w-full mx-auto ml-3 mb-2"},Ks=i("svg",{class:"fill-semiCyan hover:fill-blueSemiLight transition-all",height:"20px",width:"20px",version:"1.1",id:"Capa_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 452.025 452.025","xml:space":"preserve"},[i("g",null,[i("g",null,[i("path",{d:`M147.912,363.325c-4.7-4.7-12.3-4.7-17,0c-4.7,4.7-4.7,12.3,0,17l13.6,13.6h-55.2c-35.9,0-65-29.2-65-65v-40.3\r
              c0-6.6-5.4-12-12-12s-12,5.4-12,12v40.3c0,49.1,39.9,89,89,89h55.2l-13.6,13.6c-4.7,4.7-4.7,12.3,0,17c2.3,2.3,5.4,3.5,8.5,3.5\r
              s6.1-1.2,8.5-3.5l34.1-34.1c4.7-4.7,4.7-12.3,0-17L147.912,363.325z`}),i("path",{d:`M210.312,0.025h-197.1c-6.6,0-12,5.4-12,12v197.1c0,6.6,5.4,12,12,12h197.1c6.6,0,12-5.4,12-12v-197.1\r
              C222.312,5.425,217.012,0.025,210.312,0.025z M198.312,197.125h-173.1v-173.1h173.1V197.125z`}),i("path",{d:`M362.612,34.125h-55.2l13.6-13.6c4.7-4.7,4.7-12.3,0-17s-12.3-4.7-17,0l-34,34.1c-4.7,4.7-4.7,12.3,0,17l34.1,34.1\r
              c2.3,2.3,5.4,3.5,8.5,3.5s6.1-1.2,8.5-3.5c4.7-4.7,4.7-12.3,0-17l-13.6-13.6h55.2c35.9,0,65,29.2,65,65v40.3c0,6.6,5.4,12,12,12\r
              s12-5.4,12-12v-40.3C451.712,74.025,411.712,34.125,362.612,34.125z`}),i("path",{d:`M438.812,428.025c-3.2,0-6.3,1.3-8.5,3.5s-3.5,5.3-3.5,8.5c0,3.1,1.3,6.3,3.5,8.5s5.3,3.5,8.5,3.5s6.3-1.3,8.5-3.5\r
              s3.5-5.3,3.5-8.5s-1.3-6.3-3.5-8.5C445.012,429.325,441.912,428.025,438.812,428.025z`}),i("path",{d:"M389.512,428.025c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S396.112,428.025,389.512,428.025z"}),i("path",{d:"M290.912,428.025c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S297.612,428.025,290.912,428.025z"}),i("path",{d:"M340.212,428.025c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S346.812,428.025,340.212,428.025z"}),i("path",{d:`M241.713,428.025c-3.2,0-6.3,1.3-8.5,3.5s-3.5,5.3-3.5,8.5c0,3.1,1.3,6.3,3.5,8.5s5.3,3.5,8.5,3.5c3.1,0,6.3-1.3,8.5-3.5\r
              s3.5-5.3,3.5-8.5s-1.3-6.3-3.5-8.5S244.812,428.025,241.713,428.025z`}),i("path",{d:"M241.713,378.725c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S248.312,378.725,241.713,378.725z"}),i("path",{d:"M241.713,329.425c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S248.312,329.425,241.713,329.425z"}),i("path",{d:"M241.713,280.125c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S248.312,280.125,241.713,280.125z"}),i("path",{d:`M241.713,230.925c-3.2,0-6.3,1.3-8.5,3.5s-3.5,5.3-3.5,8.5s1.3,6.3,3.5,8.5s5.3,3.5,8.5,3.5c3.1,0,6.3-1.3,8.5-3.5\r
              s3.5-5.3,3.5-8.5c0-3.1-1.3-6.3-3.5-8.5C247.912,232.125,244.812,230.925,241.713,230.925z`}),i("path",{d:"M389.512,230.925c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S396.112,230.925,389.512,230.925z"}),i("path",{d:"M340.212,230.925c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S346.812,230.925,340.212,230.925z"}),i("path",{d:"M290.912,230.925c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S297.612,230.925,290.912,230.925z"}),i("path",{d:`M438.812,230.925c-3.2,0-6.3,1.3-8.5,3.5s-3.5,5.3-3.5,8.5s1.3,6.3,3.5,8.5s5.3,3.5,8.5,3.5s6.3-1.3,8.5-3.5\r
              s3.5-5.3,3.5-8.5c0-3.1-1.3-6.3-3.5-8.5C445.012,232.225,441.912,230.925,438.812,230.925z`}),i("path",{d:"M438.812,280.125c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S445.412,280.125,438.812,280.125z"}),i("path",{d:"M438.812,378.725c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S445.412,378.725,438.812,378.725z"}),i("path",{d:"M438.812,329.425c-6.6,0-12,5.4-12,12s5.4,12,12,12s12-5.4,12-12S445.412,329.425,438.812,329.425z"})])])],-1),Js=[Ks],Qs=j({__name:"ChatUploadFile",setup(r){const e=U();return(s,n)=>(h(),g("label",{for:"loadFiles",class:Z(["mx-auto absolute bottom-5 z-0 cursor-pointer flex justify-center",{"right-16":!t(e).messageUpdate.file}])},[k(B,{name:"fade"},{default:w(()=>[!t(e).messageUpdate.file&&!t(e).messageUpdate.id&&!t(e).recordingVoice?(h(),g("div",Xs,Gs)):t(e).messageUpdate.file?(h(),g("div",Ys,Js)):_("",!0)]),_:1}),i("input",{id:"loadFiles",onChange:n[0]||(n[0]=o=>{t(ct)(o.target.files[0],t(e)),t(e).showUploadWindow=!0}),onInput:n[1]||(n[1]=o=>s.$emit("update:modelValue",o.target.value)),class:"hidden",type:"file"},null,32)],2))}});function A(r,e,s,n){return new(s||(s=Promise))(function(o,l){function a(c){try{u(n.next(c))}catch(p){l(p)}}function d(c){try{u(n.throw(c))}catch(p){l(p)}}function u(c){var p;c.done?o(c.value):(p=c.value,p instanceof s?p:new s(function(v){v(p)})).then(a,d)}u((n=n.apply(r,e||[])).next())})}let le=class{constructor(){this.listeners={}}on(e,s,n){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(s),n==null?void 0:n.once){const o=()=>{this.un(e,o),this.un(e,s)};return this.on(e,o),o}return()=>this.un(e,s)}un(e,s){var n;(n=this.listeners[e])===null||n===void 0||n.delete(s)}once(e,s){return this.on(e,s,{once:!0})}unAll(){this.listeners={}}emit(e,...s){this.listeners[e]&&this.listeners[e].forEach(n=>n(...s))}};const ue={decode:function(r,e){return A(this,void 0,void 0,function*(){const s=new AudioContext({sampleRate:e});return s.decodeAudioData(r).finally(()=>s.close())})},createBuffer:function(r,e){return typeof r[0]=="number"&&(r=[r]),function(s){const n=s[0];if(n.some(o=>o>1||o<-1)){const o=n.length;let l=0;for(let a=0;a<o;a++){const d=Math.abs(n[a]);d>l&&(l=d)}for(const a of s)for(let d=0;d<o;d++)a[d]/=l}}(r),{duration:e,length:r[0].length,sampleRate:r[0].length/e,numberOfChannels:r.length,getChannelData:s=>r==null?void 0:r[s],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function Fe(r,e){const s=e.xmlns?document.createElementNS(e.xmlns,r):document.createElement(r);for(const[n,o]of Object.entries(e))if(n==="children")for(const[l,a]of Object.entries(e))typeof a=="string"?s.appendChild(document.createTextNode(a)):s.appendChild(Fe(l,a));else n==="style"?Object.assign(s.style,o):n==="textContent"?s.textContent=o:s.setAttribute(n,o.toString());return s}function Ve(r,e,s){const n=Fe(r,e||{});return s==null||s.appendChild(n),n}var en=Object.freeze({__proto__:null,createElement:Ve,default:Ve});const tn={fetchBlob:function(r,e,s){return A(this,void 0,void 0,function*(){const n=yield fetch(r,s);if(n.status>=400)throw new Error(`Failed to fetch ${r}: ${n.status} (${n.statusText})`);return function(o,l){A(this,void 0,void 0,function*(){if(!o.body||!o.headers)return;const a=o.body.getReader(),d=Number(o.headers.get("Content-Length"))||0;let u=0;const c=v=>A(this,void 0,void 0,function*(){u+=(v==null?void 0:v.length)||0;const m=Math.round(u/d*100);l(m)}),p=()=>A(this,void 0,void 0,function*(){let v;try{v=yield a.read()}catch{return}v.done||(c(v.value),yield p())});p()})}(n.clone(),e),n.blob()})}};class sn extends le{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)},{once:!0})}onMediaEvent(e,s,n){return this.media.addEventListener(e,s,n),()=>this.media.removeEventListener(e,s,n)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,s){const n=this.getSrc();if(e&&n===e)return;this.revokeSrc();const o=s instanceof Blob&&(this.canPlayType(s.type)||!e)?URL.createObjectURL(s):e;n&&(this.media.src="");try{this.media.src=o}catch{this.media.src=e}}destroy(){this.isExternalMedia||(this.media.pause(),this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(e){this.media=e}play(){return A(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=Math.max(0,Math.min(e,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,s){s!=null&&(this.media.preservesPitch=s),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}class se extends le{constructor(e,s){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.subscriptions=[],this.options=e;const n=this.parentFromOptionsContainer(e.container);this.parent=n;const[o,l]=this.initHtml();n.appendChild(o),this.container=o,this.scrollContainer=l.querySelector(".scroll"),this.wrapper=l.querySelector(".wrapper"),this.canvasWrapper=l.querySelector(".canvases"),this.progressWrapper=l.querySelector(".progress"),this.cursor=l.querySelector(".cursor"),s&&l.appendChild(s),this.initEvents()}parentFromOptionsContainer(e){let s;if(typeof e=="string"?s=document.querySelector(e):e instanceof HTMLElement&&(s=e),!s)throw new Error("Container not found");return s}initEvents(){const e=s=>{const n=this.wrapper.getBoundingClientRect(),o=s.clientX-n.left,l=s.clientY-n.top;return[o/n.width,l/n.height]};if(this.wrapper.addEventListener("click",s=>{const[n,o]=e(s);this.emit("click",n,o)}),this.wrapper.addEventListener("dblclick",s=>{const[n,o]=e(s);this.emit("dblclick",n,o)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:s,scrollWidth:n,clientWidth:o}=this.scrollContainer,l=s/n,a=(s+o)/n;this.emit("scroll",l,a,s,s+o)}),typeof ResizeObserver=="function"){const s=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{s().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender())}initDrag(){this.subscriptions.push(function(e,s,n,o,l=3,a=0,d=100){if(!e)return()=>{};const u=matchMedia("(pointer: coarse)").matches;let c=()=>{};const p=v=>{if(v.button!==a)return;v.preventDefault(),v.stopPropagation();let m=v.clientX,C=v.clientY,b=!1;const L=Date.now(),S=T=>{if(T.preventDefault(),T.stopPropagation(),u&&Date.now()-L<d)return;const M=T.clientX,E=T.clientY,W=M-m,H=E-C;if(b||Math.abs(W)>l||Math.abs(H)>l){const N=e.getBoundingClientRect(),{left:Y,top:oe}=N;b||(n==null||n(m-Y,C-oe),b=!0),s(W,H,M-Y,E-oe),m=M,C=E}},y=T=>{if(b){const M=T.clientX,E=T.clientY,W=e.getBoundingClientRect(),{left:H,top:N}=W;o==null||o(M-H,E-N)}c()},x=T=>{T.relatedTarget&&T.relatedTarget!==document.documentElement||y(T)},z=T=>{b&&(T.stopPropagation(),T.preventDefault())},D=T=>{b&&T.preventDefault()};document.addEventListener("pointermove",S),document.addEventListener("pointerup",y),document.addEventListener("pointerout",x),document.addEventListener("pointercancel",x),document.addEventListener("touchmove",D,{passive:!1}),document.addEventListener("click",z,{capture:!0}),c=()=>{document.removeEventListener("pointermove",S),document.removeEventListener("pointerup",y),document.removeEventListener("pointerout",x),document.removeEventListener("pointercancel",x),document.removeEventListener("touchmove",D),setTimeout(()=>{document.removeEventListener("click",z,{capture:!0})},10)}};return e.addEventListener("pointerdown",p),()=>{c(),e.removeEventListener("pointerdown",p)}}(this.wrapper,(e,s,n)=>{this.emit("drag",Math.max(0,Math.min(1,n/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))}))}getHeight(e,s){var n;const o=((n=this.audioData)===null||n===void 0?void 0:n.numberOfChannels)||1;if(e==null)return 128;if(!isNaN(Number(e)))return Number(e);if(e==="auto"){const l=this.parent.clientHeight||128;return s!=null&&s.every(a=>!a.overlay)?l/o:l}return 128}initHtml(){const e=document.createElement("div"),s=e.attachShadow({mode:"open"}),n=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return s.innerHTML=`
      <style${n?` nonce="${n}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,s]}setOptions(e){if(this.options.container!==e.container){const s=this.parentFromOptionsContainer(e.container);s.appendChild(this.container),this.parent=s}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){const{scrollWidth:s}=this.scrollContainer,n=s*e;this.setScroll(n)}destroy(){var e,s;this.subscriptions.forEach(n=>n()),this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(s=this.unsubscribeOnScroll)===null||s===void 0||s.forEach(n=>n()),this.unsubscribeOnScroll=[]}createDelay(e=10){let s,n;const o=()=>{s&&clearTimeout(s),n&&n()};return this.timeouts.push(o),()=>new Promise((l,a)=>{o(),n=a,s=setTimeout(()=>{s=void 0,n=void 0,l()},e)})}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length<2)return e[0]||"";const s=document.createElement("canvas"),n=s.getContext("2d"),o=s.height*(window.devicePixelRatio||1),l=n.createLinearGradient(0,0,0,o),a=1/(e.length-1);return e.forEach((d,u)=>{const c=u*a;l.addColorStop(c,d)}),l}getPixelRatio(){return Math.max(1,window.devicePixelRatio||1)}renderBarWaveform(e,s,n,o){const l=e[0],a=e[1]||e[0],d=l.length,{width:u,height:c}=n.canvas,p=c/2,v=this.getPixelRatio(),m=s.barWidth?s.barWidth*v:1,C=s.barGap?s.barGap*v:s.barWidth?m/2:0,b=s.barRadius||0,L=u/(m+C)/d,S=b&&"roundRect"in n?"roundRect":"rect";n.beginPath();let y=0,x=0,z=0;for(let D=0;D<=d;D++){const T=Math.round(D*L);if(T>y){const W=Math.round(x*p*o),H=W+Math.round(z*p*o)||1;let N=p-W;s.barAlign==="top"?N=0:s.barAlign==="bottom"&&(N=c-H),n[S](y*(m+C),N,m,H,b),y=T,x=0,z=0}const M=Math.abs(l[D]||0),E=Math.abs(a[D]||0);M>x&&(x=M),E>z&&(z=E)}n.fill(),n.closePath()}renderLineWaveform(e,s,n,o){const l=a=>{const d=e[a]||e[0],u=d.length,{height:c}=n.canvas,p=c/2,v=n.canvas.width/u;n.moveTo(0,p);let m=0,C=0;for(let b=0;b<=u;b++){const L=Math.round(b*v);if(L>m){const y=p+(Math.round(C*p*o)||1)*(a===0?-1:1);n.lineTo(m,y),m=L,C=0}const S=Math.abs(d[b]||0);S>C&&(C=S)}n.lineTo(m,p)};n.beginPath(),l(0),l(1),n.fill(),n.closePath()}renderWaveform(e,s,n){if(n.fillStyle=this.convertColorValues(s.waveColor),s.renderFunction)return void s.renderFunction(e,n);let o=s.barHeight||1;if(s.normalize){const l=Array.from(e[0]).reduce((a,d)=>Math.max(a,Math.abs(d)),0);o=l?1/l:1}s.barWidth||s.barGap||s.barAlign?this.renderBarWaveform(e,s,n,o):this.renderLineWaveform(e,s,n,o)}renderSingleCanvas(e,s,n,o,l,a,d){const u=this.getPixelRatio(),c=document.createElement("canvas");c.width=Math.round(n*u),c.height=Math.round(o*u),c.style.width=`${n}px`,c.style.height=`${o}px`,c.style.left=`${Math.round(l)}px`,a.appendChild(c);const p=c.getContext("2d");if(this.renderWaveform(e,s,p),c.width>0&&c.height>0){const v=c.cloneNode(),m=v.getContext("2d");m.drawImage(c,0,0),m.globalCompositeOperation="source-in",m.fillStyle=this.convertColorValues(s.progressColor),m.fillRect(0,0,c.width,c.height),d.appendChild(v)}}renderMultiCanvas(e,s,n,o,l,a){const d=this.getPixelRatio(),{clientWidth:u}=this.scrollContainer,c=n/d;let p=Math.min(se.MAX_CANVAS_WIDTH,u,c),v={};if(p===0)return;if(s.barWidth||s.barGap){const S=s.barWidth||.5,y=S+(s.barGap||S/2);p%y!=0&&(p=Math.floor(p/y)*y)}const m=S=>{if(S<0||S>=C||v[S])return;v[S]=!0;const y=S*p,x=Math.min(c-y,p);if(x<=0)return;const z=e.map(D=>{const T=Math.floor(y/c*D.length),M=Math.floor((y+x)/c*D.length);return D.slice(T,M)});this.renderSingleCanvas(z,s,x,o,y,l,a)},C=Math.ceil(c/p);if(!this.isScrollable){for(let S=0;S<C;S++)m(S);return}const b=this.scrollContainer.scrollLeft/c,L=Math.floor(b*C);if(m(L-1),m(L),m(L+1),C>1){const S=this.on("scroll",()=>{const{scrollLeft:y}=this.scrollContainer,x=Math.floor(y/c*C);Object.keys(v).length>se.MAX_NODES&&(l.innerHTML="",a.innerHTML="",v={}),m(x-1),m(x),m(x+1)});this.unsubscribeOnScroll.push(S)}}renderChannel(e,s,n,o){var{overlay:l}=s,a=function(p,v){var m={};for(var C in p)Object.prototype.hasOwnProperty.call(p,C)&&v.indexOf(C)<0&&(m[C]=p[C]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function"){var b=0;for(C=Object.getOwnPropertySymbols(p);b<C.length;b++)v.indexOf(C[b])<0&&Object.prototype.propertyIsEnumerable.call(p,C[b])&&(m[C[b]]=p[C[b]])}return m}(s,["overlay"]);const d=document.createElement("div"),u=this.getHeight(a.height,a.splitChannels);d.style.height=`${u}px`,l&&o>0&&(d.style.marginTop=`-${u}px`),this.canvasWrapper.style.minHeight=`${u}px`,this.canvasWrapper.appendChild(d);const c=d.cloneNode();this.progressWrapper.appendChild(c),this.renderMultiCanvas(e,a,n,u,d,c)}render(e){return A(this,void 0,void 0,function*(){var s;this.timeouts.forEach(u=>u()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const n=this.getPixelRatio(),o=this.scrollContainer.clientWidth,l=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrollable=l>o;const a=this.options.fillParent&&!this.isScrollable,d=(a?o:l)*n;if(this.wrapper.style.width=a?"100%":`${l}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let u=0;u<e.numberOfChannels;u++){const c=Object.assign(Object.assign({},this.options),(s=this.options.splitChannels)===null||s===void 0?void 0:s[u]);this.renderChannel([e.getChannelData(u)],c,d,u)}else{const u=[e.getChannelData(0)];e.numberOfChannels>1&&u.push(e.getChannelData(1)),this.renderChannel(u,this.options,d,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){if(this.unsubscribeOnScroll.forEach(n=>n()),this.unsubscribeOnScroll=[],!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:s}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:n}=this.progressWrapper.getBoundingClientRect();let o=n-s;o*=2,o=o<0?Math.floor(o):Math.ceil(o),o/=2,this.scrollContainer.scrollLeft+=o}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,s=!1){const{scrollLeft:n,scrollWidth:o,clientWidth:l}=this.scrollContainer,a=e*o,d=n,u=n+l,c=l/2;if(this.isDragging)a+30>u?this.scrollContainer.scrollLeft+=30:a-30<d&&(this.scrollContainer.scrollLeft-=30);else{(a<d||a>u)&&(this.scrollContainer.scrollLeft=a-(this.options.autoCenter?c:0));const p=a-n-c;s&&this.options.autoCenter&&p>0&&(this.scrollContainer.scrollLeft+=Math.min(p,10))}{const p=this.scrollContainer.scrollLeft,v=p/o,m=(p+l)/o;this.emit("scroll",v,m,p,p+l)}}renderProgress(e,s){if(isNaN(e))return;const n=100*e;this.canvasWrapper.style.clipPath=`polygon(${n}% 0, 100% 0, 100% 100%, ${n}% 100%)`,this.progressWrapper.style.width=`${n}%`,this.cursor.style.left=`${n}%`,this.cursor.style.transform=`translateX(-${Math.round(n)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(e,s)}exportImage(e,s,n){return A(this,void 0,void 0,function*(){const o=this.canvasWrapper.querySelectorAll("canvas");if(!o.length)throw new Error("No waveform data");if(n==="dataURL"){const l=Array.from(o).map(a=>a.toDataURL(e,s));return Promise.resolve(l)}return Promise.all(Array.from(o).map(l=>new Promise((a,d)=>{l.toBlob(u=>{u?a(u):d(new Error("Could not export image"))},e,s)})))})}}se.MAX_CANVAS_WIDTH=8e3,se.MAX_NODES=10;class nn extends le{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}class xe extends le{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return A(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then(s=>{if(s.status>=400)throw new Error(`Failed to fetch ${e}: ${s.status} (${s.statusText})`);return s.arrayBuffer()}).then(s=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(s)).then(s=>{this.currentSrc===e&&(this.buffer=s,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var e;if(!this.paused)return;this.paused=!1,(e=this.bufferNode)===null||e===void 0||e.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let s=this.playedDuration*this._playbackRate;(s>=this.duration||s<0)&&(s=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,s),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return A(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){var s,n;const o=e-this.currentTime;(s=this.bufferNode)===null||s===void 0||s.stop(this.audioContext.currentTime+o),(n=this.bufferNode)===null||n===void 0||n.addEventListener("ended",()=>{this.bufferNode=null,this.pause()},{once:!0})}setSinkId(e){return A(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){const s=!this.paused;s&&this._pause(),this.playedDuration=e/this._playbackRate,s&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,s;return(e=this._duration)!==null&&e!==void 0?e:((s=this.buffer)===null||s===void 0?void 0:s.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){const e=[];if(!this.buffer)return e;const s=this.buffer.numberOfChannels;for(let n=0;n<s;n++)e.push(this.buffer.getChannelData(n));return e}}const on={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class ne extends sn{static create(e){return new ne(e)}constructor(e){const s=e.media||(e.backend==="WebAudio"?new xe:void 0);super({media:s,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},on,e),this.timer=new nn;const n=s?void 0:this.getMediaElement();this.renderer=new se(this.options,n),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const o=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");const{peaks:l,duration:a}=this.options;(o||l&&a)&&this.load(o,l,a).catch(()=>null)})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e),this.stopAtPosition!=null&&this.isPlaying()&&e>=this.stopAtPosition&&this.pause()}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("emptied",()=>{this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("ended",()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",()=>{var e;this.emit("error",(e=this.getMediaElement().error)!==null&&e!==void 0?e:new Error("Media error")),this.stopAtPosition=null}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,s)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,s))}),this.renderer.on("dblclick",(e,s)=>{this.emit("dblclick",e,s)}),this.renderer.on("scroll",(e,s,n,o)=>{const l=this.getDuration();this.emit("scroll",e*l,s*l,n,o)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",e=>{this.emit("dragstart",e)}),this.renderer.on("dragend",e=>{this.emit("dragend",e)}));{let e;this.subscriptions.push(this.renderer.on("drag",s=>{if(!this.options.interact)return;let n;this.renderer.renderProgress(s),clearTimeout(e),this.isPlaying()?n=0:this.options.dragToSeek===!0?n=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(n=this.options.dragToSeek.debounceTime),e=setTimeout(()=>{this.seekTo(s)},n),this.emit("interaction",s*this.getDuration()),this.emit("drag",s)}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(s=>{this.registerPlugin(s)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),e.duration&&!e.peaks&&(this.decodedData=ue.createBuffer(this.exportPeaks(),e.duration)),e.peaks&&e.duration&&(this.decodedData=ue.createBuffer(e.peaks,e.duration)),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){return e._init(this),this.plugins.push(e),this.subscriptions.push(e.once("destroy",()=>{this.plugins=this.plugins.filter(s=>s!==e)})),e}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){const s=e/this.getDuration();this.renderer.setScrollPercentage(s)}getActivePlugins(){return this.plugins}loadAudio(e,s,n,o){return A(this,void 0,void 0,function*(){var l;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,!s&&!n){const d=this.options.fetchParams||{};window.AbortController&&!d.signal&&(this.abortController=new AbortController,d.signal=(l=this.abortController)===null||l===void 0?void 0:l.signal);const u=p=>this.emit("loading",p);s=yield tn.fetchBlob(e,u,d);const c=this.options.blobMimeType;c&&(s=new Blob([s],{type:c}))}this.setSrc(e,s);const a=yield new Promise(d=>{const u=o||this.getDuration();u?d(u):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>d(this.getDuration()),{once:!0}))});if(!e&&!s){const d=this.getMediaElement();d instanceof xe&&(d.duration=a)}if(n)this.decodedData=ue.createBuffer(n,a||0);else if(s){const d=yield s.arrayBuffer();this.decodedData=yield ue.decode(d,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,s,n){return A(this,void 0,void 0,function*(){try{return yield this.loadAudio(e,void 0,s,n)}catch(o){throw this.emit("error",o),o}})}loadBlob(e,s,n){return A(this,void 0,void 0,function*(){try{return yield this.loadAudio("",e,s,n)}catch(o){throw this.emit("error",o),o}})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:s=8e3,precision:n=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const o=Math.min(e,this.decodedData.numberOfChannels),l=[];for(let a=0;a<o;a++){const d=this.decodedData.getChannelData(a),u=[],c=d.length/s;for(let p=0;p<s;p++){const v=d.slice(Math.floor(p*c),Math.ceil((p+1)*c));let m=0;for(let C=0;C<v.length;C++){const b=v[C];Math.abs(b)>Math.abs(m)&&(m=b)}u.push(Math.round(m*n)/n)}l.push(u)}return l}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){this.stopAtPosition=null,super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){const s=this.getDuration()*e;this.setTime(s)}play(e,s){const n=Object.create(null,{play:{get:()=>super.play}});return A(this,void 0,void 0,function*(){return e!=null&&this.setTime(e),s!=null&&(this.media instanceof xe?this.media.stopAt(s):this.stopAtPosition=s),n.play.call(this)})}playPause(){return A(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return A(this,arguments,void 0,function*(e="image/png",s=1,n="dataURL"){return this.renderer.exportImage(e,s,n)})}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach(s=>s.destroy()),this.subscriptions.forEach(s=>s()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}ne.BasePlugin=class extends le{constructor(r){super(),this.subscriptions=[],this.options=r}onInit(){}_init(r){this.wavesurfer=r,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(r=>r())}},ne.dom=en;function ke(r,e,s,n){return new(s||(s=Promise))(function(o,l){function a(c){try{u(n.next(c))}catch(p){l(p)}}function d(c){try{u(n.throw(c))}catch(p){l(p)}}function u(c){var p;c.done?o(c.value):(p=c.value,p instanceof s?p:new s(function(v){v(p)})).then(a,d)}u((n=n.apply(r,e||[])).next())})}class Xe{constructor(){this.listeners={}}on(e,s,n){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(s),n==null?void 0:n.once){const o=()=>{this.un(e,o),this.un(e,s)};return this.on(e,o),o}return()=>this.un(e,s)}un(e,s){var n;(n=this.listeners[e])===null||n===void 0||n.delete(s)}once(e,s){return this.on(e,s,{once:!0})}unAll(){this.listeners={}}emit(e,...s){this.listeners[e]&&this.listeners[e].forEach(n=>n(...s))}}class rn extends Xe{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}}class an extends Xe{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}const ln=["audio/webm","audio/wav","audio/mpeg","audio/mp4","audio/mp3"];class me extends rn{constructor(e){var s,n,o,l,a,d;super(Object.assign(Object.assign({},e),{audioBitsPerSecond:(s=e.audioBitsPerSecond)!==null&&s!==void 0?s:128e3,scrollingWaveform:(n=e.scrollingWaveform)!==null&&n!==void 0&&n,scrollingWaveformWindow:(o=e.scrollingWaveformWindow)!==null&&o!==void 0?o:5,continuousWaveform:(l=e.continuousWaveform)!==null&&l!==void 0&&l,renderRecordedAudio:(a=e.renderRecordedAudio)===null||a===void 0||a,mediaRecorderTimeslice:(d=e.mediaRecorderTimeslice)!==null&&d!==void 0?d:void 0})),this.stream=null,this.mediaRecorder=null,this.dataWindow=null,this.isWaveformPaused=!1,this.lastStartTime=0,this.lastDuration=0,this.duration=0,this.timer=new an,this.subscriptions.push(this.timer.on("tick",()=>{const u=performance.now()-this.lastStartTime;this.duration=this.isPaused()?this.duration:this.lastDuration+u,this.emit("record-progress",this.duration)}))}static create(e){return new me(e||{})}renderMicStream(e){var s;const n=new AudioContext,o=n.createMediaStreamSource(e),l=n.createAnalyser();o.connect(l),this.options.continuousWaveform&&(l.fftSize=32);const a=l.frequencyBinCount,d=new Float32Array(a);let u=0;this.wavesurfer&&((s=this.originalOptions)!==null&&s!==void 0||(this.originalOptions=Object.assign({},this.wavesurfer.options)),this.wavesurfer.options.interact=!1,this.options.scrollingWaveform&&(this.wavesurfer.options.cursorWidth=0));const c=setInterval(()=>{var p,v,m,C;if(!this.isWaveformPaused){if(l.getFloatTimeDomainData(d),this.options.scrollingWaveform){const b=Math.floor((this.options.scrollingWaveformWindow||0)*n.sampleRate),L=Math.min(b,this.dataWindow?this.dataWindow.length+a:a),S=new Float32Array(b);if(this.dataWindow){const y=Math.max(0,b-this.dataWindow.length);S.set(this.dataWindow.slice(-L+a),y)}S.set(d,b-a),this.dataWindow=S}else if(this.options.continuousWaveform){if(!this.dataWindow){const L=this.options.continuousWaveformDuration?Math.round(100*this.options.continuousWaveformDuration):((v=(p=this.wavesurfer)===null||p===void 0?void 0:p.getWidth())!==null&&v!==void 0?v:0)*window.devicePixelRatio;this.dataWindow=new Float32Array(L)}let b=0;for(let L=0;L<a;L++){const S=Math.abs(d[L]);S>b&&(b=S)}if(u+1>this.dataWindow.length){const L=new Float32Array(2*this.dataWindow.length);L.set(this.dataWindow,0),this.dataWindow=L}this.dataWindow[u]=b,u++}else this.dataWindow=d;if(this.wavesurfer){const b=((C=(m=this.dataWindow)===null||m===void 0?void 0:m.length)!==null&&C!==void 0?C:0)/100;this.wavesurfer.load("",[this.dataWindow],this.options.scrollingWaveform?this.options.scrollingWaveformWindow:b).then(()=>{this.wavesurfer&&this.options.continuousWaveform&&(this.wavesurfer.setTime(this.getDuration()/1e3),this.wavesurfer.options.minPxPerSec||this.wavesurfer.setOptions({minPxPerSec:this.wavesurfer.getWidth()/this.wavesurfer.getDuration()}))}).catch(L=>{console.error("Error rendering real-time recording data:",L)})}}},10);return{onDestroy:()=>{clearInterval(c),o==null||o.disconnect(),n==null||n.close()},onEnd:()=>{this.isWaveformPaused=!0,clearInterval(c),this.stopMic()}}}startMic(e){return ke(this,void 0,void 0,function*(){let s;try{s=yield navigator.mediaDevices.getUserMedia({audio:!(e!=null&&e.deviceId)||{deviceId:e.deviceId}})}catch(l){throw new Error("Error accessing the microphone: "+l.message)}const{onDestroy:n,onEnd:o}=this.renderMicStream(s);return this.subscriptions.push(this.once("destroy",n)),this.subscriptions.push(this.once("record-end",o)),this.stream=s,s})}stopMic(){this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null,this.mediaRecorder=null)}startRecording(e){return ke(this,void 0,void 0,function*(){const s=this.stream||(yield this.startMic(e));this.dataWindow=null;const n=this.mediaRecorder||new MediaRecorder(s,{mimeType:this.options.mimeType||ln.find(a=>MediaRecorder.isTypeSupported(a)),audioBitsPerSecond:this.options.audioBitsPerSecond});this.mediaRecorder=n,this.stopRecording();const o=[];n.ondataavailable=a=>{a.data.size>0&&o.push(a.data),this.emit("record-data-available",a.data)};const l=a=>{var d;const u=new Blob(o,{type:n.mimeType});this.emit(a,u),this.options.renderRecordedAudio&&(this.applyOriginalOptionsIfNeeded(),(d=this.wavesurfer)===null||d===void 0||d.load(URL.createObjectURL(u)))};n.onpause=()=>l("record-pause"),n.onstop=()=>l("record-end"),n.start(this.options.mediaRecorderTimeslice),this.lastStartTime=performance.now(),this.lastDuration=0,this.duration=0,this.isWaveformPaused=!1,this.timer.start(),this.emit("record-start")})}getDuration(){return this.duration}isRecording(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="recording"}isPaused(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="paused"}isActive(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)!=="inactive"}stopRecording(){var e;this.isActive()&&((e=this.mediaRecorder)===null||e===void 0||e.stop(),this.timer.stop())}pauseRecording(){var e,s;this.isRecording()&&(this.isWaveformPaused=!0,(e=this.mediaRecorder)===null||e===void 0||e.requestData(),(s=this.mediaRecorder)===null||s===void 0||s.pause(),this.timer.stop(),this.lastDuration=this.duration)}resumeRecording(){var e;this.isPaused()&&(this.isWaveformPaused=!1,(e=this.mediaRecorder)===null||e===void 0||e.resume(),this.timer.start(),this.lastStartTime=performance.now(),this.emit("record-resume"))}static getAvailableAudioDevices(){return ke(this,void 0,void 0,function*(){return navigator.mediaDevices.enumerateDevices().then(e=>e.filter(s=>s.kind==="audioinput"))})}destroy(){this.applyOriginalOptionsIfNeeded(),super.destroy(),this.stopRecording(),this.stopMic()}applyOriginalOptionsIfNeeded(){this.wavesurfer&&this.originalOptions&&(this.wavesurfer.setOptions(this.originalOptions),delete this.originalOptions)}}let he,K,dn=!1;function un(){const r=()=>{he&&he.destroy(),he=ne.create({container:"#mic"}),K=he.registerPlugin(me.create({scrollingWaveform:dn,renderRecordedAudio:!1})),K.on("record-end",s=>{const n=U();n.file=URL.createObjectURL(s),ne.create({container:"#voiceMessageContainer",waveColor:"rgba(0, 0, 0, 0.6)",progressColor:"rgba(255, 255, 255)",cursorWidth:0,barWidth:4,barAlign:"bottom",height:20,interact:!0,dragToSeek:!0,normalize:!0,url:n.file})})};me.getAvailableAudioDevices().then(s=>{s.forEach(n=>{const o=document.createElement("option");o.value=n.deviceId,o.text=n.label||n.deviceId})});const e=()=>{if(K&&(K.isRecording()||K.isPaused())){K.stopRecording();return}K&&K.startRecording({deviceId:null}).then(()=>!1)};return ie(()=>{r()}),{recButton:e,createWaveSurfer:r}}const qe=r=>(st("data-v-559db129"),r=r(),nt(),r),hn=qe(()=>i("div",{class:"absolute",id:"mic"},null,-1)),cn=qe(()=>i("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M12 4.5C10.314 4.5 9 5.80455 9 7.35V12.15C9 13.6955 10.314 15 12 15C13.686 15 15 13.6955 15 12.15L15 7.35C15 5.80455 13.686 4.5 12 4.5ZM7.5 7.35C7.5 4.919 9.54387 3 12 3C14.4561 3 16.5 4.919 16.5 7.35L16.5 12.15C16.5 14.581 14.4561 16.5 12 16.5C9.54387 16.5 7.5 14.581 7.5 12.15V7.35ZM6.75 12.75C6.75 15.1443 9.0033 17.25 12 17.25C14.9967 17.25 17.25 15.1443 17.25 12.75H18.75C18.75 15.9176 16.0499 18.3847 12.75 18.7129V21H11.25V18.7129C7.95007 18.3847 5.25 15.9176 5.25 12.75H6.75Z"},null,-1)),pn=[cn],gn={ref:"audioPlayer"},mn=500,fn=j({__name:"ChatVoiceContent",setup(r){const e=U(),s=R(!1),n=un(),o=()=>{e.voiceTimer=0,e.clickerTimeout=null,l()},l=()=>{e.clickerTimeout=setTimeout(()=>{e.recordingVoice=!0,e.voiceTimer++,l()},200)},a=()=>{n.createWaveSurfer(),n.recButton(),Be(e.recordingVoice=!1,e.clickerTimeout),s.value=e.voiceTimer>=mn/1e3,s.value||(setTimeout(()=>{e.showVoiceInfo=!0},0),setTimeout(()=>{e.showVoiceInfo=!1},3e3))};return(d,u)=>(h(),g("div",null,[hn,i("div",{class:Z(["absolute right-6 bottom-3 transition-all",{"rounded-full pt-1 px-1 bg-blueSemiLight":t(e).recordingVoice}])},[i("button",{onMousedown:o,onMouseup:a},[(h(),g("svg",{class:Z(["fill-gray-500 dark:hover:fill-gray-300 hover:fill-gray-700 transition-all",{"fill-white hover:!fill-white":t(e).recordingVoice}]),width:"35px",height:"35px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},pn,2))],32),i("audio",gn,null,512)],2)]))}}),vn=we(fn,[["__scopeId","data-v-559db129"]]),wn={class:"flex flex-col h-full w-full"},Cn={key:0,class:"dark:bg-gray-700 flex justify-between items-center bg-gray-200 border-l border-black dark:border-opacity-20 border-opacity-10 w-full h-[50px] max-sm:h-[70px]"},yn={class:"flex items-center"},xn={class:"ml-2"},kn={key:0,class:"fill-semiCyan",width:"25px",height:"25px",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},bn=i("path",{d:"M13.8 2.2a2.51 2.51 0 0 0-3.54 0l-6.9 6.91-1.76 3.62a1.26 1.26 0 0 0 1.12 1.8 1.23 1.23 0 0 0 .55-.13l3.62-1.76 6-6 .83-.82.06-.06a2.52 2.52 0 0 0 .02-3.56zm-.89.89a1.25 1.25 0 0 1 0 1.77l-1.77-1.77a1.24 1.24 0 0 1 .86-.37 1.22 1.22 0 0 1 .91.37zM2.73 13.27 4.29 10 6 11.71zm4.16-2.4L5.13 9.11 10.26 4 12 5.74z"},null,-1),_n=[bn],$n=i("path",{d:"M18.48 18.5368H21M4.68 12L3 12.044M4.68 12C4.68 13.3255 5.75451 14.4 7.08 14.4C8.40548 14.4 9.48 13.3255 9.48 12C9.48 10.6745 8.40548 9.6 7.08 9.6C5.75451 9.6 4.68 10.6745 4.68 12ZM10.169 12.0441H21M12.801 5.55124L3 5.55124M21 5.55124H18.48M3 18.5368H12.801M17.88 18.6C17.88 19.9255 16.8055 21 15.48 21C14.1545 21 13.08 19.9255 13.08 18.6C13.08 17.2745 14.1545 16.2 15.48 16.2C16.8055 16.2 17.88 17.2745 17.88 18.6ZM17.88 5.4C17.88 6.72548 16.8055 7.8 15.48 7.8C14.1545 7.8 13.08 6.72548 13.08 5.4C13.08 4.07452 14.1545 3 15.48 3C16.8055 3 17.88 4.07452 17.88 5.4Z","stroke-width":"1.5","stroke-linecap":"round"},null,-1),Mn=[$n],Sn={key:2,width:"25px",height:"25px",viewBox:"-0.5 0 28 28",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ln=i("g",{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[i("g",{class:"fill-semiCyan",id:"Icon-Set-Filled",transform:"translate(-102.000000, -1195.000000)"},[i("path",{d:"M113.983,1202.01 L113.983,1196.11 C114.017,1195.81 113.936,1195.51 113.708,1195.28 C113.312,1194.89 112.67,1194.89 112.274,1195.28 L102.285,1206.24 C102.074,1206.45 101.984,1206.72 101.998,1207 C101.984,1207.27 102.074,1207.55 102.285,1207.76 L112.219,1218.65 C112.59,1218.97 113.271,1219.15 113.708,1218.71 C113.935,1218.49 114.035,1218.29 114,1218 L114,1212 C120.6,1212 126.569,1216.75 127.754,1223.01 C128.552,1221.17 129,1219.15 129,1217.02 C129,1208.73 122.276,1202.01 113.983,1202.01",id:"reply"})])],-1),Wn=[Ln],Tn={class:"py-2 px-4 text-sm tracking-widest"},Pn={key:0},En={class:"text-semiCyan"},Dn={key:1},jn={class:"text-semiCyan"},Rn={key:2},Un={class:"text-semiCyan text-[12px]"},Vn={class:""},On={key:0},zn={key:0,class:"text-[12px] text-gray-400"},Bn={key:1},An=i("svg",{class:"fill-gray-500",width:"30px",height:"30px",viewBox:"0 -0.5 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M6.96967 16.4697C6.67678 16.7626 6.67678 17.2374 6.96967 17.5303C7.26256 17.8232 7.73744 17.8232 8.03033 17.5303L6.96967 16.4697ZM13.0303 12.5303C13.3232 12.2374 13.3232 11.7626 13.0303 11.4697C12.7374 11.1768 12.2626 11.1768 11.9697 11.4697L13.0303 12.5303ZM11.9697 11.4697C11.6768 11.7626 11.6768 12.2374 11.9697 12.5303C12.2626 12.8232 12.7374 12.8232 13.0303 12.5303L11.9697 11.4697ZM18.0303 7.53033C18.3232 7.23744 18.3232 6.76256 18.0303 6.46967C17.7374 6.17678 17.2626 6.17678 16.9697 6.46967L18.0303 7.53033ZM13.0303 11.4697C12.7374 11.1768 12.2626 11.1768 11.9697 11.4697C11.6768 11.7626 11.6768 12.2374 11.9697 12.5303L13.0303 11.4697ZM16.9697 17.5303C17.2626 17.8232 17.7374 17.8232 18.0303 17.5303C18.3232 17.2374 18.3232 16.7626 18.0303 16.4697L16.9697 17.5303ZM11.9697 12.5303C12.2626 12.8232 12.7374 12.8232 13.0303 12.5303C13.3232 12.2374 13.3232 11.7626 13.0303 11.4697L11.9697 12.5303ZM8.03033 6.46967C7.73744 6.17678 7.26256 6.17678 6.96967 6.46967C6.67678 6.76256 6.67678 7.23744 6.96967 7.53033L8.03033 6.46967ZM8.03033 17.5303L13.0303 12.5303L11.9697 11.4697L6.96967 16.4697L8.03033 17.5303ZM13.0303 12.5303L18.0303 7.53033L16.9697 6.46967L11.9697 11.4697L13.0303 12.5303ZM11.9697 12.5303L16.9697 17.5303L18.0303 16.4697L13.0303 11.4697L11.9697 12.5303ZM13.0303 11.4697L8.03033 6.46967L6.96967 7.53033L11.9697 12.5303L13.0303 11.4697Z"})],-1),Hn=[An],In={class:"border rounded-full m-3 overflow-hidden"},Nn=i("img",{src:Ct,alt:"send-message"},null,-1),Zn=[Nn],Fn=i("div",null,[i("svg",{class:"fill-semiCyan",width:"40px",height:"40px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.4933 6.93502C15.8053 7.20743 15.8374 7.68122 15.565 7.99325L7.70786 16.9933C7.56543 17.1564 7.35943 17.25 7.14287 17.25C6.9263 17.25 6.72031 17.1564 6.57788 16.9933L3.43502 13.3933C3.16261 13.0812 3.19473 12.6074 3.50677 12.335C3.8188 12.0626 4.29259 12.0947 4.565 12.4068L7.14287 15.3596L14.435 7.00677C14.7074 6.69473 15.1812 6.66261 15.4933 6.93502Z"})])],-1),Xn=[Fn],qn={class:"my-2"},Gn={class:"px-4 py-2 !font-light"},Yn={class:"flex justify-end"},Kn=j({__name:"ChatContent",props:{messageId:{type:Number,default:null},showArrowBtn:{type:Boolean,default:!1},showForwardedSetting:{type:Boolean,default:!1},check:{type:Boolean,default:!0}},setup(r){ee();const e=U();R(null);const s=a=>{a.key==="Enter"&&(a.shiftKey?(e.messageText+=`
`,a.preventDefault()):o())},n=a=>{a.key==="Enter"&&(a.shiftKey?(e.messageUpdate.updateText+=`
`,a.preventDefault()):l())},o=()=>{var a,d;((a=e.messageText)==null?void 0:a.length)>0&&((d=e.messageText)==null?void 0:d.trim())!==""||e.messageForwarded.id?(e.createMessage({id:e.get_user_chat.id,text:e.messageText,message_id:e.messageForwarded.id}),e.messageText=""):(e.messageForwarded={},e.messageText="")},l=()=>{var a;((a=e.messageUpdate.updateText)==null?void 0:a.length)>0&&e.messageUpdate.id?e.updateMessage({id:e.messageUpdate.id,text:e.messageUpdate.updateText}).then(d=>{e.messageUpdate={}}):e.messageUpdate={}};return(a,d)=>(h(),g("div",{class:"w-full relative h-[92%]",onMouseup:d[11]||(d[11]=V(u=>t(Be)(t(e).recordingVoice=!1,t(e).clickerTimeout),["stop"]))},[t(e).userChat.id?(h(),g("div",{key:1,class:Z(["flex relative h-full flex-col",{"z-20":t(e).showDragInfo}])},[k(Zs),k(Ls),i("form",{class:"flex mt-auto relative",onSubmit:d[6]||(d[6]=V(()=>{},["prevent"]))},[i("div",wn,[k(B,{name:"slide-up"},{default:w(()=>{var u,c,p,v,m,C;return[t(e).messageUpdate.id||t(e).messageForwarded.id||t(e).messageReplied.id?(h(),g("div",Cn,[i("div",yn,[i("div",xn,[t(e).messageUpdate.id?(h(),g("svg",kn,_n)):_("",!0),t(e).messageForwarded.id?(h(),g("svg",{key:1,onClick:d[0]||(d[0]=b=>r.showForwardedSetting=!0),class:"stroke-semiCyan",width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Mn)):_("",!0),t(e).messageReplied.id?(h(),g("svg",Sn,Wn)):_("",!0)]),i("div",Tn,[t(e).messageUpdate.id?(h(),g("div",Pn,[i("p",En,f(a.$t("Редактирование")),1)])):_("",!0),t(e).messageForwarded.id?(h(),g("div",Dn,[i("p",jn,f(t(e).checkboxForwarded?t(e).messageForwarded.sender.first_name+" "+t(e).messageForwarded.sender.last_name:a.$t("Имя отправителя скрыто")),1)])):_("",!0),t(e).messageReplied.id?(h(),g("div",Rn,[i("p",Un,f(a.$t("В ответ")+" "+t(e).messageReplied.sender.first_name+" "+t(e).messageReplied.sender.last_name),1),i("p",Vn,f(t(e).messageReplied.text.length>20?t(e).messageReplied.text.slice(0,20)+"...":t(e).messageReplied.text),1)])):_("",!0),i("div",null,[t(e).messageUpdate.id?(h(),g("p",On,[t(e).messageUpdate.file_name?(h(),g("span",zn,f(t(e).messageUpdate.file_name.slice(0,20)+"..."+t(e).messageUpdate.file_name.substr(-6)+","),1)):_("",!0),$(" "+f(((u=t(e).messageUpdate.text)==null?void 0:u.length)>50?((c=t(e).messageUpdate)==null?void 0:c.text.slice(0,50))+"...":(p=t(e).messageUpdate)==null?void 0:p.text),1)])):(h(),g("p",Bn,f(((v=t(e).messageForwarded.text)==null?void 0:v.length)>50?((m=t(e).messageForwarded)==null?void 0:m.text.slice(0,50))+"...":(C=t(e).messageForwarded)==null?void 0:C.text),1))])])]),i("div",{class:"mr-4 cursor-pointer",onClick:d[1]||(d[1]=b=>{t(e).messageUpdate={},t(e).messageForwarded={},t(e).messageReplied={}})},Hn)])):_("",!0)]}),_:1}),i("div",In,[t(e).messageUpdate.id?(h(),P(Ue,{key:0,modelValue:t(e).messageUpdate.updateText,"onUpdate:modelValue":d[2]||(d[2]=u=>t(e).messageUpdate.updateText=u),onKeydown:n,class:Z(["h-[50px] -mb-2 pr-24 pl-5",{"!pl-12":t(e).messageUpdate.id}]),placeholder:"Написать сообщение..."},null,8,["modelValue","class"])):t(e).messageUpdate.id?_("",!0):(h(),P(Ue,{key:1,modelValue:t(e).messageText,"onUpdate:modelValue":d[3]||(d[3]=u=>t(e).messageText=u),onKeydown:s,class:"h-[50px] -mb-2 pr-24 pl-5",placeholder:"Написать сообщение..."},null,8,["modelValue"])),!t(e).messageUpdate.id||!t(e).messageForwarded.id?(h(),P(Qs,{key:2})):_("",!0),k(B,{name:"fade"},{default:w(()=>{var u,c,p,v;return[((u=t(e).messageText)==null?void 0:u.length)>0&&((c=t(e).messageText)==null?void 0:c.trim())!==""||t(e).messageForwarded.id?(h(),g("button",{key:0,onClick:d[4]||(d[4]=m=>{var C;return((C=t(e).messageText)==null?void 0:C.length)>0||t(e).messageForwarded.id?t(e).createMessage({id:t(e).get_user_chat.id,text:t(e).messageText,message_id:t(e).messageForwarded.id}).then(b=>{t(e).messageText=""}):t(e).messageText}),class:"absolute right-6 bottom-4"},Zn)):((p=t(e).messageUpdate.updateText)==null?void 0:p.length)>0&&((v=t(e).messageUpdate.updateText)==null?void 0:v.trim())!==""||t(e).messageUpdate.file?(h(),g("button",{key:1,onClick:d[5]||(d[5]=m=>t(e).updateMessage({id:t(e).messageUpdate.id,text:t(e).messageUpdate.updateText}).then(C=>{t(e).messageUpdate={}})),class:"absolute right-2 bottom-4"},Xn)):(h(),P(vn,{key:2}))]}),_:1})])])],32),k(Fs,{onDragleave:d[7]||(d[7]=V(u=>t(e).showDragInfo=!1,["stop"]))})],2)):(h(),P(vt,{key:0})),r.showForwardedSetting?(h(),P(X,{key:2,type:"resizeInfoWindow",class:"p-4",onShowModal:d[10]||(d[10]=u=>r.showForwardedSetting=!1)},{default:w(()=>[i("div",qn,[k(Ae,null,{default:w(()=>[$(f(a.$t("Переслать сообщение")),1)]),_:1}),i("div",Gn,[i("div",null,[i("p",null,f(a.$t("Вы можете убрать имя отправителя. В этом случае сообщение будет выглядеть как Ваше.")),1),i("div",null,[k(wt,{t:"checkboxChat",checked:r.check},null,8,["checked"])]),i("button",{class:"text-sm font-light text-semiCyan hover:underline tracking-wider",onClick:d[8]||(d[8]=u=>{r.showForwardedSetting=!1,t(e).showSendWindow=!0})},f(a.$t("Изменить получателя")),1)]),i("div",Yn,[k(O,{type:"chat",onClick:d[9]||(d[9]=u=>{r.showForwardedSetting=!1})},{default:w(()=>[$(f(a.$t("Готово")),1)]),_:1})])])])]),_:1})):_("",!0)],32))}}),Jn={class:""},Qn=i("svg",{class:"stroke-black dark:stroke-white",width:"22px",height:"22px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{"data-v-a06cf116":"",d:"M21.2799 6.40005L11.7399 15.94C10.7899 16.89 7.96987 17.33 7.33987 16.7C6.70987 16.07 7.13987 13.25 8.08987 12.3L17.6399 2.75002C17.8754 2.49308 18.1605 2.28654 18.4781 2.14284C18.7956 1.99914 19.139 1.92124 19.4875 1.9139C19.8359 1.90657 20.1823 1.96991 20.5056 2.10012C20.8289 2.23033 21.1225 2.42473 21.3686 2.67153C21.6147 2.91833 21.8083 3.21243 21.9376 3.53609C22.0669 3.85976 22.1294 4.20626 22.1211 4.55471C22.1128 4.90316 22.0339 5.24635 21.8894 5.5635C21.7448 5.88065 21.5375 6.16524 21.2799 6.40005V6.40005Z","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M11 4H6C4.93913 4 3.92178 4.42142 3.17163 5.17157C2.42149 5.92172 2 6.93913 2 8V18C2 19.0609 2.42149 20.0783 3.17163 20.8284C3.92178 21.5786 4.93913 22 6 22H17C19.21 22 20 20.2 20 18V13","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),ei=i("svg",{class:"dark:fill-white",xmlns:"http://www.w3.org/2000/svg",width:"22px",height:"22px",viewBox:"0 0 261.811 261.811","xml:space":"preserve"},[i("g",null,[i("g",null,[i("path",{d:`M24.715,261.811c-5.492,0-10.645-2.133-14.521-6.01c-8.011-8.017-8.011-21.054-0.006-29.064\r
                      l70.375-70.372L38.51,113.785c-7.073-7.179-7.928-18.303-2.039-26.466c0.855-1.184,21.314-28.839,58.964-28.839\r
                      c2.224,0,4.492,0.101,6.756,0.295L180.62,3.597c8.103-5.729,20.081-4.48,26.863,2.796l44.675,48.037\r
                      c6.919,7.436,7.319,19.006,0.926,26.906l-55.882,69.151c1.979,23.759,1.052,63.069-23.901,77.725\r
                      c-7.959,4.666-18.578,3.26-25.021-3.282l-38.837-39.316l-70.206,70.183C35.365,259.678,30.208,261.811,24.715,261.811z\r
                       M95.43,70.194c-31.735,0-48.763,23.009-49.472,23.987c-2.53,3.502-2.159,8.291,0.883,11.376l50.227,50.865l-78.6,78.594\r
                      c-3.442,3.448-3.442,9.058,0,12.505c3.319,3.328,9.157,3.328,12.482,0l78.531-78.52l47.122,47.7\r
                      c2.762,2.813,7.325,3.407,10.761,1.412c20.957-12.316,19.539-52.303,17.961-68.919l-0.229-2.373l58.878-72.854\r
                      c2.745-3.402,2.573-8.371-0.406-11.567l-44.663-48.031c-2.904-3.116-8.062-3.671-11.545-1.212l-82.042,57.726l-2.213-0.251\r
                      C100.536,70.34,97.952,70.194,95.43,70.194z`})])])],-1),ti=i("svg",{class:"dark:fill-white fill-black",width:"22px",height:"22px",viewBox:"0 0 256 256",id:"Flat",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M50.96,37.30957A4,4,0,0,0,45.04,42.69043l38.59424,42.4541c-11.416-2.39062-31.02295-2.76172-51.54444,13.79248a12.01279,12.01279,0,0,0-.96484,17.84424L82.34326,168,45.17188,205.17139a3.99992,3.99992,0,1,0,5.65625,5.65722L88,173.65674l51.02051,51.021a12.00814,12.00814,0,0,0,8.49219,3.51954q.42041,0,.84277-.02979a11.97039,11.97039,0,0,0,8.73047-4.74512c6.33252-8.4165,15.40625-23.479,15.38379-40.55859L205.04,218.69043a4,4,0,1,0,5.91992-5.38086Zm99.7334,181.30322a3.99357,3.99357,0,0,1-6.01563.40821L36.78125,111.124a4.01376,4.01376,0,0,1,.332-5.96045c27.17188-21.91943,52.06543-10.09375,53.09766-9.58593a3.99477,3.99477,0,0,0,3.08984.20019l69.71729,76.689C168.36816,191.2041,157.64355,209.374,150.69336,218.61279ZM232.68652,96a11.92292,11.92292,0,0,1-3.51562,8.48584l-41.4043,41.40381a3.99975,3.99975,0,1,1-5.65625-5.65674l41.4043-41.4043a3.99915,3.99915,0,0,0,0-5.65674L162.8291,32.48535a4.00621,4.00621,0,0,0-5.6582.00049l-37.97559,37.9751a3.99957,3.99957,0,1,1-5.65625-5.65625l37.97559-37.97608a12.01526,12.01526,0,0,1,16.9707-.00049L229.1709,87.51465A11.921,11.921,0,0,1,232.68652,96Z"})],-1),si=i("svg",{class:"dark:stroke-white stroke-black",width:"23px",height:"23px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{"data-v-a06cf116":"",d:"M10 12V17","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M14 12V17","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M4 7H20","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M6 10V18C6 19.6569 7.34315 21 9 21H15C16.6569 21 18 19.6569 18 18V10","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),ni={class:"p-2"},ii=["src"],oi=j({__name:"TheChatContentPinnedMessages",setup(r){const e=U(),s=J(),{x:n,y:o}=Le(),{y:l}=We(),a=R(!1),d=R({getBoundingClientRect:()=>({})}),u=R(null),c=R({scrollTop:"",scrollHeight:"",clientHeight:"",root:null});function p({target:{scrollTop:v,clientHeight:m,scrollHeight:C}}){u.value=v,v===0&&(page.value=Number(page.value)+1,e==null||e.loadUserChat({page:page.value,limit:100,id:route.params.id}))}return ie(()=>{setTimeout(()=>{const v=c.value;v.scrollTop=v.scrollHeight},500)}),ze(()=>{setTimeout(()=>{const v=c.value;v.scrollTop=v==null?void 0:v.scrollHeight},500)}),(v,m)=>{const C=Te,b=Ie;return h(),g("div",{class:"overflow-x-hidden gap-y-2 check overflow-y-auto",onScroll:p,ref_key:"pinned_block",ref:c,id:"pinned_block"},[k(C,{onContextmenu:m[0]||(m[0]=V(()=>{},["prevent"])),modelValue:t(a),"onUpdate:modelValue":m[1]||(m[1]=L=>Me(a)?a.value=L:null),"virtual-element":t(d)},{default:w(()=>[i("div",Jn,[k(F,null,{ContextMenuSvg:w(()=>[Qn]),ContextMenuText:w(()=>[$(f(v.$t("Изменить")),1)]),_:1}),k(F,null,{ContextMenuSvg:w(()=>[ei]),ContextMenuText:w(()=>[$(f(v.$t("Закрепить")),1)]),_:1}),k(F,null,{ContextMenuSvg:w(()=>[ti]),ContextMenuText:w(()=>[$(f(v.$t("Открепить")),1)]),_:1}),k(F,null,{ContextMenuSvg:w(()=>[si]),ContextMenuText:w(()=>[$(f(v.$t("Удалить")),1)]),_:1})])]),_:1},8,["modelValue","virtual-element"]),i("div",ni,[(h(!0),g(q,null,G(t(e).arrayPin,L=>(h(),P(b,{class:"dark:text-white text-black",item:L,onContextmenu:m[2]||(m[2]=V(()=>{const S=("unref"in v?v.unref:t(t))(t(o))-("unref"in v?v.unref:t(t))(t(l)),y=("unref"in v?v.unref:t(t))(t(n));t(d).getBoundingClientRect=()=>({width:0,height:0,top:S,left:y}),a.value=!0},["prevent"]))},{userImage:w(()=>{var S;return[i("img",{class:"w-[30px] h-[30px] rounded-full",src:L.sender.id===((S=t(s).user)==null?void 0:S.id)?t(s).get_server_domain+t(s).user.photo_url:t(s).get_server_domain+L.sender.photo,alt:""},null,8,ii)]}),userMessage:w(()=>[$(f(L.text),1)]),userDate:w(()=>[$(f(new Date(L.created_at).toLocaleTimeString().slice(0,5)),1)]),_:2},1032,["item"]))),256))])],544)}}}),ri={class:"w-full h-[60px] dark:bg-gray-700 bg-gray-200 border-t border-l border-black dark:border-opacity-20 border-opacity-10 z-10"},ai=i("div",null,[i("svg",{class:"dark:stroke-white stroke-black",width:"20px",height:"20px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M14.9998 19.9201L8.47984 13.4001C7.70984 12.6301 7.70984 11.3701 8.47984 10.6001L14.9998 4.08008","stroke-width":"1.5","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"})])],-1),li={class:"text-black dark:text-white tracking-wider"},di=j({__name:"TheChatContentPinnedHeader",setup(r){const e=U();return(s,n)=>(h(),g("div",ri,[i("div",{class:"p-4 flex items-center gap-x-3 cursor-pointer",onClick:n[0]||(n[0]=o=>t(e).showPinnedWindow=!1)},[ai,i("p",li,f(t(e).arrayPin.length+" "+s.$t("закреплённых сообщения")),1)])]))}}),ui={class:"flex mx-auto mt-4 uppercase text-[12px] tracking-widest text-blueSemiLight font-bold"},hi={class:"text-lg tracking-wider"},ci={class:"flex mt-4 gap-x-4 justify-center"},pi=j({__name:"TheChatContentPinnedFooter",props:{showWarnPinned:{type:Boolean,default:!1}},setup(r){const e=U();return(s,n)=>t(e).showPinnedWindow?(h(),g("div",{key:0,onClick:n[3]||(n[3]=o=>r.showWarnPinned=!0),class:"w-full h-[50px] dark:bg-gray-700 bg-gray-200 border-t border-l border-black dark:border-opacity-20 border-opacity-10 z-10 hover:dark:bg-gray-600 cursor-pointer hover:bg-gray-100"},[i("button",ui,f(s.$t("Открепить")+" "+t(e).arrayPin.length+" "+s.$t("сообщения")),1),r.showWarnPinned?(h(),P(X,{key:0,type:"resize",onShowModal:n[2]||(n[2]=o=>r.showWarnPinned=!1)},{default:w(()=>[i("div",null,[i("p",hi,f(s.$t("Открепить все сообщения?")),1)]),i("div",ci,[k(O,{type:"chat",onClick:n[0]||(n[0]=o=>r.showWarnPinned=!1)},{default:w(()=>[$(f(s.$t("Отмена")),1)]),_:1}),k(O,{type:"chat",onClick:n[1]||(n[1]=o=>{t(e).makePinned({messages:t(e).arrayPin.filter(l=>l.id).map(l=>l.id)}).then(l=>t(Q).info("Сообщения откреплены",{autoClose:1500,theme:"auto"})),r.showWarnPinned=!1,t(e).showPinnedWindow=!1})},{default:w(()=>[$(f(s.$t("Открепить")),1)]),_:1})])]),_:1})):_("",!0)])):_("",!0)}}),gi={class:"flex flex-col h-full"},mi=j({__name:"ChatContentUserPinned",setup(r){const e=U();return(s,n)=>(h(),g("div",{class:Z(["absolute z-[11] top-0 dark:bg-[#1F2937] bg-gray-300 right-0 h-full text-white transition-all duration-200",{"w-full":t(e).showPinnedWindow,"w-0":!t(e).showPinnedWindow}])},[i("div",gi,[k(di),k(oi,{class:"h-full"}),k(pi)])],2))}}),fi={},vi={class:"text-sm flex items-center gap-x-4 dark:hover:bg-gray-500 hover:bg-gray-300 px-3 py-1 cursor-pointer"};function wi(r,e){return h(),g("div",null,[i("div",vi,[i("div",null,[I(r.$slots,"chatWindowSettingContentSvg")]),i("p",null,[I(r.$slots,"chatWindowSettingContentText")])])])}const be=we(fi,[["render",wi]]),Ci={class:"p-4 flex justify-between tracking-wider items-center relative"},yi={class:"tracking-widest"},xi={class:"flex gap-x-4 items-center"},ki=i("svg",{class:"dark:stroke-white stroke-black",width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M12 12H12.01M12 6H12.01M12 18H12.01M13 12C13 12.5523 12.5523 13 12 13C11.4477 13 11 12.5523 11 12C11 11.4477 11.4477 11 12 11C12.5523 11 13 11.4477 13 12ZM13 18C13 18.5523 12.5523 19 12 19C11.4477 19 11 18.5523 11 18C11 17.4477 11.4477 17 12 17C12.5523 17 13 17.4477 13 18ZM13 6C13 6.55228 12.5523 7 12 7C11.4477 7 11 6.55228 11 6C11 5.44772 11.4477 5 12 5C12.5523 5 13 5.44772 13 6Z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),bi=[ki],_i={key:0,class:"absolute top-10 right-16 py-1 dark:bg-gray-800 bg-gray-200 flex flex-col gap-y-2"},$i=i("svg",{class:"stroke-black dark:stroke-white",width:"20px",height:"20px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[i("title",null,"i"),i("g",{id:"Complete"},[i("g",{id:"user-add"},[i("g",null,[i("path",{d:"M17,21V19a4,4,0,0,0-4-4H5a4,4,0,0,0-4,4v2",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}),i("circle",{cx:"9",cy:"7",r:"4",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}),i("line",{x1:"17",y1:"11",x2:"23",y2:"11",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}),i("line",{x1:"20",y1:"8",x2:"20",y2:"14",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"})])])])],-1),Mi=i("svg",{class:"stroke-black dark:stroke-white",width:"20px",height:"20px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M18.48 18.5368H21M4.68 12L3 12.044M4.68 12C4.68 13.3255 5.75451 14.4 7.08 14.4C8.40548 14.4 9.48 13.3255 9.48 12C9.48 10.6745 8.40548 9.6 7.08 9.6C5.75451 9.6 4.68 10.6745 4.68 12ZM10.169 12.0441H21M12.801 5.55124L3 5.55124M21 5.55124H18.48M3 18.5368H12.801M17.88 18.6C17.88 19.9255 16.8055 21 15.48 21C14.1545 21 13.08 19.9255 13.08 18.6C13.08 17.2745 14.1545 16.2 15.48 16.2C16.8055 16.2 17.88 17.2745 17.88 18.6ZM17.88 5.4C17.88 6.72548 16.8055 7.8 15.48 7.8C14.1545 7.8 13.08 6.72548 13.08 5.4C13.08 4.07452 14.1545 3 15.48 3C16.8055 3 17.88 4.07452 17.88 5.4Z","stroke-width":"1.5","stroke-linecap":"round"})],-1),Si=i("svg",{class:"stroke-red-400",width:"20px",height:"20px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M10 12V17","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{d:"M14 12V17","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{d:"M4 7H20","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{d:"M6 10V18C6 19.6569 7.34315 21 9 21H15C16.6569 21 18 19.6569 18 18V10","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{d:"M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Li=i("svg",{class:"dark:stroke-white stroke-black",width:"20px",height:"20px",viewBox:"-0.5 0 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M3 21.32L21 3.32001","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{d:"M3 3.32001L21 21.32","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Wi=[Li],Ti=j({__name:"ChatWindowSettingContentHeader",props:{showGroupAdd:{type:Boolean,default:!1}},setup(r){J();const e=ee(),s=ve(),n=U();return(o,l)=>(h(),g("div",Ci,[i("p",yi,f(o.$t("Информация о группе")),1),i("div",xi,[i("div",{class:Z(["p-1 rounded-full transition-all duration-200 cursor-pointer dark:hover:bg-gray-500 hover:bg-gray-200",{"dark:bg-gray-500 bg-gray-200":t(n).showSettingChat}]),onClick:l[0]||(l[0]=V(a=>t(n).showSettingChat=!t(n).showSettingChat,["stop"]))},bi,2),k(B,{name:"slide-down",onClick:l[4]||(l[4]=V(()=>{},["stop"]))},{default:w(()=>[t(n).showSettingChat?(h(),g("div",_i,[k(be,{onClick:l[1]||(l[1]=a=>{o.$emit("showGroupAdd"),t(n).showSettingChat=!1})},{chatWindowSettingContentSvg:w(()=>[$i]),chatWindowSettingContentText:w(()=>[$(f(o.$t("Добавить участников")),1)]),_:1}),k(be,{onClick:l[2]||(l[2]=a=>{t(n).showChatChangeInfo=!0,t(n).showSettingChat=!1,t(n).updateChatName=t(n).userChat.name})},{chatWindowSettingContentSvg:w(()=>[Mi]),chatWindowSettingContentText:w(()=>[$(f(o.$t("Управление группой")),1)]),_:1}),k(be,{class:"text-red-400",onClick:l[3]||(l[3]=a=>{t(n).chatDelete({id:t(e).params.id}).then(d=>{t(n).showSettingChat=!1,r.showGroupAdd=!1,t(n).showChatInfo=!1,t(s).push("/base/chat").then(u=>{t(Q).success("Чат успешно удалён",{theme:"auto",autoClose:1e3})})})})},{chatWindowSettingContentSvg:w(()=>[Si]),chatWindowSettingContentText:w(()=>[$(f(o.$t("Удалить группу")),1)]),_:1})])):_("",!0)]),_:1}),i("div",{class:"cursor-pointer p-1.5 rounded-full transition-all duration-200",onClick:l[5]||(l[5]=a=>t(n).showChatInfo=!1)},Wi)])]))}}),Pi={class:"p-4"},Ei={class:"flex items-center tracking-wider gap-x-4"},Di=["src"],ji={key:1},Ri={class:"w-[80px] flex justify-center items-center text-xl h-[80px] rounded-full bg-blueSemiLight"},Ui=["onClick"],Vi={class:"text-lg tracking-widest"},Oi={class:"text-sm text-gray-400"},zi=j({__name:"ChatWindowSettingContentMain",setup(r){const e=U(),s=J();return(n,o)=>{var l,a,d,u;return h(),g("div",Pi,[i("div",Ei,[i("div",null,[(l=t(e).get_user_chat.user)!=null&&l.id||t(e).get_user_chat.photo_url?(h(),g("img",{key:0,class:"w-[80px] h-[80px] rounded-full",src:t(e).get_user_chat.is_group?t(s).get_server_domain+((d=t(e).get_user_chat)==null?void 0:d.photo_url):t(s).get_server_domain+((a=t(e).get_user_chat.user)==null?void 0:a.photo),alt:""},null,8,Di)):(h(),g("div",ji,[i("div",Ri,[(h(!0),g(q,null,G(t(e).get_user_chat.name.split(" ").slice(0,2),c=>(h(),g("p",{class:"uppercase",onClick:p=>console.log(c[0])},f(c[0]),9,Ui))),256))])]))]),i("div",null,[i("p",Vi,f(t(e).get_user_chat.name),1),i("p",Oi,f(((u=t(e).get_user_chat.users)==null?void 0:u.length)+" "+n.$t("участников")),1)])])])}}}),Bi={class:"border-t cursor-pointer dark:hover:bg-gray-600 hover:bg-gray-300 transition-all duration-200 flex gap-x-2 border-black border-opacity-20 px-4 py-3"},Ai=Oe(`<div><svg class="fill-gray-600 dark:fill-gray-300" height="20px" width="20px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 459.863 459.863" xml:space="preserve"><g><g><g><path d="M395.988,193.977c-18.629,24.992-45.641,41.956-77.406,44.25c26.626,31.04,43.84,70.378,47.152,113.55\r
                c1.243,16.197,0.369,24.083-0.932,30.599c16.064-2.497,30.815-6.128,43.488-10.794c42.626-15.694,51.573-38.891,51.573-55.586\r
                C459.863,265.521,434.565,220.849,395.988,193.977z"></path><path d="M276.72,199.407c10.642,5.952,22.36,9.093,34.525,9.093c45.83,0,81.115-44.3,81.115-96.677\r
                c0-52.382-35.29-96.677-81.115-96.677c-18.734,0-36.411,7.436-50.724,21.145c20.03,25.65,31.446,59.072,31.446,94.667\r
                C291.967,154.544,286.961,178.037,276.72,199.407z"></path><path d="M259.999,226.279c-24.558,31.058-57.739,46.482-91.839,46.482c-36.232,0-68.69-17.206-91.839-46.482\r
                C30.403,256.333,0,308.217,0,367.076c0,18.127,9.926,43.389,57.213,60.8c29.496,10.861,68.898,16.841,110.947,16.841\r
                c42.049,0,81.451-5.98,110.947-16.841c47.287-17.411,57.213-42.673,57.213-60.8C336.32,308.217,305.918,256.333,259.999,226.279z\r
                "></path><path d="M168.16,242.763c53.003,0,93.806-51.234,93.806-111.804c0-60.571-40.808-111.804-93.806-111.804\r
                c-52.995,0-93.806,51.223-93.806,111.804C74.354,191.541,115.169,242.763,168.16,242.763z"></path></g></g></g></svg></div>`,1),Hi={class:"uppercase text-[12px] tracking-wider ml-4"},Ii={class:"dark:bg-gray-800 bg-gray-200 flex flex-col gap-y-3 py-4 h-[300px] overflow-y-auto"},Ni=["onContextmenu"],Zi=["src"],Fi={key:1,class:"rounded-full bg-blueSemiLight flex items-center justify-center w-[45px] h-[45px]"},Xi=i("svg",{class:"stroke-white",width:"30px",height:"30px",viewBox:"0 -0.5 25 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18.507 19.853V6.034C18.5116 5.49905 18.3034 4.98422 17.9283 4.60277C17.5532 4.22131 17.042 4.00449 16.507 4H8.50705C7.9721 4.00449 7.46085 4.22131 7.08577 4.60277C6.7107 4.98422 6.50252 5.49905 6.50705 6.034V19.853C6.45951 20.252 6.65541 20.6407 7.00441 20.8399C7.35342 21.039 7.78773 21.0099 8.10705 20.766L11.907 17.485C12.2496 17.1758 12.7705 17.1758 13.113 17.485L16.9071 20.767C17.2265 21.0111 17.6611 21.0402 18.0102 20.8407C18.3593 20.6413 18.5551 20.2522 18.507 19.853Z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),qi=[Xi],Gi={class:"w-9/12 break-words"},Yi={class:"text-[12px] tracking-widest"},Ki=i("svg",{class:"dark:stroke-white stroke-black",width:"23px",height:"23px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{"data-v-a06cf116":"",d:"M10 12V17","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M14 12V17","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M4 7H20","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M6 10V18C6 19.6569 7.34315 21 9 21H15C16.6569 21 18 19.6569 18 18V10","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{"data-v-a06cf116":"",d:"M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Ji=j({__name:"ChatWindowSettingContentUserList",setup(r){ve();const{x:e,y:s}=Le(),{y:n}=We(),o=R(!1),l=R(),a=R({getBoundingClientRect:()=>({})}),d=U(),u=J();return(c,p)=>{const v=Te;return h(),g("div",null,[i("div",Bi,[Ai,i("p",Hi,[$(f(t(d).get_user_chat.users.length+" "),1),i("span",null,f(c.$t("участников")),1)])]),i("div",Ii,[(h(!0),g(q,null,G(t(d).get_user_chat.users,m=>(h(),g("div",{onContextmenu:V(()=>{const C=("unref"in c?c.unref:t(t))(t(s))-("unref"in c?c.unref:t(t))(t(n)),b=("unref"in c?c.unref:t(t))(t(e));t(a).getBoundingClientRect=()=>({width:0,height:0,top:C,left:b}),o.value=!0,l.value={...m}},["prevent"]),class:"flex bg-transparent border-none gap-x-4 items-center w-full dark:hover:bg-gray-600 hover:bg-gray-300 cursor-pointer transition-all px-5"},[i("div",null,[m!=null&&m.id||m.is_group?(h(),g("img",{key:0,class:"w-[45px] h-[45px] rounded-full",src:t(u).get_server_domain+(m==null?void 0:m.photo),alt:""},null,8,Zi)):(h(),g("div",Fi,qi))]),i("div",Gi,[i("p",Yi,f(m!=null&&m.id&&!m.is_group?(m==null?void 0:m.first_name)+" "+(m==null?void 0:m.last_name):m.name),1)])],40,Ni))),256)),k(v,{onContextmenu:p[0]||(p[0]=V(()=>{},["prevent"])),modelValue:t(o),"onUpdate:modelValue":p[1]||(p[1]=m=>Me(o)?o.value=m:null),"virtual-element":t(a)},{default:w(()=>[k(F,{onClick:t(d)},{ContextMenuSvg:w(()=>[Ki]),ContextMenuText:w(()=>[$(f(c.$t("Удалить")),1)]),_:1},8,["onClick"])]),_:1},8,["modelValue","virtual-element"])])])}}}),Qi={key:0,for:"updateImage",class:"bg-black mx-auto flex justify-center items-center w-full h-full absolute z-20 rounded-full bg-opacity-40 cursor-pointer"},eo=i("div",null,[i("svg",{width:"30px",height:"30px",viewBox:"0 -2 32 32",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},[i("g",{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[i("g",{class:"fill-white",id:"Icon-Set-Filled",transform:"translate(-258.000000, -467.000000)"},[i("path",{d:"M286,471 L283,471 L282,469 C281.411,467.837 281.104,467 280,467 L268,467 C266.896,467 266.53,467.954 266,469 L265,471 L262,471 C259.791,471 258,472.791 258,475 L258,491 C258,493.209 259.791,495 262,495 L286,495 C288.209,495 290,493.209 290,491 L290,475 C290,472.791 288.209,471 286,471 Z M274,491 C269.582,491 266,487.418 266,483 C266,478.582 269.582,475 274,475 C278.418,475 282,478.582 282,483 C282,487.418 278.418,491 274,491 Z M274,477 C270.687,477 268,479.687 268,483 C268,486.313 270.687,489 274,489 C277.313,489 280,486.313 280,483 C280,479.687 277.313,477 274,477 L274,477 Z",id:"camera"})])])])],-1),Ge=j({__name:"ChatCropperFileInput",setup(r){const e=U();return(s,n)=>t(e).showImageChange?(h(),g("label",Qi,[eo,i("input",{id:"updateImage",onChange:n[0]||(n[0]=o=>{t(pt)(o.target.files[0],t(e)),t(e).showChatCropper=!0}),onInput:n[1]||(n[1]=o=>s.$emit("update:modelValue",o.target.value)),class:"hidden",type:"file",accept:".webp, .png, .jpeg, .jpg"},null,32)])):_("",!0)}}),to=i("div",{class:"bg-black w-full h-full absolute top-0 left-0 bg-opacity-40 rounded-lg"},null,-1),so={class:"absolute top-0 left-0 bottom-0 right-0 flex items-center justify-center backdrop-blur-[2px]"},no={class:"dark:bg-gray-700 bg-gray-200 px-4 py-2 rounded-lg tracking-widest"},Ye=j({__name:"ChatFileError",setup(r){const e=U();return(s,n)=>(h(),P(B,{name:"fade"},{default:w(()=>[t(e).fileChecked?(h(),g("div",{key:0,class:"cursor-pointer",onClick:n[0]||(n[0]=o=>t(e).fileChecked=!1)},[to,i("div",so,[i("p",no,f(s.$t("Неизвестный формат файла")),1)])])):_("",!0)]),_:1}))}}),io={key:0,class:"absolute z-30 w-full h-full top-0 left-0"},oo={class:"absolute dark:bg-gray-700 bg-gray-200 rounded-lg bottom-0 top-0 h-max left-0 right-0 w-10/12 mx-auto my-auto"},ro={class:"p-4"},ao={class:"pb-2"},lo={class:"text-lg"},uo={class:"flex items-center gap-x-6 select-none"},ho={key:0,class:"w-[80px] h-[80px] max-sm:w-[70px] max-sm:h-[70px]"},co=["src"],po={key:1},go={class:"w-[80px] flex justify-center items-center text-xl h-[80px] rounded-full bg-blueSemiLight"},mo=["onClick"],fo={key:1},vo={key:2},wo=["src"],Co={class:"text-sm tracking-wider text-semiCyan"},yo=i("div",null,null,-1),xo={class:"flex justify-end gap-x-2 p-4 !text-sm"},ko=j({__name:"ChatWindowSettingContentHeaderChange",setup(r){const e=U(),s=ee(),n=J();return(o,l)=>{var a,d,u;return t(e).showChatChangeInfo?(h(),g("div",io,[i("div",{class:"bg-black w-full h-full absolute left-0 top-0 opacity-50",onClick:l[0]||(l[0]=c=>{t(e).showChatChangeInfo=!1,t(e).file="",t(e).src="",t(e).fileUpload=null,t(e).results={image:null,coordinates:null}})}),i("div",oo,[i("div",ro,[i("div",ao,[i("p",lo,f(o.$t("Настройки группы")),1)]),i("div",uo,[i("div",{class:"relative",onMouseenter:l[1]||(l[1]=c=>t(e).showImageChange=!0),onMouseleave:l[2]||(l[2]=c=>t(e).showImageChange=!1)},[k(B,{name:"fade"},{default:w(()=>[k(Ge)]),_:1}),!t(e).src&&!t(e).results.image?(h(),g("div",ho,[(a=t(e).get_user_chat.user)!=null&&a.id||t(e).get_user_chat.photo_url?(h(),g("img",{key:0,class:"w-full rounded-full",src:t(e).get_user_chat.is_group?t(n).get_server_domain+((u=t(e).get_user_chat)==null?void 0:u.photo_url):t(n).get_server_domain+((d=t(e).get_user_chat.user)==null?void 0:d.photo),alt:""},null,8,co)):(h(),g("div",po,[i("div",go,[(h(!0),g(q,null,G(t(e).get_user_chat.name.split(" ").slice(0,2),c=>(h(),g("p",{class:"uppercase",onClick:p=>console.log(c[0])},f(c[0]),9,mo))),256))])]))])):t(e).results.image?(h(),g("div",fo,[k(t(He),{class:"w-[80px] h-[80px] rounded-full",image:t(e).results.image,coordinates:t(e).results.coordinates},null,8,["image","coordinates"])])):t(e).src&&!t(e).results.image?(h(),g("div",vo,[i("img",{class:"w-[80px] flex justify-center items-center text-xl h-[80px] rounded-full",src:t(e).src},null,8,wo)])):_("",!0)],32),i("div",null,[i("div",null,[i("p",Co,f(o.$t("Название группы")),1),k(ge,{type:"default",modelValue:t(e).updateChatName,"onUpdate:modelValue":l[3]||(l[3]=c=>t(e).updateChatName=c),class:"bg-transparent bg-opacity-0 border-b-2 border-b-semiCyan outline-none"},null,8,["modelValue"])])])]),yo]),i("div",xo,[k(O,{type:"chat",onClick:l[4]||(l[4]=c=>{t(e).showChatChangeInfo=!1,t(e).file="",t(e).src="",t(e).fileUpload=null,t(e).results={image:null,coordinates:null},t(e).updateChatName=t(e).userChat.name})},{default:w(()=>[$(f(o.$t("Отмена")),1)]),_:1}),k(O,{type:"chat",onClick:l[5]||(l[5]=c=>{t(e).updateChatName!==t(e).userChat.name||t(e).updateDescription!==t(e).userChat.description||t(e).fileUpload?t(e).chatUpdate({id:t(s).params.id,update:{name:t(e).updateChatName,description:"",photo:t(e).fileUpload}}).then(p=>{t(e).showChatChangeInfo=!1,t(e).fileUpload=null,t(e).userChat.name=t(e).updateChatName,t(e).updateChatName=""}):t(Q).info(o.$t("Измените содержимое для сохранения"),{autoClose:1500,theme:"auto"})})},{default:w(()=>[$(f(o.$t("Сохранить")),1)]),_:1})]),k(Ye)])])):_("",!0)}}}),bo={key:0,class:"absolute z-30 w-full h-full top-0 left-0 flex items-center"},_o={class:"bg-gray-700 w-10/12 mx-auto h-max rounded-lg relative"},$o={class:"tracking-wider px-4 pt-4"},Mo={class:"text-sm text-gray-400 ml-2"},So=i("div",{class:"w-full px-4 flex overflow-y-auto max-h-[300px] items-center"},[i("div",{class:"absolute rotate-90 ml-2"},[i("svg",{class:"dark:stroke-white stroke-black",width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M14.9536 14.9458L21 21M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z","stroke-width":"1.2","stroke-linecap":"round","stroke-linejoin":"round"})])]),i("input",{type:"text",class:"w-full dark:bg-gray-700 outline-none pl-10 h-[50px]",placeholder:"Поиск..."})],-1),Lo={class:"max-h-[300px] overflow-y-auto"},Wo={class:"w-full px-4 h-[50px] flex items-center justify-end text-sm gap-x-4"},To=j({__name:"ChatWindowSettingContent",setup(r){const e=U(),s=R(!1);R("");const n=[];return(o,l)=>(h(),g("div",{onClick:l[4]||(l[4]=a=>t(e).showSettingChat=!1)},[k(Ti,{onShowGroupAdd:l[0]||(l[0]=a=>s.value=!0)}),k(zi),k(Ji),k(B,{name:"fade"},{default:w(()=>[k(ko)]),_:1}),k(B,{name:"fade"},{default:w(()=>[t(s)?(h(),g("div",bo,[i("div",{class:"absolute bg-black left-0 top-0 w-full h-full bg-opacity-50",onClick:l[1]||(l[1]=a=>s.value=!1)}),i("div",_o,[i("p",$o,[$(f(o.$t("Добавить участников"))+" ",1),i("span",Mo,f(n.length+"/1000"),1)]),So,i("div",Lo,[(h(!0),g(q,null,G(t(e).get_chat_list.results.filter(a=>!a.is_group),a=>(h(),P(ft,{item:a},null,8,["item"]))),256))]),i("div",Wo,[k(O,{type:"chat",onClick:l[2]||(l[2]=a=>{s.value=!1})},{default:w(()=>[$(f(o.$t("Отмена")),1)]),_:1}),k(O,{type:"chat",onClick:l[3]||(l[3]=()=>{})},{default:w(()=>[$(f(o.$t("Добавить")),1)]),_:1})])])])):_("",!0)]),_:1})]))}}),Po={},Eo={class:"text-sm tracking-wider flex items-center gap-x-4 dark:hover:bg-gray-500 hover:bg-gray-300 px-3 py-1 cursor-pointer"},Do={class:""};function jo(r,e){return h(),g("div",null,[i("div",Eo,[i("div",null,[I(r.$slots,"chatWindowSettingContentSvg")]),i("p",Do,[I(r.$slots,"chatWindowSettingContentText")])])])}const _e=we(Po,[["render",jo]]),Ro={class:""},Uo=i("svg",{class:"dark:stroke-white stroke-black",width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M12 12H12.01M12 6H12.01M12 18H12.01M13 12C13 12.5523 12.5523 13 12 13C11.4477 13 11 12.5523 11 12C11 11.4477 11.4477 11 12 11C12.5523 11 13 11.4477 13 12ZM13 18C13 18.5523 12.5523 19 12 19C11.4477 19 11 18.5523 11 18C11 17.4477 11.4477 17 12 17C12.5523 17 13 17.4477 13 18ZM13 6C13 6.55228 12.5523 7 12 7C11.4477 7 11 6.55228 11 6C11 5.44772 11.4477 5 12 5C12.5523 5 13 5.44772 13 6Z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),Vo=[Uo],Oo=i("svg",{class:"dark:fill-white fill-black",width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M12 17.75C12.4142 17.75 12.75 17.4142 12.75 17V11C12.75 10.5858 12.4142 10.25 12 10.25C11.5858 10.25 11.25 10.5858 11.25 11V17C11.25 17.4142 11.5858 17.75 12 17.75Z"}),i("path",{d:"M12 7C12.5523 7 13 7.44772 13 8C13 8.55228 12.5523 9 12 9C11.4477 9 11 8.55228 11 8C11 7.44772 11.4477 7 12 7Z"}),i("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M1.25 12C1.25 6.06294 6.06294 1.25 12 1.25C17.9371 1.25 22.75 6.06294 22.75 12C22.75 17.9371 17.9371 22.75 12 22.75C6.06294 22.75 1.25 17.9371 1.25 12ZM12 2.75C6.89137 2.75 2.75 6.89137 2.75 12C2.75 17.1086 6.89137 21.25 12 21.25C17.1086 21.25 21.25 17.1086 21.25 12C21.25 6.89137 17.1086 2.75 12 2.75Z"})],-1),zo=i("svg",{class:"dark:stroke-white stroke-black",width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("circle",{opacity:"0.5",cx:"12",cy:"9",r:"3","stroke-width":"1"}),i("circle",{cx:"12",cy:"12",r:"10","stroke-width":"1"}),i("path",{opacity:"0.5",d:"M17.9691 20C17.81 17.1085 16.9247 15 11.9999 15C7.07521 15 6.18991 17.1085 6.03076 20","stroke-width":"1","stroke-linecap":"round"})],-1),Bo=i("svg",{class:"dark:stroke-white stroke-black",width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("circle",{opacity:"0.5",cx:"12",cy:"9",r:"3","stroke-width":"1"}),i("circle",{cx:"12",cy:"12",r:"10","stroke-width":"1"}),i("path",{opacity:"0.5",d:"M17.9691 20C17.81 17.1085 16.9247 15 11.9999 15C7.07521 15 6.18991 17.1085 6.03076 20","stroke-width":"1","stroke-linecap":"round"})],-1),Ao=j({__name:"ChatChangeWindow",setup(r){const e=U();return(s,n)=>(h(),g("div",Ro,[i("div",{onClick:n[0]||(n[0]=V(o=>t(e).showChangeWindowChat=!t(e).showChangeWindowChat,["stop"])),class:Z(["p-1 rounded-full transition-all duration-200 cursor-pointer dark:hover:bg-gray-500 hover:bg-gray-200",{"dark:bg-gray-500 bg-gray-200":t(e).showChangeWindowChat}])},Vo,2),k(B,{name:"fade"},{default:w(()=>[t(e).showChangeWindowChat?(h(),g("div",{key:0,onClick:n[4]||(n[4]=V(o=>t(e).showChangeWindowChat=!1,["stop"])),class:"absolute top-14 right-8 z-50 dark:bg-gray-600 bg-gray-200 border border-gray-300 dark:border dark:border-gray-500"},[t(e).get_user_chat.is_group?(h(),P(_e,{key:0,onClick:n[1]||(n[1]=o=>t(e).showChatInfo=!0)},{chatWindowSettingContentSvg:w(()=>[Oo]),chatWindowSettingContentText:w(()=>[$(f(s.$t("Информация о группе")),1)]),_:1})):(h(),P(_e,{key:1,onClick:n[2]||(n[2]=o=>t(e).showChatInfo=!0)},{chatWindowSettingContentSvg:w(()=>[zo]),chatWindowSettingContentText:w(()=>[$(f(s.$t("Показать профиль")),1)]),_:1})),t(e).get_user_chat.is_group?(h(),P(_e,{key:2,onClick:n[3]||(n[3]=o=>{t(e).showChatChangeInfoModal=!0,t(e).updateChatName=t(e).userChat.name})},{chatWindowSettingContentSvg:w(()=>[Bo]),chatWindowSettingContentText:w(()=>[$(f(s.$t("Управление группой")),1)]),_:1})):_("",!0)])):_("",!0)]),_:1})]))}}),Ho={class:"!w-max dark:!bg-gray-700 bg-white rounded-lg relative p-5 max-sm:p-3 overflow-y-auto"},Io={key:0,class:"tracking-widest"},No={class:"flex gap-x-12 mt-6"},Zo={class:"flex gap-x-4"},Fo=i("div",{class:"bg-blueSemiLight rounded-full p-3"},[i("svg",{width:"30px",height:"30px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("g",{opacity:"0.5"},[i("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M14 22H10C6.22876 22 4.34315 22 3.17157 20.8284C2 19.6569 2 17.7712 2 14V10C2 6.22876 2 4.34315 3.17157 3.17157C4.34315 2 6.23869 2 10.0298 2C10.6358 2 11.1214 2 11.53 2.01666C11.5166 2.09659 11.5095 2.17813 11.5092 2.26057L11.5 5.09497C11.4999 6.19207 11.4998 7.16164 11.6049 7.94316C11.7188 8.79028 11.9803 9.63726 12.6716 10.3285C13.3628 11.0198 14.2098 11.2813 15.0569 11.3952C15.8385 11.5003 16.808 11.5002 17.9051 11.5001L18 11.5001H21.9574C22 12.0344 22 12.6901 22 13.5629V14C22 17.7712 22 19.6569 20.8284 20.8284C19.6569 22 17.7712 22 14 22Z",fill:"#1C274C"})]),i("path",{d:"M11.5092 2.2601L11.5 5.0945C11.4999 6.1916 11.4998 7.16117 11.6049 7.94269C11.7188 8.78981 11.9803 9.6368 12.6716 10.3281C13.3629 11.0193 14.2098 11.2808 15.057 11.3947C15.8385 11.4998 16.808 11.4997 17.9051 11.4996L21.9574 11.4996C21.9698 11.6552 21.9786 11.821 21.9848 11.9995H22C22 11.732 22 11.5983 21.9901 11.4408C21.9335 10.5463 21.5617 9.52125 21.0315 8.79853C20.9382 8.6713 20.8743 8.59493 20.7467 8.44218C19.9542 7.49359 18.911 6.31193 18 5.49953C17.1892 4.77645 16.0787 3.98536 15.1101 3.3385C14.2781 2.78275 13.862 2.50487 13.2915 2.29834C13.1403 2.24359 12.9408 2.18311 12.7846 2.14466C12.4006 2.05013 12.0268 2.01725 11.5 2.00586L11.5092 2.2601Z",fill:"#1C274C"})])],-1),Xo={class:"break-words"},qo={class:"text-gray-500 font-bold text-sm"},Go=i("div",null,[i("svg",{class:"stroke-white",width:"20px",height:"20px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M10 12V17","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{d:"M14 12V17","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{d:"M4 7H20","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{d:"M6 10V18C6 19.6569 7.34315 21 9 21H15C16.6569 21 18 19.6569 18 18V10","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"}),i("path",{d:"M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})])],-1),Yo={class:"my-2"},Ko={class:"text-sm tracking-wider text-semiCyan"},Jo={class:"flex justify-end text-sm"},Qo=j({__name:"ChatUploadWindow",setup(r){const e=ee(),s=U();return(n,o)=>(h(),P(B,{name:"fade"},{default:w(()=>{var l;return[t(s).showUploadWindow&&t(s).file.size>0?(h(),g("div",{key:0,class:"fixed left-0 top-0 h-screen w-screen flex justify-center items-center z-[110] backdrop-blur-sm",onScroll:o[6]||(o[6]=V(()=>{},["prevent"])),onWheel:o[7]||(o[7]=V(()=>{},["prevent"]))},[i("div",{class:"opacity-60 bg-black absolute left-0 top-0 w-screen h-screen backdrop-blur",onClick:o[0]||(o[0]=a=>{t(s).showUploadWindow=!1,t(s).file="",t(s).src=""})}),i("div",Ho,[t(s).messageUpdate.file?_("",!0):(h(),g("p",Io,f(n.$t("Отправить как файл")),1)),i("div",No,[i("div",Zo,[Fo,i("div",Xo,[i("p",null,f(((l=t(s).file.name)==null?void 0:l.length)>25?t(s).file.name.slice(0,20)+"..."+t(s).file.name.substr(-5):t(s).file.name),1),i("p",qo,f(t(s).file.size<1e3?t(s).file.size+" "+n.$t("Б"):t(s).file.size+" "+n.$t("КБ")),1)])]),Go]),i("div",Yo,[i("p",Ko,f(n.$t("Подпись")),1),t(s).messageUpdate.file?(h(),P(ge,{key:1,type:"default",modelValue:t(s).messageUpdate.updateText,"onUpdate:modelValue":o[2]||(o[2]=a=>t(s).messageUpdate.updateText=a),class:"bg-transparent bg-opacity-0 border-b-2 border-b-semiCyan outline-none"},null,8,["modelValue"])):(h(),P(ge,{key:0,type:"default",modelValue:t(s).signature,"onUpdate:modelValue":o[1]||(o[1]=a=>t(s).signature=a),class:"bg-transparent bg-opacity-0 border-b-2 border-b-semiCyan outline-none"},null,8,["modelValue"]))]),i("div",Jo,[k(O,{type:"chat",onClick:o[3]||(o[3]=a=>{t(s).showUploadWindow=!1,t(s).file="",t(s).src="",t(s).signature=""})},{default:w(()=>[$(f(n.$t("Отмена")),1)]),_:1}),t(s).messageUpdate.file?(h(),P(O,{key:1,type:"chat",onClick:o[5]||(o[5]=a=>{t(s).updateMessage({id:t(s).messageUpdate.id,text:t(s).messageUpdate.updateText}).then(d=>{t(s).showUploadWindow=!1,t(s).file="",t(s).src="",t(s).signature=""})})},{default:w(()=>[$(f(n.$t("Сохранить")),1)]),_:1})):(h(),P(O,{key:0,type:"chat",onClick:o[4]||(o[4]=a=>{t(s).createMessage({id:t(e).params.id,file:t(s).file,text:t(s).signature}).then(d=>{t(s).showUploadWindow=!1,t(s).file="",t(s).src="",t(s).signature=""})})},{default:w(()=>[$(f(n.$t("Отправить")),1)]),_:1}))])])],32)):_("",!0)]}),_:1}))}}),er={class:"dark:bg-black dark:bg-opacity-70 bg-gray-200 p-4 text-center break-words rounded-lg"},tr=j({__name:"ChatUploadError",setup(r){const e=U();return(s,n)=>(h(),P(B,{name:"fade"},{default:w(()=>[t(e).fileSizeInfo?(h(),g("div",{key:0,class:"absolute top-0 bottom-0 left-0 right-0 z-20 w-full my-auto mx-auto flex justify-center items-center backdrop-blur-sm",onClick:n[0]||(n[0]=o=>{t(e).fileSizeInfo=!1,t(e).fileReadInfo=!1,t(e).file="",t(e).src=""})},[i("div",er,[i("p",null,[$(f(s.$t("Невозможно отправить пустой файл"))+": ",1),i("span",null,f(t(e).file.name),1)])])])):_("",!0)]),_:1}))}}),sr={class:"w-full py-2.5 border-b flex items-center max-h-[8%] max-md:pt-3 max-md:px-14 max-sm:px-2 h-[100px] px-10 dark:border-opacity-20 bg-white dark:bg-gray-700"},nr={key:0,class:"flex gap-x-4 justify-center relative items-center mb-2"},ir={class:"flex items-center gap-x-2 cursor-pointer"},or=i("svg",{class:"dark:fill-gray-400 fill-black",width:"30px",height:"30px",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M604.7 759.2l61.8-61.8L481.1 512l185.4-185.4-61.8-61.8L357.5 512z"})],-1),rr=[or],ar=["src"],lr={key:1,class:"rounded-full bg-azure flex items-center justify-center w-[42px] h-[42px]"},dr={key:0,width:"16",height:"20",viewBox:"0 0 16 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ur=i("path",{d:"M1 5.8C1 4.11984 1 3.27976 1.32698 2.63803C1.6146 2.07354 2.07354 1.6146 2.63803 1.32698C3.27976 1 4.11984 1 5.8 1H10.2C11.8802 1 12.7202 1 13.362 1.32698C13.9265 1.6146 14.3854 2.07354 14.673 2.63803C15 3.27976 15 4.11984 15 5.8V19L8 15L1 19V5.8Z",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),hr=[ur],cr=["onClick"],pr={key:2,class:"font-bold"},gr={key:3,class:"font-bold"},mr={class:"dark:bg-gray-700 rounded-lg h-max relative mx-auto my-auto"},fr={class:""},vr={class:"text-lg"},wr={class:"py-1 flex items-center gap-x-6 select-none"},Cr={key:0},yr=["src"],xr={key:1},kr={class:"w-[80px] flex justify-center items-center text-xl h-[80px] rounded-full bg-blueSemiLight"},br=["onClick"],_r={key:1},$r={key:2},Mr=["src"],Sr={class:"text-sm text-semiCyan"},Lr={class:"flex justify-end gap-x-2 !text-sm"},Wr={key:0,class:"fixed left-0 top-0 h-screen w-screen flex justify-center items-center z-[110]"},Tr=i("div",{class:"bg-gray-300 w-20 h-20"},null,-1),Yr=j({__name:"[id]",props:{activeNav:{type:Boolean,default:!0}},setup(r){const e=J(),s=ee(),n=ve(),o=U();Ee(()=>{o.messageText=""});function l(){let a=new WebSocket(`wss://api-buildwithus.ai-softdev.com/ws/chat/${s.params.id}?token=${gt.localStorage.getData("token")}`);a.onmessage=d=>{var c,p,v,m;let u=JSON.parse(d.data);if(((c=o.userChat)==null?void 0:c.id)===u.chat_id&&a.readyState===WebSocket.OPEN){let C=o.userChat.messages[o.userChat.messages.length-1];(C==null?void 0:C.date)==new Date(u.created_at).toLocaleDateString()?(v=(p=o.userChat.messages[o.userChat.messages.length-1])==null?void 0:p.messages)==null||v.push(u):o.userChat.messages.push({date:new Date(u.created_at).toLocaleDateString(),messages:[u]})}for(let C=0;C<o.chatList.results.length;C++)o.chatList.results[C].id===u.chat_id&&(o.chatList.results[C].last_message=u,u.file!==o.userChat.photo_url&&u.message_type==="change"&&u.file&&(o.userChat.photo_url=u.file));if(u.type==="delete_message")for(let C=0;C<o.userChat.messages.length;C++)for(let b=o.userChat.messages[C].messages.length-1;b>=0;b--)o.userChat.messages[C].messages[b].id===u.message_id&&((m=o.userChat.messages[C].messages)==null||m.splice(b,1));else if(u.type==="update_message"){for(let C=0;C<o.userChat.messages.length;C++)for(let b=o.userChat.messages[C].messages.length-1;b>=0;b--)if(o.userChat.messages[C].messages[b].id===u.message.id){o.userChat.messages[C].messages[b]=u.message;break}}},Ee(()=>{a.close()})}return ie(()=>{o.loadUserChat({id:s.params.id,limit:100,page:1}),o.loadPinnedList({id:s.params.id,limit:100,page:1}),l()}),it({title:"Чат"}),(a,d)=>{var u,c,p,v,m,C,b,L,S,y;return h(),g("div",{class:"h-full w-full",onClick:d[10]||(d[10]=x=>t(o).showChangeWindowChat=!1)},[i("div",sr,[!t(o).get_user_chat.user&&!t(o).get_user_chat.is_group||(u=t(o).get_user_chat.users)!=null&&u.id?(h(),g("div",nr,[k(je,{class:"opacity-50",width:"40px",height:"40px","border-radius":"100%"}),k(je,{class:"opacity-50",width:"150px",height:"10px","border-radius":"4px"})])):(h(),g("div",{key:1,class:"flex items-center justify-between w-full",onClick:d[1]||(d[1]=x=>t(o).showChatInfo=!0)},[i("div",ir,[i("div",{class:"hidden max-md:block",onClick:d[0]||(d[0]=V(x=>t(n).push("/base/chat"),["prevent"]))},rr),(c=t(o).get_user_chat.user)!=null&&c.id||t(o).get_user_chat.photo_url?(h(),g("img",{key:0,class:"w-[40px] h-[40px] rounded-full",src:t(o).get_user_chat.is_group?t(e).get_server_domain+((v=t(o).get_user_chat)==null?void 0:v.photo_url):t(e).get_server_domain+((p=t(o).get_user_chat.user)==null?void 0:p.photo),alt:""},null,8,ar)):(h(),g("div",lr,[!t(o).get_user_chat.photo_url&&!t(o).get_user_chat.is_group?(h(),g("svg",dr,hr)):(h(!0),g(q,{key:1},G(t(o).get_user_chat.name.split(" ").slice(0,2),x=>(h(),g("p",{class:"uppercase font-bold",onClick:z=>console.log(x[0])},f(x[0]),9,cr))),256))])),t(o).get_user_chat.is_group?(h(),g("p",gr,f(((L=t(o).get_user_chat)==null?void 0:L.name.length)>30?((S=t(o).get_user_chat)==null?void 0:S.name.slice(0,30))+"...":(y=t(o).get_user_chat)==null?void 0:y.name),1)):(h(),g("p",pr,f(((m=t(o).get_user_chat.user)==null?void 0:m.last_name)===""?a.$t("Избранное"):((C=t(o).get_user_chat.user)==null?void 0:C.first_name)+" "+((b=t(o).get_user_chat.user)==null?void 0:b.last_name)),1))]),k(Ao)]))]),k(mi),k(Kn),k(B,{name:"slide-down"},{default:w(()=>{var x;return[t(o).showChatInfo&&((x=t(o).userChat)!=null&&x.is_group)?(h(),P(X,{key:0,type:"resizeInfoWindow",class:"",onShowModal:d[2]||(d[2]=z=>{t(o).showChatInfo=!1,t(o).showSettingChat=!1,t(o).showChatChangeInfo=!1})},{default:w(()=>[k(To)]),_:1})):_("",!0)]}),_:1}),k(B,{name:"fade"},{default:w(()=>[t(o).showChatChangeInfoModal?(h(),P(X,{key:0,type:"resize",onShowModal:d[8]||(d[8]=x=>{t(o).showChatChangeInfoModal=!1,t(o).file="",t(o).src="",t(o).fileUpload=null,t(o).results={image:null,coordinates:null}})},{default:w(()=>{var x,z,D;return[i("div",mr,[i("div",fr,[i("p",vr,f(a.$t("Настройки группы")),1)]),i("div",wr,[i("div",{class:"relative",onMouseenter:d[3]||(d[3]=T=>t(o).showImageChange=!0),onMouseleave:d[4]||(d[4]=T=>t(o).showImageChange=!1)},[k(B,{name:"fade"},{default:w(()=>[k(Ge)]),_:1}),!t(o).src&&!t(o).results.image?(h(),g("div",Cr,[(x=t(o).get_user_chat.user)!=null&&x.id||t(o).get_user_chat.photo_url?(h(),g("img",{key:0,class:"w-[80px] h-[80px] rounded-full",src:t(o).get_user_chat.is_group?t(e).get_server_domain+((D=t(o).get_user_chat)==null?void 0:D.photo_url):t(e).get_server_domain+((z=t(o).get_user_chat.user)==null?void 0:z.photo),alt:""},null,8,yr)):(h(),g("div",xr,[i("div",kr,[(h(!0),g(q,null,G(t(o).get_user_chat.name.split(" ").slice(0,2),T=>(h(),g("p",{class:"uppercase",onClick:M=>console.log(T[0])},f(T[0]),9,br))),256))])]))])):t(o).results.image?(h(),g("div",_r,[k(t(He),{class:"w-[80px] h-[80px] rounded-full",image:t(o).results.image,coordinates:t(o).results.coordinates},null,8,["image","coordinates"])])):t(o).src&&!t(o).results.image?(h(),g("div",$r,[i("img",{class:"w-[80px] flex justify-center items-center text-xl h-[80px] rounded-full",src:t(o).src},null,8,Mr)])):_("",!0)],32),i("div",null,[i("div",null,[i("p",Sr,f(a.$t("Название группы")),1),k(ge,{type:"default",modelValue:t(o).updateChatName,"onUpdate:modelValue":d[5]||(d[5]=T=>t(o).updateChatName=T),class:"bg-transparent bg-opacity-0 border-b-2 border-b-semiCyan outline-none"},null,8,["modelValue"])])])]),i("div",Lr,[k(O,{type:"chat",onClick:d[6]||(d[6]=T=>{t(o).showChatChangeInfoModal=!1,t(o).file="",t(o).src="",t(o).fileUpload=null,t(o).results={image:null,coordinates:null}})},{default:w(()=>[$(f(a.$t("Отмена")),1)]),_:1}),k(O,{type:"chat",onClick:d[7]||(d[7]=T=>{t(o).updateChatName!==t(o).userChat.name||t(o).updateDescription!==t(o).userChat.description||t(o).fileUpload?t(o).chatUpdate({id:t(s).params.id,update:{name:t(o).updateChatName,description:"",photo:t(o).fileUpload}}).then(M=>{t(o).showChatChangeInfoModal=!1,t(o).fileUpload=null,t(o).userChat.name=t(o).updateChatName,t(o).updateChatName=""}):t(Q).info(a.$t("Измените содержимое для сохранения"),{autoClose:1500,theme:"auto"})})},{default:w(()=>[$(f(a.$t("Сохранить")),1)]),_:1})])]),k(Ye)]}),_:1})):_("",!0)]),_:1}),k(B,{name:"fade"},{default:w(()=>[t(o).showChatGallery?(h(),g("div",Wr,[i("div",{class:"opacity-60 bg-black absolute left-0 top-0 w-screen h-screen",onClick:d[9]||(d[9]=x=>t(o).showChatGallery=!1)}),Tr])):_("",!0)]),_:1}),k(Qo),k(tr)])}}});export{Yr as default};
