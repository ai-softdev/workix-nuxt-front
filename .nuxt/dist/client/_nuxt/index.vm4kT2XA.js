import{N as r,O as c,a5 as H,a as I,u as e,P as U,V as f,$ as V,_ as i,a4 as x,L as m,Z as s,a6 as J,aa as q,ab as A,J as L,a2 as N,ao as E,j as F,H as W,a8 as Z,a3 as C}from"./swiper-vue.yO-n0JsZ.js";import{_ as B}from"./TheButton.vue.2_uJPPgi.js";import{_ as h}from"./TheInput.vue.7qlRdbvh.js";import{_ as G}from"./TheModal.vue.CfyleZWN.js";import{_ as z}from"./TheTextContent.vue.DJ99356g.js";import{_ as K}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{u as O}from"./users.CzSUjiFl.js";import{u as Q}from"./companies.VK1IXC9v.js";import{u as M}from"./auth.C3ooDTVz.js";import"./vue-datepicker.BBR82a8J.js";import{_ as R}from"./nuxt-link.BiU7cbZE.js";import{E as X}from"./entry.CSYda6I0.js";import{_ as Y}from"./TheFilter.vue.DZIlf15C.js";import{_ as ee}from"./TheSearch.vue.CMnXhBnJ.js";import{u as te}from"./index.DKVFDEBH.js";import"./nuxt-storage.CgJyI38a.js";const se={},le={class:"flex max-lg:flex-wrap justify-center gap-x-10 my-10 mx-auto w-full"};function ae(u,p){return r(),c("div",le,[H(u.$slots,"default")])}const b=K(se,[["render",ae]]),oe={class:"w-6/12 max-lg:w-full"},re={class:"w-6/12 max-lg:w-full"},ne={class:"w-6/12 max-lg:w-full"},ie={class:"w-6/12 max-lg:w-full"},de={class:"w-6/12 max-lg:w-full"},ue={class:"w-6/12 max-lg:w-full flex flex-col"},me={class:"text-md dark:text-white tracking-wider"},ce={class:"w-6/12 flex flex-col max-lg:w-full gap-y-1"},pe={class:"text-md dark:text-white tracking-wider"},_e={class:"w-6/12 flex flex-col max-lg:w-full"},fe={class:"text-md dark:text-white tracking-wider"},we={class:"cursor-pointer hover:bg-semiCyan rounded-lg border-dashed border p-4 transition-all mt-2"},ge={class:"w-6/12 max-lg:w-full relative"},xe={class:"text-md dark:text-white tracking-wider"},ye={key:0,class:"absolute z-10 bg-white dark:bg-gray-800 w-full rounded-lg mt-1 border border-gray-300 dark:border-gray-600 shadow-md max-h-40 overflow-y-auto"},he=["onMousedown"],be={key:0,class:"w-6/12 max-lg:w-full"},ke={class:"text-md dark:text-white tracking-widest mb-2"},ve=["value"],$e={class:"w-6/12 max-lg:w-full"},Ce={class:"text-md dark:text-white tracking-wider"},Ue=["value"],Ve={__name:"UserCreate",props:{showCreateUser:{type:Boolean,default:!1}},setup(u){const p=M(),d=Q(),o=O(),t=I({email:"",first_name:"",last_name:"",patronymic:"",password:"",phone:"",photo:"",position:"",head_user_id:"",date_of_birth:new Date().toDateString(),company_id:0,department_id:0,department:{},role_id:0,permissions:{}});function w(){o.loadPositionList(),o.loadUserList(),d.loadDepartmentList()}function g(){var n;(n=t.value.department)!=null&&n.id&&(t.value.department_id=t.value.department.id),o.createAdmin(t.value),t.value={email:"",first_name:"",last_name:"",patronymic:"",password:"",phone:"",photo:"",position:"",head_user_id:"",date_of_birth:new Date().toDateString(),company_id:0,department_id:0,department:{},role_id:0,permissions:{}}}function T(){var n;(n=t.value.department)!=null&&n.id&&(t.value.department_id=t.value.department.id),o.createUser(t.value),t.value={email:"",first_name:"",last_name:"",patronymic:"",password:"",phone:"",photo:"",position:"",head_user_id:"",date_of_birth:new Date().toDateString(),company_id:0,department_id:0,department:{},role_id:0,permissions:{}}}const k=I(!1),v=I([]),S=()=>{t.value.position?v.value=o.get_position_list.filter(n=>n.name.toLowerCase().includes(t.value.position.toLowerCase())):v.value=o.get_position_list,k.value=!0},j=n=>{t.value.position=n,k.value=!1},D=()=>{setTimeout(()=>{k.value=!1},200)};return(n,a)=>(r(),c("div",null,[e(p).current_user.permissions?(r(),U(B,{key:0,class:"max-md:w-full w-full px-4 text-sm",type:"signIn",onClick:a[0]||(a[0]=$=>{var y;u.showCreateUser=!0,w(),((y=e(p).user.role)==null?void 0:y.name_en)==="admin"&&e(d).loadCompanyList({page:1,limit:1e3,query:""})})},{default:f(()=>[V(i(n.$t("Создать пользователя")),1)]),_:1})):x("",!0),u.showCreateUser?(r(),U(G,{key:1,onShowModal:a[17]||(a[17]=$=>{u.showCreateUser=!u.showCreateUser,u.showCreateUser?t.value={}:t.value={}}),"show-create-user":u.showCreateUser},{default:f(()=>{var $,y;return[m(z,null,{default:f(()=>[V(i(n.$t("Создание пользователя")),1)]),_:1}),s("form",{enctype:"multipart/form-data",onSubmit:a[16]||(a[16]=J(l=>{var _;return((_=e(p).user.role)==null?void 0:_.name_en)==="admin"?g():T()},["prevent"]))},[m(b,null,{default:f(()=>[s("div",oe,[m(h,{type:"text",label:n.$t("Имя"),modelValue:e(t).first_name,"onUpdate:modelValue":a[1]||(a[1]=l=>e(t).first_name=l)},null,8,["label","modelValue"])]),s("div",re,[m(h,{type:"text",label:n.$t("Фамилия"),modelValue:e(t).last_name,"onUpdate:modelValue":a[2]||(a[2]=l=>e(t).last_name=l)},null,8,["label","modelValue"])]),s("div",ne,[m(h,{type:"text",label:n.$t("Отчество"),modelValue:e(t).patronymic,"onUpdate:modelValue":a[3]||(a[3]=l=>e(t).patronymic=l)},null,8,["label","modelValue"])])]),_:1}),m(b,null,{default:f(()=>[s("div",ie,[m(h,{type:"text",label:"Email",modelValue:e(t).email,"onUpdate:modelValue":a[4]||(a[4]=l=>e(t).email=l)},null,8,["modelValue"])]),s("div",de,[m(h,{type:"password",label:n.$t("Пароль"),modelValue:e(t).password,"onUpdate:modelValue":a[5]||(a[5]=l=>e(t).password=l)},null,8,["label","modelValue"])])]),_:1}),m(b,null,{default:f(()=>[s("div",ue,[s("p",me,i(n.$t("Дата рождения")),1),m(h,{type:"date",class:"w-full rounded-lg p-2 outline-1",id:"date",placeholder:"Выбрать",modelValue:e(t).date_of_birth,"onUpdate:modelValue":a[6]||(a[6]=l=>e(t).date_of_birth=l)},null,8,["modelValue"]),q(s("input",{type:"date","onUpdate:modelValue":a[7]||(a[7]=l=>e(t).date_of_birth=l),class:"max-lg:block border outline-semiCyan dark:outline-none outline-1 dark:border-none hidden p-4 dark:bg-gray-300 dark:text-black mb-4 rounded-lg"},null,512),[[A,e(t).date_of_birth]])]),s("div",ce,[s("p",pe,i(n.$t("Номер телефона")),1),m(h,{type:"tel",class:"w-full rounded-lg p-2 outline-1",id:"phone",placeholder:"+998 (__) ___-__-__",modelValue:e(t).phone,"onUpdate:modelValue":a[8]||(a[8]=l=>e(t).phone=l)},null,8,["modelValue"])])]),_:1}),m(b,null,{default:f(()=>[s("div",_e,[s("p",fe,i(n.$t("Фото")),1),s("label",we,[s("input",{type:"file",name:"file",label:"Фото",class:"dark:text-white cursor-pointer",onInput:a[9]||(a[9]=l=>e(t).photo=l.target.files[0])},null,32)])])]),_:1}),m(b,null,{default:f(()=>[s("div",ge,[s("p",xe,i(n.$t("Должность")),1),q(s("input",{type:"text","onUpdate:modelValue":a[10]||(a[10]=l=>e(t).position=l),class:"dark:text-white cursor-pointer w-full dark:bg-gray-300 rounded-lg p-2.5 mt-2 border dark:border-none outline-semiCyan outline-1 text-black",onFocus:a[11]||(a[11]=l=>k.value=!0),onBlur:D,onInput:S},null,544),[[A,e(t).position]]),e(k)&&e(v).length?(r(),c("ul",ye,[(r(!0),c(L,null,N(e(v),l=>(r(),c("li",{key:l.name,onMousedown:_=>j(l.name),class:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer"},i(l.name),41,he))),128))])):x("",!0)])]),_:1}),m(b,null,{default:f(()=>{var l;return[e(p).user.role.name_en==="company_admin"?(r(),c("div",be,[s("p",ke,i(n.$t("Отдел")),1),q(s("select",{type:"text","onUpdate:modelValue":a[12]||(a[12]=_=>e(t).department=_),class:"w-full dark:bg-gray-300 rounded-lg p-2.5 border dark:border-none outline-semiCyan outline-1 text-black"},[(r(!0),c(L,null,N((l=e(d))==null?void 0:l.get_all_department.results,_=>(r(),c("option",{value:_},i(_.name),9,ve))),256))],512),[[E,e(t).department]])])):x("",!0)]}),_:1}),(y=($=e(t).department)==null?void 0:$.participants)!=null&&y.length?(r(),U(b,{key:0},{default:f(()=>{var l;return[s("div",$e,[s("p",Ce,i(n.$t("Руководитель")),1),(l=e(o))!=null&&l.get_position_list?x("",!0):(r(),U(h,{key:0,type:"text",name:"text",label:"Руководитель",class:"dark:text-white cursor-pointer",modelValue:e(t).head_user_id,"onUpdate:modelValue":a[13]||(a[13]=_=>e(t).head_user_id=_)},null,8,["modelValue"])),q(s("select",{"onUpdate:modelValue":a[14]||(a[14]=_=>e(t).head_user_id=_),class:"w-full dark:bg-gray-300 rounded-lg p-2.5 mt-2 border dark:border-none outline-semiCyan outline-1 text-black"},[(r(!0),c(L,null,N(e(t).department.participants,_=>(r(),c("option",{key:_.id,value:_.id},i(_.first_name)+" "+i(_.last_name),9,Ue))),128))],512),[[E,e(t).head_user_id]])])]}),_:1})):x("",!0),m(b,null,{default:f(()=>[m(B,{class:"py-2 px-6 rounded-full",t:"button",type:"danger",onClick:a[15]||(a[15]=l=>u.showCreateUser=!1)},{default:f(()=>[V(i(n.$t("Отменить")),1)]),_:1}),m(B,{class:"py-2 px-6 rounded-full",t:"submit",type:"success"},{default:f(()=>[V(i(n.$t("Создать")),1)]),_:1})]),_:1})],32)]}),_:1},8,["show-create-user"])):x("",!0)]))}},Le=Ve,Ne={class:"my-2 flex"},Se={class:"flex items-center max-md:w-4/12 gap-x-4 max-lg:mx-auto"},je=["src"],De={class:"tracking-widest font-bold break-words"},qe={class:"flex flex-col items-center justify-center my-2 max-md:w-4/12 mx-auto"},Ie={key:0,class:"text-lg font-bold tracking-widest mb-2"},Me={key:1,class:"text-lg font-bold tracking-widest mb-2"},Te={class:"text-center flex flex-col gap-y-2 tes-sm"},Be={key:0,class:"tracking-widest text-sm text-gray-600"},Pe={class:"tracking-widest text-md"},Ae={class:"flex flex-col items-center text-center"},Ee={key:0,class:"tracking-widest font-bold"},Fe=s("p",null,"20.20.2025",-1),We=F({__name:"UserContentList",props:{userItem:{type:Object,required:!0}},setup(u){const p=M();return(d,o)=>{const t=R;return r(),c("div",Ne,[m(t,{to:`/base/users/${u.userItem.id}`,class:"transition-all shadow-md hover:shadow-lg border dark:border-none dark:shadow-none dark:bg-gray-700 dark:hover:bg-gray-800 p-4 rounded-lg items-center max-md:flex max-md:w-full max-sm:flex-col max-sm:gap-y-4"},{default:f(()=>[s("div",Se,[s("img",{class:"w-14 h-14 rounded-full",src:u.userItem.photo,alt:""},null,8,je),s("h2",De,i(u.userItem.first_name+" "+u.userItem.last_name),1)]),s("div",qe,[s("div",null,[e(p).user.role_en==="admin"?(r(),c("p",Ie,i(d.$t("Роль | Должность")),1)):(r(),c("p",Me,i(d.$t("Должность")),1))]),s("div",Te,[e(p).user.role_en==="admin"?(r(),c("h2",Be,"("+i(u.userItem.role)+")",1)):x("",!0),s("h2",Pe,i(u.userItem.position),1)])]),s("div",Ae,[["company_admin","director","vice_director"].includes(e(p).user.role_en)?(r(),c("h2",Ee,i(d.$t("Дата регистрации")),1)):x("",!0),Fe])]),_:1},8,["to"])])}}}),ze={class:""},Oe={class:"mb-10 mt-12 text-lg flex gap-x-10"},He={key:0,class:"dark:text-white tracking-widest"},Je={key:1,class:"dark:text-white tracking-widest"},Ze={key:0,class:"flex gap-x-10"},Ge={class:"w-full"},Ke={class:"flex gap-x-10 max-lg:flex-wrap max-md:justify-center"},Qe={class:"flex w-9/12 justify-between max-lg:justify-center gap-x-10 items-center max-md:flex-wrap max-md:mt-10 max-md:justify-center"},Re={class:"flex max-md:flex-wrap justify-center max-md:mt-10"},Xe={class:"flex flex-wrap gap-x-6 max-md:order-2 max-lg:justify-center"},Ye={class:"flex flex-wrap justify-center gap-x-4 mt-10"},et=["onClick"],tt={__name:"UserContent",props:{userChecked:{type:String,default:"user-list"},showUserInfo:{type:Boolean,default:!1}},setup(u){const p=M(),d=O();I("");const o={page:1,limit:15,query:"",user_type:"user-list"};function t(w){w==="<"?Number(o.page)>1&&(o.page-=1):w===">"?Number(o.page)<d.user.number_of_pages&&(o.page=Number(o.page)+1):Number(w)<=d.user.number_of_pages&&(o.page=Number(w)),window.innerWidth>1e3?window.scrollTo({top:600}):window.innerWidth<1e3?window.scrollTo({top:895}):window.scrollTo()}return W(()=>{X({params:{page:o.page}})}),Z(()=>{var w,g;((w=p.user.role)==null?void 0:w.name_en)==="admin"?d.loadAdminList({page:o.page,limit:o.limit,query:o.query}):((g=p.user.role)==null?void 0:g.name_en)==="company_admin"&&d.loadUserList({page:o.page,limit:o.limit,query:o.query})}),(w,g)=>{var v,S,j,D,n,a,$,y;const T=Le,k=We;return r(),c("div",ze,[s("div",{class:C({"flex flex-wrap items-center justify-between":["company_admin","admin"].includes((v=e(p).user.role)==null?void 0:v.name_en)})},[s("div",Oe,[((S=e(p).user.role)==null?void 0:S.name_en)==="admin"?(r(),c("p",He,i(w.$t("Список администраторов компании")),1)):(r(),c("p",Je,i(w.$t("Список всех пользователей компании")),1))]),s("div",{class:C({"flex items-center justify-evenly my-10":((j=e(p).user.role)==null?void 0:j.name_en)==="admin","w-2/12 max-lg:w-4/12 max-sm:w-full max-sm:mb-6 max-sm:mx-auto":e(p).user.role_en!=="admin"})},[((D=e(p))==null?void 0:D.user.role)==="Администратор сайта"?(r(),c("div",Ze,[s("button",{class:C(["p-2 rounded-xl dark:text-white tracking-widest font-bold",{"bg-blueDarkSemiLight text-white":u.userChecked==="user-list"}]),onClick:g[0]||(g[0]=l=>{u.userChecked="user-list",e(d).loadUserList({page:e(d).page,limit:o.limit,user_type:u.userChecked})})},i(w.$t("Все пользователи")),3),s("button",{class:C(["p-2 rounded-xl dark:text-white tracking-widest font-bold",{"bg-blueDarkSemiLight text-white":u.userChecked==="admin-list"}]),onClick:g[1]||(g[1]=l=>{u.userChecked="admin-list",e(d).loadAdminList({page:e(d).page,limit:o.limit})})},i(w.$t("Администраторы компаний")),3)])):x("",!0),m(T)],2)],2),s("div",Ge,[s("div",Ke,[s("div",Qe,[m(ee,{class:"w-full","model-value":o.query,"onUpdate:modelValue":g[2]||(g[2]=l=>o.query=l),onSearch:g[3]||(g[3]=l=>e(d).loadUserList(o))},null,8,["model-value"]),m(Y)])]),s("div",Re,[s("div",Xe,[((n=e(d))==null?void 0:n.get_user_list.count)>0?(r(!0),c(L,{key:0},N((a=e(d))==null?void 0:a.get_user_list.results,l=>(r(),U(k,{"user-item":l,class:"max-md:w-full"},null,8,["user-item"]))),256)):x("",!0)])])]),s("div",Ye,[e(d).get_user_list.count>5?(r(!0),c(L,{key:0},N((y=($=e(d))==null?void 0:$.get_user_list)==null?void 0:y.links,(l,_)=>(r(),c("div",{key:_,class:C(["px-4 py-2 rounded-full cursor-pointer",{"bg-blue-400 text-white":l.active,"bg-gray-200 text-black":!l.active}]),onClick:at=>{var P;t(l.label),(P=e(d))==null||P.loadUserList({page:o.page,limit:o.limit,user_type:e(p).user.role_en!=="admin"?"user-list/my-company":u.userChecked,query:o.query})}},i(l.label),11,et))),128)):x("",!0)])])}}},st=tt,lt={class:"dark:text-gray-300 tracking-widest text-sm"},bt=F({__name:"index",setup(u){const p=M();return te({title:"Пользователи",description:"Список пользователей данной платформы"}),W(()=>{p.loadCurrentUserWorker()}),(d,o)=>{const t=st;return r(),c("div",null,[m(z,{"text-type":"pageTitle"},{default:f(()=>[V(i(d.$t("Страница с пользователями")),1)]),_:1}),s("p",lt,i(d.$t("Данная страница хранит информацию о пользователях данной платформы")),1),s("div",null,[m(t)])])}}});export{bt as default};
