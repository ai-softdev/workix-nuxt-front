import{d as s}from"./entry.BJg-2_xk.js";import{a,n,l as r}from"./nuxt-storage.gLjAmBiV.js";const d=s("current-company",{state:()=>({company:{id:"",name:"",address:"",created_at:"",description:"",email:"",logo_file:"",users_count:"",departments_count:"",objects_count:""},news:{title:"",description:"",photo:"",photo_url:""},department:{id:null,name:"",participants:[]},current_department:{id:"",name:"",participants:[]}}),getters:{current_company(t){return this.company},get_all_company(t){return this.company},get_all_news(t){return this.news},get_all_department(t){return this.department},get_department(t){return this.current_department}},actions:{async loadCurrentCompany(){await a.get("company/current",{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(t=>{this.company=t.data})},async loadCompanyList(t){await a.get(`company/list?page=${t.page}&limit=${t.limit}&query=${t.query}`,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.company=e.data})},async loadCompany(t){await a.get(`company/${t.id}`,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.company=e.data})},async loadDepartmentList(){await a.get("department/",{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(t=>{this.department=t.data})},async loadDepartment(t){await a.get(`department/${t.id}`,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.current_department=e.data})},async loadNewsList(){await a.get("news/news-list",{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(t=>{this.news=t.data})},async loadNews(t){await a.get(`news/${t.id}`,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.news=e.data})},async createCompany(t){await a.post("company/create",{name:t.name},{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.company=e.data,r.success("Компания успешно создана",{autoClose:1500,theme:"auto"}),this.loadCompanyList({page:1,limit:5,query:""})}).catch(e=>{r.error(e,{autoClose:1500,theme:"auto"})})},async createDepartment(t){await a.post("department/",{name:t.department.name},{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(e=>{this.department=e.data,this.loadDepartmentList()}).catch(e=>{r.error("Ошибка при создании",{theme:"auto",autoClose:1500})})},async deleteDepartment(t,e){await a.delete(`department/delete/${t.id}`,{headers:{Authorization:`Bearer ${n.localStorage.getData("token")}`}}).then(o=>{r.success("Успешно удалён",{autoClose:1500,theme:"auto"}),this.department=o.data,e.go(-1)})}}});export{d as u};
