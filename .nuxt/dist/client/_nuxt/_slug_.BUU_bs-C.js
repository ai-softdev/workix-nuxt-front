import{G as H,b as z,e as W}from"./entry.Bl3TfwwA.js";import{u as O}from"./index.DnGcLc5s.js";import{_ as G,a as N}from"./profile.3GgiGqgy.js";import{_ as D,a as P}from"./password.TPq8dtm_.js";import{_ as Z}from"./info.eyqwg9iD.js";import{u as C}from"./users.B-XzjljN.js";import{u as I}from"./auth.C-kg6DCt.js";import{u as T}from"./companies.DlNOYX_2.js";import{_ as M}from"./TheBreadcrumbs.vue.CMLt84UH.js";import{_ as S}from"./TheModal.vue.C2BTwYDA.js";import{_ as y}from"./TheButton.vue.DTxIZ_aw.js";import{C as L,A as q,p as F,a as J,R as Q,P as K}from"./index.CKxDXDoX.js";import{j,a as U,N as c,P as v,u as s,O as h,Z as e,L as m,_ as t,aa as X,aj as Y,J as E,a3 as B,V as _,$ as f,a6 as ee,w as se,a9 as te,a2 as A}from"./swiper-vue.CGVHF6NK.js";import{T as $}from"./TheSceleton.BVtskP3L.js";import{T as oe}from"./TheCheckbox.BS6YOR2O.js";import{_ as x}from"./TheInput.vue.DPjuIUBj.js";import{l as le}from"./nuxt-storage.LTSgK-Sl.js";import"./nuxt-link.DOeKP-C6.js";import"./_plugin-vue_export-helper.DlAUqK2U.js";import"./chat.BUll_oXM.js";const R=""+globalThis.__publicAssetsURL("icons/mail.svg"),ae=""+globalThis.__publicAssetsURL("icons/post.svg"),ie=""+globalThis.__publicAssetsURL("icons/stag.svg"),ne=j({__name:"TheUserChart",setup(r){L.register(q,F,J,Q),L.defaults.color="#b6b6b6";const w=U({labels:["Выполненные задания","Выполненные IQ тесты","Активность","Посещаемость"],datasets:[{backgroundColor:["rgba(109,252,118,0.4)","rgba(252,155,0,0.91)","rgba(0,121,255,0.4)","rgba(255,9,0,0.68)"],data:[70,70,90,100]}]}),u=U({responsive:!0,maintainAspectRatio:!1});return(p,l)=>(c(),v(s(K),{class:"text-white",style:{"{color":"white"},data:s(w),options:s(u)},null,8,["data","options"]))}}),re=""+globalThis.__publicAssetsURL("icons/pasport.svg"),de=""+globalThis.__publicAssetsURL("icons/salary.svg"),me={class:"flex flex-wrap items-center gap-x-10 max-sm:gap-y-4 max-sm:flex-col mb-6"},ce={class:"w-5/12 max-sm:w-full"},ue={class:"w-5/12 max-sm:w-full"},he={class:"flex flex-wrap items-center gap-x-10 max-sm:gap-y-4 max-sm:flex-col mb-6"},pe={class:"w-5/12 max-sm:w-full flex flex-col gap-1"},_e={class:"flex items-center gap-2"},fe=e("img",{src:R,alt:"mail"},null,-1),xe={class:"dark:text-white font-medium"},ge={class:"w-5/12 max-sm:w-full flex flex-col gap-1"},we={class:"flex items-center gap-2"},ve=e("img",{src:D,alt:"phone"},null,-1),be={class:"dark:text-white font-medium"},$e={class:"flex flex-wrap items-center gap-x-10 max-sm:gap-y-4 max-sm:flex-col mb-6"},ye={class:"w-5/12 max-sm:w-full flex flex-col gap-1"},ke={class:"flex items-center gap-2"},Ve=e("img",{src:P,alt:"password"},null,-1),Ce={class:"dark:text-white font-medium"},Ue={class:"w-5/12 max-sm:w-full flex flex-col gap-1"},je={class:"flex items-center gap-2"},Me=e("img",{src:re,alt:"pasport"},null,-1),Se={class:"dark:text-white font-medium"},Le={class:"flex flex-wrap items-center gap-x-10 max-sm:gap-y-4 max-sm:flex-col mb-6"},Ee={class:"w-5/12 max-sm:w-full"},Be={class:"flex items-center gap-2"},Ae=e("img",{src:de,alt:"salary"},null,-1),De={class:"dark:text-white font-medium"},Te={class:"w-5/12 max-sm:w-full"},Re={class:"mb-2 font-bold"},He=["value"],ze={class:"flex items-center justify-around gap-x-10 mb-6 pt-8 mt-8 border-t"},We={class:"w-full"},Oe={class:"font-bold text-lg"},Ge={class:"flex flex-wrap mt-4 gap-2"},Ne={class:"flex flex-wrap gap-y-3 items-center justify-center gap-x-10 max-sm:flex-col"},Pe=j({__name:"UserChange",props:{userEdit:{type:Object,default:()=>{}},showChange:Boolean},emits:["showChange"],setup(r,{emit:w}){const u=C(),p=T(),l=C(),k=H(),V=w,o=U({...r.userEdit}),b=async()=>{try{await u.update_user({user:o.value,id:o.value.id}),o.value.permissions!==u.user.permissions&&await u.change_permissions({permissions:o.value.permissions.filter(d=>d.value).map(d=>d.id),id:o.value.id}),V("showChange"),await l.loadUser({id:k.params.slug})}catch{le.error("Ошибка при обновлении пользователя или прав",{autoClose:1500,theme:"auto"})}};return(d,a)=>{var g;return c(),h("form",{onSubmit:ee(b,["prevent"]),class:"mt-10"},[e("div",me,[e("div",ce,[m(x,{label:d.$t("Имя"),placeholder:s(u).user.first_name,modelValue:s(o).first_name,"onUpdate:modelValue":a[0]||(a[0]=n=>s(o).first_name=n)},null,8,["label","placeholder","modelValue"])]),e("div",ue,[m(x,{label:d.$t("Фамилия"),placeholder:s(u).user.last_name,modelValue:s(o).last_name,"onUpdate:modelValue":a[1]||(a[1]=n=>s(o).last_name=n)},null,8,["label","placeholder","modelValue"])])]),e("div",he,[e("div",pe,[e("div",_e,[fe,e("p",xe,t(d.$t("Почта"))+": ",1)]),m(x,{placeholder:s(u).user.email,modelValue:s(o).email,"onUpdate:modelValue":a[2]||(a[2]=n=>s(o).email=n)},null,8,["placeholder","modelValue"])]),e("div",ge,[e("div",we,[ve,e("p",be,t(d.$t("Номер телефона"))+": ",1)]),m(x,{type:"tel",placeholder:s(u).user.phone,modelValue:s(o).phone,"onUpdate:modelValue":a[3]||(a[3]=n=>s(o).phone=n)},null,8,["placeholder","modelValue"])])]),e("div",$e,[e("div",ye,[e("div",ke,[Ve,e("p",Ce,t(d.$t("Пароль"))+": ",1)]),m(x,{type:"password",placeholder:s(u).user.password,modelValue:s(o).password,"onUpdate:modelValue":a[4]||(a[4]=n=>s(o).password=n)},null,8,["placeholder","modelValue"])]),e("div",Ue,[e("div",je,[Me,e("p",Se,t(d.$t("Паспорт"))+": ",1)]),m(x,{placeholder:s(u).user.passport,modelValue:s(o).passport,"onUpdate:modelValue":a[5]||(a[5]=n=>s(o).passport=n)},null,8,["placeholder","modelValue"])])]),e("div",Le,[e("div",Ee,[e("div",Be,[Ae,e("p",De,t(d.$t("Заработная плата"))+": ",1)]),m(x,{modelValue:s(o).salary,"onUpdate:modelValue":a[6]||(a[6]=n=>s(o).salary=n)},null,8,["modelValue"])]),e("div",Te,[e("p",Re,t(d.$t("Департаменты")),1),X(e("select",{class:"w-full text-black rounded-3xl p-2.5 bg-whiteSmoke border dark:bg-gray-300 dark:border-none outline-semiCyan outline-1","onUpdate:modelValue":a[7]||(a[7]=n=>s(o).department.id=n)},[(c(!0),h(E,null,B((g=s(p))==null?void 0:g.get_all_department.results,n=>(c(),h("option",{value:n.id},t(n.name),9,He))),256))],512),[[Y,s(o).department.id]])])]),e("div",ze,[e("div",We,[e("p",Oe,t(d.$t("Возможности")),1),e("div",Ge,[(c(!0),h(E,null,B(s(o).permissions,n=>(c(),v(oe,{item:n},null,8,["item"]))),256))])])]),e("div",Ne,[m(y,{class:"w-4/12 max-sm:w-full rounded-full flex items-center justify-center !text-black hover:!bg-gray-200 gap-3 py-2 !bg-porcelain !border transition-all ease-in-out duration-300",t:"button",onClick:a[8]||(a[8]=n=>d.$emit("showChange"))},{default:_(()=>[f(t(d.$t("Отменить")),1)]),_:1}),m(y,{class:"w-4/12 max-sm:w-full rounded-full flex items-center justify-center !text-black hover:!shadow-golden gap-3 py-2 !bg-golden !border transition-all ease-in-out duration-300",t:"submit",type:"success"},{default:_(()=>[f(t(d.$t("Изменить")),1)]),_:1})])],32)}}}),Ze={class:"flex items-center gap-4 max-sm:flex-col max-sm:items-start"},Ie=e("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M15 8H1M1 8L8 15M1 8L8 1",stroke:"#7D7D7D","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),qe={class:"flex items-center flex-wrap gap-x-3"},Fe=e("div",null,[e("svg",{width:"6",height:"12",viewBox:"0 0 6 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M4.032 0.48H5.24L2.168 12H0.96L4.032 0.48Z",fill:"#1E1E1E"})])],-1),Je={class:"mt-8 flex items-center gap-4 justify-between max-[680px]:flex-col max-[680px]:items-start max-[680px]:gap-5"},Qe={class:"dark:text-white text-3xl font-bold"},Ke={class:"flex items-center gap-3 max-sm:flex-col max-sm:items-start"},Xe={class:"dark:text-white"},Ye={class:"flex items-center gap-2"},es={class:"dark:text-white text-mediumGray"},ss={class:"dark:text-white text-mediumGray"},ts={class:"my-10 grid grid-cols-3 max-[1150px]:!grid-cols-1 gap-5"},os={class:"bg-white p-6 rounded-3xl"},ls={class:"border rounded-full px-3 py-2 w-fit flex items-center gap-3"},as=e("img",{src:G,alt:"profile"},null,-1),is={class:"dark:text-white"},ns={class:"my-6 mx-auto flex flex-col"},rs={key:0,class:"flex flex-col items-center gap-y-2"},ds={class:"flex flex-col justify-center items-center gap-y-2"},ms={key:1,class:"flex flex-col"},cs={class:"flex text-gray-600 gap-x-2 border-b pb-6"},us=["src"],hs={class:"my-2 mx-2"},ps={class:"text-md font-bold dark:text-white select-none"},_s={class:"dark:text-white text-sm text-mediumGray"},fs={key:3,class:"flex flex-col gap-4 w-full h-fit mt-6"},xs={class:"text-sm flex items-center justify-between"},gs={class:"flex items-center gap-2"},ws=e("img",{src:R,alt:"mail"},null,-1),vs={class:"dark:text-white font-bold"},bs=["href"],$s={class:"text-sm flex items-center justify-between"},ys={class:"flex items-center gap-2"},ks=e("img",{src:ae,alt:"post"},null,-1),Vs={class:"dark:text-white font-bold"},Cs={key:0,class:"dark:text-white"},Us={key:1,class:"dark:text-white"},js={class:"text-sm flex items-center justify-between"},Ms={class:"flex items-center gap-2"},Ss=e("img",{src:D,alt:"phone"},null,-1),Ls={class:"dark:text-white font-bold"},Es=["href"],Bs={class:"text-sm flex items-center justify-between"},As={class:"flex items-center gap-2"},Ds=e("img",{src:ie,alt:"stag"},null,-1),Ts={class:"dark:text-white font-bold"},Rs={class:"flex items-center gap-x-2 hover:underline"},Hs={class:"col-span-2 bg-white p-6 rounded-3xl"},zs={class:"border rounded-full px-3 py-2 w-fit flex items-center gap-3 mb-8"},Ws=e("img",{src:N,alt:"statistic"},null,-1),Os={class:"dark:text-white"},Gs={class:"bg-white p-6 rounded-3xl"},Ns={class:"border rounded-full px-3 py-2 w-fit flex items-center gap-3 mb-8"},Ps=e("img",{src:Z,alt:"info"},null,-1),Zs={class:"dark:text-white"},Is={class:"flex flex-col gap-4 w-full"},qs={class:"text-sm flex items-center justify-between"},Fs={class:"dark:text-white font-bold"},Js={class:"flex items-center gap-x-2 hover:underline"},Qs={class:"text-sm flex items-center justify-between"},Ks={class:"dark:text-white font-bold"},Xs={class:"flex items-center gap-x-2 hover:underline"},Ys={class:"fixed flex gap-x-4 bottom-6 left-1/2 -translate-x-1/2"},et=e("svg",{class:"absolute top-3 right-2.5",width:"25",height:"25",viewBox:"0 -0.05 20.109 20.109",xmlns:"http://www.w3.org/2000/svg"},[e("g",{class:"stroke-black",id:"edit-user",transform:"translate(-2 -2)"},[e("path",{id:"primary",d:"M20.71,16.09,15.8,21H13V18.2l4.91-4.91a1,1,0,0,1,1.4,0l1.4,1.4A1,1,0,0,1,20.71,16.09ZM11,3a4,4,0,1,0,4,4A4,4,0,0,0,11,3Z",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"}),e("path",{id:"primary-2","data-name":"primary",d:"M11,15H8a5,5,0,0,0-5,5,1,1,0,0,0,1,1H9",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"})])],-1),st=[et],tt=e("svg",{class:"absolute top-3 right-2 fill-redOrange",height:"26px",width:"26px",version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 473 473","xml:space":"preserve"},[e("g",null,[e("path",{d:`M324.285,215.015V128h20V38h-98.384V0H132.669v38H34.285v90h20v305h161.523c23.578,24.635,56.766,40,93.477,40\r
              c71.368,0,129.43-58.062,129.43-129.43C438.715,277.276,388.612,222.474,324.285,215.015z M294.285,215.015\r
              c-18.052,2.093-34.982,7.911-50,16.669V128h50V215.015z M162.669,30h53.232v8h-53.232V30z M64.285,68h250v30h-250V68z M84.285,128\r
              h50v275h-50V128z M164.285,403V128h50v127.768c-21.356,23.089-34.429,53.946-34.429,87.802c0,21.411,5.231,41.622,14.475,59.43\r
              H164.285z M309.285,443c-54.826,0-99.429-44.604-99.429-99.43s44.604-99.429,99.429-99.429s99.43,44.604,99.43,99.429\r
              S364.111,443,309.285,443z`}),e("polygon",{points:`342.248,289.395 309.285,322.358 276.323,289.395 255.11,310.608 288.073,343.571 255.11,376.533 276.323,397.746\r
              309.285,364.783 342.248,397.746 363.461,376.533 330.498,343.571 363.461,310.608 	`})])],-1),ot=[tt],lt={class:"text-center font-bold max-sm:w-9/12 max-sm:mx-auto"},at={class:"text-center text-lg max-sm:text-sm w-7/12 mx-auto my-10 dark:text-white break-words max-sm:w-full"},it={class:"font-bold text-red-500"},nt={class:"flex justify-center gap-3 max-sm:flex-col"},rt={class:"text-center font-bold max-sm:w-9/12 max-sm:mx-auto"},Mt=j({__name:"[slug]",props:{userEdit:{type:Object,default:()=>({})},showWarning:Boolean,showChange:Boolean,activeImg:Boolean},setup(r){const w=z(),u=T(),p=I(),l=C(),k=W();function V(){k.back()}return se(()=>{var i,o;l.loadUser({id:w.params.slug}),((i=p.user.role)==null?void 0:i.name_en)==="company_admin"||((o=p.user.role)==null?void 0:o.name_en)==="admin"?(u.loadDepartmentList(),l.loadPermissions()):p.user.role_en==="admin"&&u.loadCompanyList({page:1,limit:1e5,query:""})}),te(()=>{O({title:`${l.user.first_name+" "+l.user.last_name}`})}),(i,o)=>{var b,d;return c(),h("div",null,[e("div",Ze,[e("button",{onClick:V,class:"px-6 py-2 rounded-[30px] border-2 font-bold text-mediumGray bg-white flex items-center gap-2"},[Ie,f(" "+t(i.$t("Назад")),1)]),e("div",qe,[m(M,{"breadcrumb-link":"/base/users"},{default:_(()=>[f(t(i.$t("Компания")),1)]),_:1}),Fe,m(M,null,{default:_(()=>[f(t(s(l).user.first_name+" "+s(l).user.last_name),1)]),_:1})])]),e("div",Je,[e("p",Qe,t(i.$t("Профиль пользователя")),1),e("div",Ke,[e("p",Xe,t(i.$t("Последняя активность")),1),e("div",Ye,[e("p",es,t(new Date().toLocaleDateString()),1),e("p",ss,t(new Date().toLocaleTimeString()),1)])])]),e("div",ts,[e("div",os,[e("div",ls,[as,e("h2",is,t(i.$t("Информация")),1)]),e("div",ns,[s(l).user.id?(c(),h("div",ms,[e("div",cs,[e("img",{class:"block w-[60px] h-[60px] border-2 border-golden rounded-full shadow-lg dark:shadow-none",src:s(l).user.photo,alt:"logo"},null,8,us),e("div",hs,[e("h3",ps,t(s(l).user.first_name)+" "+t(s(l).user.last_name),1),e("p",_s,t(Math.trunc((new Date-new Date(s(p).user.date_of_birth))/1e3/3600/24/365)+" лет"),1)])])])):(c(),h("div",rs,[m($,{width:"5rem",height:"5rem","border-radius":"100%"}),e("div",ds,[m($,{width:"150px",height:"20px","border-radius":"20px"}),m($,{width:"130px",height:"15px","border-radius":"20px"})])])),s(l).user.id?(c(),h("div",fs,[e("div",xs,[e("div",gs,[ws,e("p",vs,t(i.$t("Email"))+": ",1)]),e("a",{href:`mailto:${s(l).user.email}`,class:"cursor-pointer hover:text-blueSemiLight hover:underline dark:hover:text-gray-200"},t(s(l).user.email),9,bs)]),e("div",$s,[e("div",ys,[ks,e("p",Vs,t(i.$t("Должность"))+": ",1)]),s(p).user.role_en==="admin"?(c(),h("p",Cs,t(s(l).user.role)+" "+t(s(l).user.position),1)):(c(),h("p",Us,t(s(l).user.position),1))]),e("div",js,[e("div",Ms,[Ss,e("p",Ls,t(i.$t("Телефон"))+": ",1)]),e("a",{class:"flex items-center gap-x-2 hover:underline",href:`tel:${s(l).user.phone}`},[e("p",null,t(s(l).user.phone),1)],8,Es)]),e("div",Bs,[e("div",As,[Ds,e("p",Ts,t(i.$t("Стаж"))+": ",1)]),e("p",Rs,t(s(l).user.phone),1)])])):(c(),v($,{key:2,class:"my-2",width:"150px",height:"15px","border-radius":"20px"}))])]),e("div",Hs,[e("div",zs,[Ws,e("h2",Os,t(i.$t("Личная статистика")),1)]),e("div",null,[m(ne)])]),e("div",Gs,[e("div",Ns,[Ps,e("h2",Zs,t(i.$t("Информация  о отделе")),1)]),e("div",Is,[e("div",qs,[e("p",Fs,t(i.$t("Департамент"))+": ",1),e("p",Js,t((b=s(l).user.department)==null?void 0:b.name),1)]),e("div",Qs,[e("p",Ks,t(i.$t("Руководитель"))+": ",1),e("p",Xs,t((d=s(l).user.department)==null?void 0:d.name),1)])])])]),e("div",Ys,[e("button",{onClick:o[0]||(o[0]=a=>{r.showChange=!r.showChange,r.userEdit={...s(l).user},r.userEdit.permissions=s(l).get_permission_list.map(g=>(g.value=r.userEdit.permissions.filter(n=>n.id==g.id).length!=0,g))}),"on:showModal":o[1]||(o[1]=a=>{r.showChange=!0}),class:"w-12 h-12 bg-white border hover:transition-all duration-200 hover:scale-95 rounded-xl relative"},st,32),e("button",{onClick:o[2]||(o[2]=a=>r.showWarning=!r.showWarning),class:"w-12 h-12 bg-white border hover:transition-all duration-200 hover:scale-95 rounded-xl relative"},ot),r.showWarning?(c(),v(S,{key:0,onShowModal:o[5]||(o[5]=a=>{r.showWarning=!r.showWarning})},{default:_(()=>[e("p",lt,t(i.$t("Вы действительно хотите удалить пользователя?")),1),e("p",at,[e("span",it,t(i.$t("Предупреждение")),1),f(": "+t(i.$t("после удаления данного пользователя вся информация пропадёт и не будет подлежать восстановлению")),1)]),e("div",nt,[m(y,{class:"w-4/12 max-sm:w-full rounded-full flex items-center justify-center !text-black hover:!bg-gray-200 gap-3 py-2 !bg-porcelain !border transition-all ease-in-out duration-300",t:"button",onClick:o[3]||(o[3]=a=>r.showWarning=!1)},{default:_(()=>[f(t(i.$t("Отменить")),1)]),_:1}),m(y,{class:"w-4/12 max-sm:w-full rounded-full flex items-center justify-center !text-white gap-3 py-2 !bg-redOrange !border transition-all ease-in-out duration-300",t:"submit",onClick:o[4]||(o[4]=a=>s(l).deleteUser({user_id:s(l).user.id},i.$router))},{default:_(()=>[f(t(i.$t("Удалить")),1)]),_:1})])]),_:1})):A("",!0),r.showChange?(c(),v(S,{key:1,onShowModal:o[7]||(o[7]=a=>r.showChange=!r.showChange)},{default:_(()=>[e("p",rt,t(i.$t("Редактирование пользователя")),1),m(Pe,{"user-edit":r.userEdit,onShowChange:o[6]||(o[6]=a=>r.showChange=!1)},null,8,["user-edit"])]),_:1})):A("",!0)])])}}});export{Mt as default};
