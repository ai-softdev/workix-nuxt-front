import{_ as G}from"./nuxt-link.C5n4ipTb.js";import{g as I,o as d,c as m,a as e,t as s,n as N,p as z,e as O,m as J,J as X,l as E,Y,z as q,d as c,b as u,w as r,h as t,F as y,r as $,i as _,j as C,x as B,T as K,E as Q,G as W,y as ee}from"./entry.BZGj2_QE.js";import{u as te}from"./index.CPkfy7ml.js";import{u as se}from"./tasks.CRj_IUAK.js";import{u as oe}from"./auth.CsVxvdSr.js";import{u as ae}from"./companies.C24PrRp1.js";import{_ as U}from"./TheTextContent.vue.AymrMYI2.js";import{_ as P}from"./TheBreadcrumbs.vue.Btpr_46o.js";import{_ as w}from"./TheButton.vue.CfQsQbrj.js";import{_ as j}from"./TheModal.vue.BmiMYGjH.js";import{_ as R}from"./_plugin-vue_export-helper.DlAUqK2U.js";import"./nuxt-storage.B0R7N1yK.js";const le=""+globalThis.__publicAssetsURL("icons/author.svg"),ie=""+globalThis.__publicAssetsURL("icons/ispolniteli.svg"),ne=""+globalThis.__publicAssetsURL("icons/sroki.svg"),re=i=>(z("data-v-30216c86"),i=i(),O(),i),de={class:"relative z-10 dark:text-white"},ue=["checked"],ce=re(()=>e("span",{class:"checkmark w-full h-full absolute top-0 left-0"},null,-1)),me=I({__name:"TasksUserCheckbox",props:{item:{type:Object,default:()=>{}}},setup(i){return(k,g)=>{var v,o;return d(),m("div",null,[e("label",{class:N(["container w-full relative py-2 px-6 text-black transition-all rounded-lg border",{"bg-blueSemiLight text-white":i.item.value===!0}])},[e("span",de,s(((v=i.item)==null?void 0:v.first_name)+" "+((o=i.item)==null?void 0:o.last_name)),1),e("input",{type:"checkbox",onChange:g[0]||(g[0]=b=>i.item.value=!i.item.value),checked:i.item.value},null,40,ue),ce],2)])}}}),he=R(me,[["__scopeId","data-v-30216c86"]]),x=i=>(z("data-v-b4783328"),i=i(),O(),i),pe={class:"overflow-hidden"},fe={class:"flex items-center gap-4 max-sm:flex-col max-sm:items-start"},_e=x(()=>e("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M15 8H1M1 8L8 15M1 8L8 1",stroke:"#7D7D7D","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),we={class:"flex items-center flex-wrap gap-x-3"},ke=x(()=>e("div",null,[e("svg",{width:"6",height:"12",viewBox:"0 0 6 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M4.032 0.48H5.24L2.168 12H0.96L4.032 0.48Z",fill:"#1E1E1E"})])],-1)),xe={class:"dark:text-white text-3xl font-bold my-8"},ge={class:"flex w-full gap-4 max-[1200px]:flex-col"},ve={class:"w-10/12 max-lg:w-full flex flex-col gap-4 max-[1200px]:order-2 max-[1200px]:w-full"},be={class:"p-6 rounded-3xl bg-white shadow-objectDescription"},ye={class:"mb-8"},$e={class:"font-bold mb-4"},Ce={class:"w-full border p-4 bg-whiteSmoke rounded-3xl min-h-[200px]"},je={class:"mb-8"},Se={class:"font-bold mb-4"},Me={class:"w-full flex border border-dashed p-4 rounded-3xl"},De=["href","download","title"],Ve=x(()=>e("div",{class:"w-9 h-9 rounded-lg bg-white shadow flex items-center justify-center"},[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M14 2.26953V6.40007C14 6.96012 14 7.24015 14.109 7.45406C14.2049 7.64222 14.3578 7.7952 14.546 7.89108C14.7599 8.00007 15.0399 8.00007 15.6 8.00007H19.7305M16 13H8M16 17H8M10 9H8M14 2H8.8C7.11984 2 6.27976 2 5.63803 2.32698C5.07354 2.6146 4.6146 3.07354 4.32698 3.63803C4 4.27976 4 5.11984 4 6.8V17.2C4 18.8802 4 19.7202 4.32698 20.362C4.6146 20.9265 5.07354 21.3854 5.63803 21.673C6.27976 22 7.11984 22 8.8 22H15.2C16.8802 22 17.7202 22 18.362 21.673C18.9265 21.3854 19.3854 20.9265 19.673 20.362C20 19.7202 20 18.8802 20 17.2V8L14 2Z",stroke:"#2A2A2A","stroke-width":"1.6","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),Te={class:""},He={key:0,class:"w-full text-center mb-4 min-h-[100px]"},Le={class:"flex items-center justify-between max-[756px]:flex-col max-[756px]:gap-4"},Ae={class:"text-md text-mediumGray"},Ee=x(()=>e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M15.5556 6.33388V5.62276C15.5556 4.62712 15.5556 4.12929 15.3618 3.749C15.1914 3.41449 14.9194 3.14252 14.5849 2.97209C14.2046 2.77832 13.7068 2.77832 12.7111 2.77832H11.2889C10.2932 2.77832 9.79541 2.77832 9.41513 2.97209C9.08061 3.14252 8.80865 3.41449 8.63821 3.749C8.44444 4.12929 8.44444 4.62712 8.44444 5.62276V6.33388M10.2222 11.2228V15.6672M13.7778 11.2228V15.6672M4 6.33388H20M18.2222 6.33388V16.2894C18.2222 17.7829 18.2222 18.5296 17.9316 19.1001C17.6759 19.6019 17.268 20.0098 16.7662 20.2654C16.1957 20.5561 15.4491 20.5561 13.9556 20.5561H10.0444C8.55097 20.5561 7.80423 20.5561 7.2338 20.2654C6.73204 20.0098 6.32409 19.6019 6.06843 19.1001C5.77778 18.5296 5.77778 17.7829 5.77778 16.2894V6.33388",stroke:"currentColor","stroke-width":"1.6","stroke-linecap":"round","stroke-linejoin":"round"})],-1)),Be={class:"w-4/12 h-fit flex flex-col gap-5 max-[1200px]:w-full"},Ue={class:"p-6 rounded-3xl bg-white shadow-objectDescription"},Pe={class:"border rounded-full mx-auto px-3 py-2 w-fit flex items-center gap-3 mb-6"},Ie=x(()=>e("img",{src:le,alt:"author"},null,-1)),Ne={class:"dark:text-white"},ze={class:"bg-whiteSmoke py-2 px-4 rounded-full w-fit mx-auto"},Oe={class:"p-6 rounded-3xl bg-white shadow-objectDescription"},Re={class:"border rounded-full mx-auto px-3 py-2 w-fit flex items-center gap-3 mb-6"},Ze=x(()=>e("img",{src:ie,alt:"ispolniteli"},null,-1)),Fe={class:"dark:text-white"},Ge={class:"mt-2"},Je={class:"text-center font-medium"},Xe={class:"w-8 h-8 rounded-full shadow flex items-center justify-center bg-white"},Ye=["src"],qe={class:"mt-4"},Ke={class:"text-center font-medium"},Qe={key:0,class:"mt-4 flex gap-x-6 justify-around"},We={class:"mt-4 flex flex-col max-lg:w-full max-lg:gap-x-4 max-h-[500px] h-full gap-y-4 overflow-y-auto px-2"},et={class:"flex relative items-center p-2 gap-x-6 bg-whiteSmoke rounded-3xl max-[1200px]:w-fit max-[1200px]:mx-auto"},tt={class:"w-8 h-8 rounded-full shadow flex items-center justify-center bg-white"},st=["src"],ot={class:"flex items-center"},at={key:0,class:"absolute cursor-pointer dark:stroke-white stroke-black right-0 px-2 py-1 hover:bg-red-400 max-sm:hidden transition-all duration-200 rounded-l-lg hover:stroke-white",name:"fade"},lt=["onClick"],it=ee('<svg width="40px" height="40px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-b4783328><path d="M10 11V17" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" data-v-b4783328></path><path d="M14 11V17" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" data-v-b4783328></path><path d="M4 7H20" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" data-v-b4783328></path><path d="M6 7H12H18V18C18 19.6569 16.6569 21 15 21H9C7.34315 21 6 19.6569 6 18V7Z" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" data-v-b4783328></path><path d="M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 5V7H9V5Z" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" data-v-b4783328></path></svg>',1),nt=[it],rt={key:1,class:"absolute cursor-pointer dark:stroke-white stroke-black right-0 top-0 px-2 py-1 bg-red-400 hidden max-sm:block transition-all duration-200 rounded-tr-lg rounded-l-lg hover:stroke-white",name:"fade"},dt=["onClick"],ut=x(()=>e("p",null,"X",-1)),ct=[ut],mt={class:"p-6 rounded-3xl bg-white shadow-objectDescription"},ht={class:"border rounded-full mx-auto px-3 py-2 w-fit flex items-center gap-3 mb-6"},pt=x(()=>e("img",{src:ne,alt:"sroki"},null,-1)),ft={class:"dark:text-white"},_t={class:"mt-2 flex flex-col items-center gap-4"},wt={class:"flex items-center gap-2"},kt={class:"bg-whiteSmoke p-3 rounded-full"},xt={class:"flex items-center gap-2"},gt={class:"bg-whiteSmoke p-3 rounded-full"},vt={key:0,class:"flex flex-wrap gap-y-4 justify-center mb-10 gap-x-4"},bt={class:"flex flex-wrap max-md:justify-center gap-x-4 gap-y-4 my-6"},yt=["onClick"],$t={class:"flex flex-wrap max-md:justify-center items-center gap-x-4 gap-y-4 my-6"},Ct={class:"flex justify-center gap-x-10"},jt={class:"mb-4"},St={class:"flex justify-center gap-x-10"},Mt={class:"font-bold text-3xl text-center mt-12"},Dt={class:"text-redOrange mt-8 text-center"},Vt={class:"text-center mt-2"},Tt={class:"flex items-center justify-between mt-6 gap-3"},Ht=I({__name:"[id]",props:{showCancelError:{type:Boolean,default:!1},showAddPerformer:{type:Boolean,default:!1},showDeleteTask:{type:Boolean,default:!1},model_value:{type:Object,default:()=>{}}},setup(i){const k=oe(),g=J(),v=X(),o=se(),b=ae();b.loadDepartmentList();const p=E({});E({}),Y(()=>{o.loadCurrentTask({id:g.params.id})}),q(()=>{te({title:`${o.task.title}`})});function Z(){v.back()}return(l,n)=>{var M,D,V,T,H,L,A;const S=G;return d(),m("div",pe,[e("div",fe,[e("button",{onClick:Z,class:"px-6 py-2 rounded-[30px] border-2 font-bold text-mediumGray bg-white flex items-center gap-2"},[_e,c(" "+s(l.$t("Назад")),1)]),e("div",we,[u(P,{"breadcrumb-link":"/base/tasks"},{default:r(()=>[c(s(l.$t("Список заданий")),1)]),_:1}),ke,u(P,null,{default:r(()=>[c(s(t(o).task.title),1)]),_:1})])]),e("p",xe,s(l.$t("Описание задания")),1),e("div",ge,[e("div",ve,[e("div",be,[e("div",ye,[e("p",$e,s(l.$t("Описание")),1),e("div",Ce,s(t(o).task.description),1)]),e("div",je,[e("p",Se,s(l.$t("Прикреплённые файлы")),1),e("div",Me,[(d(!0),m(y,null,$((M=t(o).task)==null?void 0:M.task_files,a=>{var h;return d(),m("a",{class:"flex items-center gap-2 bg-whiteSmoke p-3 rounded-2xl hover:shadow",href:a.file,download:a.file_name,title:a.file_name},[Ve,e("p",Te,s(((h=a.file_name)==null?void 0:h.length)>10?a.file_name.slice(0,10)+"...":a.file_name),1)],8,De)}),256)),((D=t(o).task.task_files)==null?void 0:D.length)===0?(d(),m("div",He,[e("p",null,s(l.$t("Файлы отсутствуют")),1)])):_("",!0)])])]),e("div",Le,[e("p",Ae,s(l.$t("Последние изменения")+" "+new Date(t(o).task.updated_at).toLocaleDateString()+", "+new Date(t(o).task.updated_at).toLocaleTimeString()),1),e("button",{class:"flex items-center gap-3 rounded-full border py-2.5 px-10 font-bold text-redOrange hover:text-white hover:bg-redOrange transition-all ease-in-out duration-300",onClick:n[0]||(n[0]=a=>i.showDeleteTask=!0)},[Ee,c(" "+s(l.$t("Удалить задание")),1)])])]),e("div",Be,[e("div",Ue,[e("div",Pe,[Ie,e("h2",Ne,s(l.$t("Автор задания")),1)]),e("div",ze,s(((T=(V=t(o).task)==null?void 0:V.author)==null?void 0:T.first_name)+" "+((L=(H=t(o).task)==null?void 0:H.author)==null?void 0:L.last_name)),1)]),e("div",Oe,[e("div",Re,[Ze,e("h2",Fe,s(l.$t("Исполнители")),1)]),e("div",Ge,[e("p",Je,s(l.$t("Главный исполнитель")),1),u(S,{to:`/base/users/${(A=t(o).task.main_performer)==null?void 0:A.id}`,class:"flex mt-2 items-center gap-2 bg-whiteSmoke rounded-3xl p-2 max-[1200px]:w-fit max-[1200px]:mx-auto"},{default:r(()=>{var a,h,f;return[e("div",Xe,[e("img",{class:"w-4 h-4 rounded-full",src:(a=t(o).task.main_performer)==null?void 0:a.photo,alt:"logo"},null,8,Ye)]),e("p",null,s(((h=t(o).task.main_performer)==null?void 0:h.first_name)+" "+((f=t(o).task.main_performer)==null?void 0:f.last_name)),1)]}),_:1},8,["to"])]),e("div",qe,[e("p",Ke,s(l.$t("Список исполнителей")),1),t(o).task.status==="performing"&&t(o).task.author_id===t(k).user.id?(d(),m("div",Qe,[u(w,{class:"w-6/12 dark:hover:bg-gray-500 hover:bg-gray-300 !text-black dark:!text-white rounded-full border dark:border-gray-500 transition-all duration-200",onClick:n[1]||(n[1]=a=>{i.showAddPerformer=!0,t(p).department.participants=t(b).get_all_department.participants.map(h=>{var f;h.value=((f=t(p).participants)==null?void 0:f.filter(F=>F.id==h.id).length)!=0})})},{default:r(()=>[c(s(l.$t("Добавить")),1)]),_:1})])):_("",!0),e("div",We,[(d(!0),m(y,null,$(t(o).task.performers,a=>(d(),m("div",et,[u(S,{to:`/base/users/${a.id}`,class:"w-11/12 flex items-center gap-x-4 max-[1200px]:!w-fit max-[1200px]:mx-auto"},{default:r(()=>[e("div",tt,[e("img",{class:"w-4 h-4 rounded-full",src:a==null?void 0:a.photo,alt:"logo"},null,8,st)]),e("p",ot,s(a.last_name.slice(0,1)+". "+a.first_name),1)]),_:2},1032,["to"]),t(o).task.status==="performing"&&t(o).task.author_id===t(k).user.id?(d(),m("div",at,[e("div",{onClick:h=>t(o).deleteUser_task({id:t(o).task.id,user_id:a.id})},nt,8,lt)])):_("",!0),t(o).task.status==="performing"&&t(o).task.author_id===t(k).user.id?(d(),m("div",rt,[e("div",{onClick:h=>t(o).deleteUser_task({id:t(o).task.id,user_id:a.id})},ct,8,dt)])):_("",!0)]))),256))])])]),e("div",mt,[e("div",ht,[pt,e("h2",ft,s(l.$t("Сроки")),1)]),e("div",_t,[e("div",wt,[e("p",null,s(l.$t("Начало срока:")),1),e("div",kt,s(new Date(t(o).task.created_at).toLocaleDateString()),1)]),e("div",xt,[e("p",null,s(l.$t("Конец срока:")),1),e("div",gt,s(new Date(t(o).task.deadline).toLocaleDateString()),1)])])])])]),t(o).task.status==="watching"&&t(o).task.author_id===t(k).user.id?(d(),m("div",vt,[u(w,{class:"px-10 py-2 rounded-full",type:"danger",onClick:n[2]||(n[2]=a=>i.showCancelError=!0)},{default:r(()=>[c(s(l.$t("Отклонить")),1)]),_:1}),u(w,{class:"px-10 py-2 rounded-full",type:"success",onClick:n[3]||(n[3]=a=>t(o).change_taskStatus({id:t(o).task.id,task_status:"make-completed"}))},{default:r(()=>[c(s(l.$t("Подтвердить")),1)]),_:1})])):_("",!0),i.showAddPerformer?(d(),C(j,{key:1,onShowModal:n[6]||(n[6]=a=>i.showAddPerformer=!i.showAddPerformer)},{default:r(()=>[u(U,null,{default:r(()=>[c(s(l.$t("Добавление Исполнителей")),1)]),_:1}),t(k).user.role_en==="company_admin"||t(k).user.role_en==="director"||t(k).user.role_en==="vice_director"?(d(),m("form",{key:0,class:"mt-6",onSubmit:n[5]||(n[5]=B(a=>{var h;t(o).addUser_task({id:t(o).task.id,performers:(h=t(p).participants)==null?void 0:h.filter(f=>f.value).map(f=>f.id).join(",")}),i.showAddPerformer=!1},["prevent"]))},[e("div",null,[e("p",null,s(l.$t("Выберите департамент")),1),e("div",bt,[(d(!0),m(y,null,$(t(b).get_all_department.results,a=>(d(),m("div",{class:N(["border cursor-pointer px-4 py-2 rounded-lg transition-all duration-200",{"dark:bg-gray-500 bg-gray-200":t(p)===a}]),onClick:h=>p.value=a},s(a.name),11,yt))),256))])]),e("div",null,[e("p",null,s(l.$t("Выберите исполнителей")),1),u(K,{name:"left-fade"},{default:r(()=>[e("div",$t,[(d(!0),m(y,null,$(t(p).participants,a=>(d(),C(he,{item:a},null,8,["item"]))),256))])]),_:1})]),e("div",Ct,[u(w,{class:"w-3/12 max-md:w-6/12 rounded-full py-2",type:"danger",onClick:n[4]||(n[4]=a=>i.showAddPerformer=!1)},{default:r(()=>[c(s(l.$t("Отменить")),1)]),_:1}),u(w,{class:"w-3/12 max-md:w-6/12 rounded-full py-2",type:"success"},{default:r(()=>[c(s(l.$t("Добавить")),1)]),_:1})])],32)):_("",!0)]),_:1})):_("",!0),i.showCancelError?(d(),C(j,{key:2,class:"!w-[200px]",onShowModal:n[10]||(n[10]=a=>i.showCancelError=!i.showCancelError)},{default:r(()=>[u(U,null,{default:r(()=>[c(s(l.$t("Предупреждение")),1)]),_:1}),e("form",{onSubmit:n[9]||(n[9]=B(a=>{t(o).change_taskStatus({task_status:"make-rejected",id:t(o).task.id,comment:t(p).comment}),i.showCancelError=!1},["prevent"])),class:"mt-10"},[e("div",null,[e("p",jt,s(l.$t("Опишите причину отклонения")),1),Q(e("textarea",{class:"w-full resize-none h-[300px] p-4 border dark:border-none rounded-lg","onUpdate:modelValue":n[7]||(n[7]=a=>t(p).comment=a)},null,512),[[W,t(p).comment]])]),e("div",St,[u(w,{class:"py-2 w-2/12 rounded-full",type:"danger",onClick:n[8]||(n[8]=a=>i.showCancelError=!1)},{default:r(()=>[c(s(l.$t("Отмена")),1)]),_:1}),u(w,{class:"py-2 w-2/12 rounded-full",type:"success"},{default:r(()=>[c(s(l.$t("Подтвердить")),1)]),_:1})])],32)]),_:1})):_("",!0),i.showDeleteTask?(d(),C(j,{key:3,onShowModal:n[13]||(n[13]=a=>i.showDeleteTask=!i.showDeleteTask),resizeClass:"!w-4/12 max-[1000px]:!w-11/12"},{default:r(()=>[e("p",Mt,s(l.$t("Вы уверены, что хотите удалить?")),1),e("p",Dt,s(l.$t("Предупреждение!")),1),e("p",Vt,s(l.$t("Удалённые задания не подлежат восстановке")),1),e("div",Tt,[u(w,{class:"w-full rounded-full flex items-center justify-center !text-black hover:bg-gray-200 gap-3 py-2 bg-porcelain border transition-all ease-in-out duration-300",onClick:n[11]||(n[11]=a=>i.showDeleteTask=!1)},{default:r(()=>[c(s(l.$t("Отмена")),1)]),_:1}),u(w,{class:"w-full rounded-full flex items-center justify-center hover:bg-red-700 gap-3 py-2 bg-sunset border !text-white transition-all ease-in-out duration-300",onClick:n[12]||(n[12]=a=>{t(o).delete_task({id:t(o).task.id},l.$router)})},{default:r(()=>[c(s(l.$t("Удалить")),1)]),_:1})])]),_:1})):_("",!0)])}}}),Ft=R(Ht,[["__scopeId","data-v-b4783328"]]);export{Ft as default};
