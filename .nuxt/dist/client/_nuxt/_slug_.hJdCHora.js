import{g as U,l as C,o as c,j as v,h as s,c9 as z,c as p,a as e,b as m,t as o,E as W,ae as O,F as j,r as S,w as f,d as _,x as F,m as G,J as N,C as P,Y,B as Z,i as D}from"./entry.Dos5mvIN.js";import{u as I}from"./index.da1fIcdO.js";import{_ as q,a as J}from"./profile.DK0cVRce.js";import{_ as A,a as Q}from"./password.C9kcH7bG.js";import{_ as K}from"./info.N2nPQJQx.js";import{u as V}from"./users.dTUL9f1E.js";import{u as X}from"./auth.aqacddpH.js";import{u as T}from"./companies.CkXOzTuB.js";import{_ as L}from"./TheBreadcrumbs.vue.BV7MhFPf.js";import{_ as E}from"./TheModal.vue.D3hlHb3t.js";import{_ as $}from"./TheButton.vue.gJpUNod2.js";import{C as B,A as ee,p as te,a as se,R as oe,P as le}from"./index.DYCGi3Vn.js";import{T as b}from"./TheSceleton.fdqlrxRf.js";import{T as ae}from"./TheCheckbox.BuYVvh0N.js";import{_ as g}from"./TheInput.vue.CR5iM2Pr.js";import{l as ie}from"./nuxt-storage.Df5leMsQ.js";import"./nuxt-link.CfP_OKzb.js";import"./_plugin-vue_export-helper.DlAUqK2U.js";import"./chat.DdCdJX2D.js";const R=""+globalThis.__publicAssetsURL("icons/mail.svg"),ne=""+globalThis.__publicAssetsURL("icons/post.svg"),re=""+globalThis.__publicAssetsURL("icons/stag.svg"),de=U({__name:"TheUserChart",setup(d){B.register(ee,te,se,oe),B.defaults.color="#b6b6b6";const w=C({labels:["Выполненные задания","Выполненные IQ тесты","Активность","Посещаемость"],datasets:[{backgroundColor:["rgba(109,252,118,0.4)","rgba(252,155,0,0.91)","rgba(0,121,255,0.4)","rgba(255,9,0,0.68)"],data:[70,70,90,100]}]}),u=C({responsive:!0,maintainAspectRatio:!1});return(x,l)=>(c(),v(s(le),{class:"text-white",style:{"{color":"white"},data:s(w),options:s(u)},null,8,["data","options"]))}}),me=""+globalThis.__publicAssetsURL("icons/pasport.svg"),ce=""+globalThis.__publicAssetsURL("icons/salary.svg"),ue={class:"flex flex-wrap items-center gap-x-10 max-sm:gap-y-4 max-sm:flex-col mb-6"},he={class:"w-5/12 max-sm:w-full"},pe={class:"w-5/12 max-sm:w-full"},fe={class:"flex flex-wrap items-center gap-x-10 max-sm:gap-y-4 max-sm:flex-col mb-6"},_e={class:"w-5/12 max-sm:w-full flex flex-col gap-1"},xe={class:"flex items-center gap-2"},ge=e("img",{src:R,alt:"mail"},null,-1),we={class:"dark:text-white font-medium"},ve={class:"w-5/12 max-sm:w-full flex flex-col gap-1"},be={class:"flex items-center gap-2"},$e=e("img",{src:A,alt:"phone"},null,-1),ye={class:"dark:text-white font-medium"},ke={class:"flex flex-wrap items-center gap-x-10 max-sm:gap-y-4 max-sm:flex-col mb-6"},Ce={class:"w-5/12 max-sm:w-full flex flex-col gap-1"},Ve={class:"flex items-center gap-2"},Ue=e("img",{src:Q,alt:"password"},null,-1),Me={class:"dark:text-white font-medium"},je={class:"w-5/12 max-sm:w-full flex flex-col gap-1"},Se={class:"flex items-center gap-2"},De=e("img",{src:me,alt:"pasport"},null,-1),Le={class:"dark:text-white font-medium"},Ee={class:"flex flex-wrap items-center gap-x-10 max-sm:gap-y-4 max-sm:flex-col mb-6"},Be={class:"w-5/12 max-sm:w-full"},Ae={class:"flex items-center gap-2"},Te=e("img",{src:ce,alt:"salary"},null,-1),Re={class:"dark:text-white font-medium"},He={class:"w-5/12 max-sm:w-full"},ze={class:"mb-2 font-bold"},We=["value"],Oe={class:"flex items-center justify-around gap-x-10 mb-6 pt-8 mt-8 border-t"},Fe={class:"w-full"},Ge={class:"font-bold text-lg"},Ne={class:"flex flex-wrap mt-4 gap-2"},Pe={class:"flex flex-wrap gap-y-3 items-center justify-center gap-x-10 max-sm:flex-col"},Ye=U({__name:"UserChange",props:{userEdit:{type:Object,default:()=>{}},showChange:Boolean},emits:["showChange"],setup(d,{emit:w}){const u=V(),x=T(),l=V(),y=z(),k=w,t=C({...d.userEdit}),a=async()=>{try{await u.update_user({user:t.value,id:t.value.id}),t.value.permissions!==u.user.permissions&&await u.change_permissions({permissions:t.value.permissions.filter(r=>r.value).map(r=>r.id),id:t.value.id}),k("showChange"),await l.loadUser({id:y.params.slug})}catch{ie.error("Ошибка при обновлении пользователя или прав",{autoClose:1500,theme:"auto"})}};return(r,n)=>{var h;return c(),p("form",{onSubmit:F(a,["prevent"]),class:"mt-10"},[e("div",ue,[e("div",he,[m(g,{label:r.$t("Имя"),placeholder:s(u).user.first_name,modelValue:s(t).first_name,"onUpdate:modelValue":n[0]||(n[0]=i=>s(t).first_name=i)},null,8,["label","placeholder","modelValue"])]),e("div",pe,[m(g,{label:r.$t("Фамилия"),placeholder:s(u).user.last_name,modelValue:s(t).last_name,"onUpdate:modelValue":n[1]||(n[1]=i=>s(t).last_name=i)},null,8,["label","placeholder","modelValue"])])]),e("div",fe,[e("div",_e,[e("div",xe,[ge,e("p",we,o(r.$t("Почта"))+": ",1)]),m(g,{placeholder:s(u).user.email,modelValue:s(t).email,"onUpdate:modelValue":n[2]||(n[2]=i=>s(t).email=i)},null,8,["placeholder","modelValue"])]),e("div",ve,[e("div",be,[$e,e("p",ye,o(r.$t("Номер телефона"))+": ",1)]),m(g,{type:"tel",placeholder:s(u).user.phone,modelValue:s(t).phone,"onUpdate:modelValue":n[3]||(n[3]=i=>s(t).phone=i)},null,8,["placeholder","modelValue"])])]),e("div",ke,[e("div",Ce,[e("div",Ve,[Ue,e("p",Me,o(r.$t("Пароль"))+": ",1)]),m(g,{type:"password",placeholder:s(u).user.password,modelValue:s(t).password,"onUpdate:modelValue":n[4]||(n[4]=i=>s(t).password=i)},null,8,["placeholder","modelValue"])]),e("div",je,[e("div",Se,[De,e("p",Le,o(r.$t("Паспорт"))+": ",1)]),m(g,{placeholder:s(u).user.passport,modelValue:s(t).passport,"onUpdate:modelValue":n[5]||(n[5]=i=>s(t).passport=i)},null,8,["placeholder","modelValue"])])]),e("div",Ee,[e("div",Be,[e("div",Ae,[Te,e("p",Re,o(r.$t("Заработная плата"))+": ",1)]),m(g,{modelValue:s(t).salary,"onUpdate:modelValue":n[6]||(n[6]=i=>s(t).salary=i)},null,8,["modelValue"])]),e("div",He,[e("p",ze,o(r.$t("Департаменты")),1),W(e("select",{class:"w-full text-black rounded-3xl p-2.5 bg-whiteSmoke border dark:bg-gray-300 dark:border-none outline-semiCyan outline-1","onUpdate:modelValue":n[7]||(n[7]=i=>s(t).department.id=i)},[(c(!0),p(j,null,S((h=s(x))==null?void 0:h.get_all_department.results,i=>(c(),p("option",{value:i.id},o(i.name),9,We))),256))],512),[[O,s(t).department.id]])])]),e("div",Oe,[e("div",Fe,[e("p",Ge,o(r.$t("Возможности")),1),e("div",Ne,[(c(!0),p(j,null,S(s(t).permissions,i=>(c(),v(ae,{item:i},null,8,["item"]))),256))])])]),e("div",Pe,[m($,{class:"w-4/12 max-sm:w-full rounded-full flex items-center justify-center !text-black hover:!bg-gray-200 gap-3 py-2 !bg-porcelain !border transition-all ease-in-out duration-300",t:"button",onClick:n[8]||(n[8]=i=>r.$emit("showChange"))},{default:f(()=>[_(o(r.$t("Отменить")),1)]),_:1}),m($,{class:"w-4/12 max-sm:w-full rounded-full flex items-center justify-center !text-black hover:!shadow-golden gap-3 py-2 !bg-golden !border transition-all ease-in-out duration-300",t:"submit",type:"success"},{default:f(()=>[_(o(r.$t("Изменить")),1)]),_:1})])],32)}}}),Ze={class:"flex items-center gap-4 max-sm:flex-col max-sm:items-start"},Ie=e("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M15 8H1M1 8L8 15M1 8L8 1",stroke:"#7D7D7D","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),qe={class:"flex items-center flex-wrap gap-x-3"},Je=e("div",null,[e("svg",{width:"6",height:"12",viewBox:"0 0 6 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M4.032 0.48H5.24L2.168 12H0.96L4.032 0.48Z",fill:"#1E1E1E"})])],-1),Qe={class:"mt-8 flex items-center gap-4 justify-between max-[680px]:flex-col max-[680px]:items-start max-[680px]:gap-5"},Ke={class:"dark:text-white text-3xl font-bold"},Xe={class:"flex items-center gap-3 max-sm:flex-col max-sm:items-start"},et={class:"dark:text-white"},tt={class:"flex items-center gap-2"},st={class:"dark:text-white text-mediumGray"},ot={class:"dark:text-white text-mediumGray"},lt={class:"my-10 grid grid-cols-3 max-[1150px]:!grid-cols-1 gap-5"},at={class:"bg-white p-6 rounded-3xl shadow-profileCard"},it={class:"border rounded-full px-3 py-2 w-fit flex items-center gap-3"},nt=e("img",{src:q,alt:"profile"},null,-1),rt={class:"dark:text-white"},dt={class:"my-6 mx-auto flex flex-col"},mt={key:0,class:"flex flex-col items-center gap-y-2"},ct={class:"flex flex-col justify-center items-center gap-y-2"},ut={key:1,class:"flex flex-col"},ht={class:"flex text-gray-600 gap-x-2 border-b pb-6"},pt=["src"],ft={class:"my-2 mx-2"},_t={class:"text-md font-bold dark:text-white select-none"},xt={class:"dark:text-white text-sm text-mediumGray"},gt={key:3,class:"flex flex-col gap-4 w-full h-fit mt-6"},wt={class:"text-sm flex items-center justify-between"},vt={class:"flex items-center gap-2"},bt=e("img",{src:R,alt:"mail"},null,-1),$t={class:"dark:text-white font-bold"},yt=["href"],kt={class:"text-sm flex items-center justify-between"},Ct={class:"flex items-center gap-2"},Vt=e("img",{src:ne,alt:"post"},null,-1),Ut={class:"dark:text-white font-bold"},Mt={key:0,class:"dark:text-white"},jt={key:1,class:"dark:text-white"},St={class:"text-sm flex items-center justify-between"},Dt={class:"flex items-center gap-2"},Lt=e("img",{src:A,alt:"phone"},null,-1),Et={class:"dark:text-white font-bold"},Bt=["href"],At={class:"text-sm flex items-center justify-between"},Tt={class:"flex items-center gap-2"},Rt=e("img",{src:re,alt:"stag"},null,-1),Ht={class:"dark:text-white font-bold"},zt={class:"flex items-center gap-x-2 hover:underline"},Wt={class:"col-span-2 bg-white p-6 rounded-3xl shadow-profileCard"},Ot={class:"border rounded-full px-3 py-2 w-fit flex items-center gap-3 mb-8"},Ft=e("img",{src:J,alt:"statistic"},null,-1),Gt={class:"dark:text-white"},Nt={class:"bg-white p-6 rounded-3xl shadow-profileCard"},Pt={class:"border rounded-full px-3 py-2 w-fit flex items-center gap-3 mb-8"},Yt=e("img",{src:K,alt:"info"},null,-1),Zt={class:"dark:text-white"},It={class:"flex flex-col gap-4 w-full"},qt={class:"text-sm flex items-center justify-between"},Jt={class:"dark:text-white font-bold"},Qt={class:"flex items-center gap-x-2 hover:underline"},Kt={class:"text-sm flex items-center justify-between"},Xt={class:"dark:text-white font-bold"},es={class:"flex items-center gap-x-2 hover:underline"},ts={class:"fixed flex gap-x-4 bottom-6 left-1/2 -translate-x-1/2"},ss=e("svg",{class:"absolute top-3 right-2.5",width:"25",height:"25",viewBox:"0 -0.05 20.109 20.109",xmlns:"http://www.w3.org/2000/svg"},[e("g",{class:"stroke-black",id:"edit-user",transform:"translate(-2 -2)"},[e("path",{id:"primary",d:"M20.71,16.09,15.8,21H13V18.2l4.91-4.91a1,1,0,0,1,1.4,0l1.4,1.4A1,1,0,0,1,20.71,16.09ZM11,3a4,4,0,1,0,4,4A4,4,0,0,0,11,3Z",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"}),e("path",{id:"primary-2","data-name":"primary",d:"M11,15H8a5,5,0,0,0-5,5,1,1,0,0,0,1,1H9",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5"})])],-1),os=[ss],ls=e("svg",{class:"absolute top-3 right-2 fill-redOrange",height:"26px",width:"26px",version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 473 473","xml:space":"preserve"},[e("g",null,[e("path",{d:`M324.285,215.015V128h20V38h-98.384V0H132.669v38H34.285v90h20v305h161.523c23.578,24.635,56.766,40,93.477,40\r
              c71.368,0,129.43-58.062,129.43-129.43C438.715,277.276,388.612,222.474,324.285,215.015z M294.285,215.015\r
              c-18.052,2.093-34.982,7.911-50,16.669V128h50V215.015z M162.669,30h53.232v8h-53.232V30z M64.285,68h250v30h-250V68z M84.285,128\r
              h50v275h-50V128z M164.285,403V128h50v127.768c-21.356,23.089-34.429,53.946-34.429,87.802c0,21.411,5.231,41.622,14.475,59.43\r
              H164.285z M309.285,443c-54.826,0-99.429-44.604-99.429-99.43s44.604-99.429,99.429-99.429s99.43,44.604,99.43,99.429\r
              S364.111,443,309.285,443z`}),e("polygon",{points:`342.248,289.395 309.285,322.358 276.323,289.395 255.11,310.608 288.073,343.571 255.11,376.533 276.323,397.746\r
              309.285,364.783 342.248,397.746 363.461,376.533 330.498,343.571 363.461,310.608 	`})])],-1),as=[ls],is={class:"text-center font-bold max-sm:w-9/12 max-sm:mx-auto"},ns={class:"text-center text-lg max-sm:text-sm w-7/12 mx-auto my-10 dark:text-white break-words max-sm:w-full"},rs={class:"font-bold text-red-500"},ds={class:"flex justify-center gap-3 max-sm:flex-col"},ms={class:"text-center font-bold max-sm:w-9/12 max-sm:mx-auto"},Ss=U({__name:"[slug]",props:{userEdit:{type:Object,default:()=>({})},showWarning:Boolean,showChange:Boolean,activeImg:Boolean},setup(d){const w=G(),u=T(),x=X(),l=V(),y=N();function k(){y.back()}const M=P(()=>{const t=new Date(l.user.date_of_birth),a=new Date;let r=a.getFullYear()-t.getFullYear();const n=a.getMonth()-t.getMonth(),h=a.getDate()-t.getDate();return(n<0||n===0&&h<0)&&r--,r});return Y(()=>{var t,a;l.loadUser({id:w.params.slug}),((t=x.user.role)==null?void 0:t.name_en)==="company_admin"||((a=x.user.role)==null?void 0:a.name_en)==="admin"?(u.loadDepartmentList(),l.loadPermissions()):x.user.role_en==="admin"&&u.loadCompanyList({page:1,limit:1e5,query:""})}),Z(()=>{I({title:`${l.user.first_name+" "+l.user.last_name}`})}),(t,a)=>{var r,n;return c(),p("div",null,[e("div",Ze,[e("button",{onClick:k,class:"px-6 py-2 rounded-[30px] border-2 font-bold text-mediumGray bg-white flex items-center gap-2"},[Ie,_(" "+o(t.$t("Назад")),1)]),e("div",qe,[m(L,{"breadcrumb-link":"/base/users"},{default:f(()=>[_(o(t.$t("Компания")),1)]),_:1}),Je,m(L,null,{default:f(()=>[_(o(s(l).user.first_name+" "+s(l).user.last_name),1)]),_:1})])]),e("div",Qe,[e("p",Ke,o(t.$t("Профиль пользователя")),1),e("div",Xe,[e("p",et,o(t.$t("Последняя активность")),1),e("div",tt,[e("p",st,o(new Date().toLocaleDateString()),1),e("p",ot,o(new Date().toLocaleTimeString()),1)])])]),e("div",lt,[e("div",at,[e("div",it,[nt,e("h2",rt,o(t.$t("Информация")),1)]),e("div",dt,[s(l).user.id?(c(),p("div",ut,[e("div",ht,[e("img",{class:"block w-[60px] h-[60px] border-2 border-golden rounded-full shadow-lg dark:shadow-none",src:s(l).user.photo,alt:"logo"},null,8,pt),e("div",ft,[e("h3",_t,o(s(l).user.first_name)+" "+o(s(l).user.last_name),1),e("p",xt,o(s(M)+" лет"),1)])])])):(c(),p("div",mt,[m(b,{width:"5rem",height:"5rem","border-radius":"100%"}),e("div",ct,[m(b,{width:"150px",height:"20px","border-radius":"20px"}),m(b,{width:"130px",height:"15px","border-radius":"20px"})])])),s(l).user.id?(c(),p("div",gt,[e("div",wt,[e("div",vt,[bt,e("p",$t,o(t.$t("Email"))+": ",1)]),e("a",{href:`mailto:${s(l).user.email}`,class:"cursor-pointer hover:text-blueSemiLight hover:underline dark:hover:text-gray-200"},o(s(l).user.email),9,yt)]),e("div",kt,[e("div",Ct,[Vt,e("p",Ut,o(t.$t("Должность"))+": ",1)]),s(x).user.role_en==="admin"?(c(),p("p",Mt,o(s(l).user.role)+" "+o(s(l).user.position),1)):(c(),p("p",jt,o(s(l).user.position),1))]),e("div",St,[e("div",Dt,[Lt,e("p",Et,o(t.$t("Телефон"))+": ",1)]),e("a",{class:"flex items-center gap-x-2 hover:underline",href:`tel:${s(l).user.phone}`},[e("p",null,o(s(l).user.phone),1)],8,Bt)]),e("div",At,[e("div",Tt,[Rt,e("p",Ht,o(t.$t("Стаж"))+": ",1)]),e("p",zt,o(s(l).user.head_user.start_work_year||t.$t("Нет стажа")),1)])])):(c(),v(b,{key:2,class:"my-2",width:"150px",height:"15px","border-radius":"20px"}))])]),e("div",Wt,[e("div",Ot,[Ft,e("h2",Gt,o(t.$t("Личная статистика")),1)]),e("div",null,[m(de)])]),e("div",Nt,[e("div",Pt,[Yt,e("h2",Zt,o(t.$t("Информация об отделе")),1)]),e("div",It,[e("div",qt,[e("p",Jt,o(t.$t("Департамент"))+": ",1),e("p",Qt,o((r=s(l).user.department)==null?void 0:r.name),1)]),e("div",Kt,[e("p",Xt,o(t.$t("Руководитель"))+": ",1),e("p",es,o((n=s(l).user.department)==null?void 0:n.name),1)])])])]),e("div",ts,[e("button",{onClick:a[0]||(a[0]=h=>{d.showChange=!d.showChange,d.userEdit={...s(l).user},d.userEdit.permissions=s(l).get_permission_list.map(i=>(i.value=d.userEdit.permissions.filter(H=>H.id==i.id).length!=0,i))}),"on:showModal":a[1]||(a[1]=h=>{d.showChange=!0}),class:"w-12 h-12 bg-white border hover:transition-all duration-200 hover:scale-95 rounded-xl relative"},os,32),e("button",{onClick:a[2]||(a[2]=h=>d.showWarning=!d.showWarning),class:"w-12 h-12 bg-white border hover:transition-all duration-200 hover:scale-95 rounded-xl relative"},as),d.showWarning?(c(),v(E,{key:0,onShowModal:a[5]||(a[5]=h=>{d.showWarning=!d.showWarning})},{default:f(()=>[e("p",is,o(t.$t("Вы действительно хотите удалить пользователя?")),1),e("p",ns,[e("span",rs,o(t.$t("Предупреждение")),1),_(": "+o(t.$t("после удаления данного пользователя вся информация пропадёт и не будет подлежать восстановлению")),1)]),e("div",ds,[m($,{class:"w-4/12 max-sm:w-full rounded-full flex items-center justify-center !text-black hover:!bg-gray-200 gap-3 py-2 !bg-porcelain !border transition-all ease-in-out duration-300",t:"button",onClick:a[3]||(a[3]=h=>d.showWarning=!1)},{default:f(()=>[_(o(t.$t("Отменить")),1)]),_:1}),m($,{class:"w-4/12 max-sm:w-full rounded-full flex items-center justify-center !text-white gap-3 py-2 !bg-redOrange !border transition-all ease-in-out duration-300",t:"submit",onClick:a[4]||(a[4]=h=>s(l).deleteUser({user_id:s(l).user.id},t.$router))},{default:f(()=>[_(o(t.$t("Удалить")),1)]),_:1})])]),_:1})):D("",!0),d.showChange?(c(),v(E,{key:1,onShowModal:a[7]||(a[7]=h=>d.showChange=!d.showChange)},{default:f(()=>[e("p",ms,o(t.$t("Редактирование пользователя")),1),m(Ye,{"user-edit":d.userEdit,onShowChange:a[6]||(a[6]=h=>d.showChange=!1)},null,8,["user-edit"])]),_:1})):D("",!0)])])}}});export{Ss as default};
