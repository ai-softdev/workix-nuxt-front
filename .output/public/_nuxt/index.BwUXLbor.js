import{N as r,O as d,a5 as Y,a as v,u as t,P as V,V as h,$ as D,_ as n,a2 as b,Z as e,L as _,a6 as Q,aa as M,ab as ee,J as S,a3 as j,aj as F,j as Z,b as J,H as K,a8 as te,a4 as I,x as se}from"./swiper-vue.D8OdYOtj.js";import{b as le,c as oe,F as ae}from"./entry.Dp7d5lJq.js";import{_ as T}from"./TheButton.vue.BysbZV1X.js";import{_ as $}from"./TheInput.vue.B9n9qFKm.js";import{_ as ne}from"./TheModal.vue.B87978z5.js";import{_ as re}from"./TheTextContent.vue.m2iseIPA.js";import{_ as ie}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{u as X}from"./users.CeKQ9nhO.js";import{u as de}from"./companies.Dnb_h2gg.js";import{u as P}from"./auth.DEWEs6f7.js";import"./vue-datepicker.HLX8V__l.js";import{_ as ue}from"./nuxt-link.UBS0YUK3.js";import{_ as me}from"./TheSearch.vue.CDzQRUI9.js";import{P as ce}from"./vuejs-paginate-next.es.YjZv_lpk.js";import{u as pe}from"./index.CN4qvGUF.js";import"./nuxt-storage.jjXK-e5k.js";const _e=""+globalThis.__publicAssetsURL("icons/email.svg"),fe=""+globalThis.__publicAssetsURL("icons/phone.svg"),ge=""+globalThis.__publicAssetsURL("icons/password.svg"),he={},xe={class:"flex max-lg:flex-wrap justify-center gap-x-10 my-10 mx-auto w-full"};function we(i,f){return r(),d("div",xe,[Y(i.$slots,"default")])}const N=ie(he,[["render",we]]),be={class:"p-6 !pb-0"},ve={class:"grid grid-cols-2 gap-4 mt-8 pb-6 border-b mb-6"},ye={class:"w-full max-lg:w-full"},ke={class:"w-full max-lg:w-full"},$e={class:"w-full max-lg:w-full"},Ue={class:"w-full max-lg:w-full flex flex-col"},Ce={class:"text-md font-medium dark:text-white"},Ve={class:"grid grid-cols-2 gap-4"},Le={class:"w-full"},Ne={class:"text-md font-medium dark:text-white flex items-center gap-2"},Se=e("img",{src:_e,alt:"email"},null,-1),je={class:"w-full flex flex-col"},qe={class:"text-md font-medium dark:text-white flex items-center gap-2"},De=e("img",{src:fe,alt:"phone"},null,-1),Ie={class:"w-full"},Me={class:"text-md font-medium dark:text-white flex items-center gap-2"},Pe=e("img",{src:ge,alt:"password"},null,-1),Ae={class:"w-6/12 flex flex-col max-lg:w-full"},Be={key:0,class:"mt-4"},Re=["src"],Te={class:"text-md font-medium dark:text-white"},Fe={class:"cursor-pointer bg-whiteSmoke hover:bg-gray-100 rounded-lg border-dashed border p-4 transition-all mt-2"},Ge={class:"w-6/12 max-lg:w-full relative"},Ee={class:"text-md dark:text-white font-medium"},Oe={key:0,class:"absolute z-10 bg-white dark:bg-gray-800 w-full rounded-lg mt-1 border border-gray-300 dark:border-gray-600 shadow-md max-h-40 overflow-y-auto"},We=["onMousedown"],ze={key:0,class:"w-6/12 max-lg:w-full"},He={class:"text-md dark:text-white font-medium"},Je=["value"],Ze={class:"w-6/12 max-lg:w-full"},Ke={class:"text-md dark:text-white font-medium"},Xe=["value"],Ye={__name:"UserCreate",props:{showCreateUser:{type:Boolean,default:!1}},setup(i){const f=P(),u=de(),g=X(),x=v(null),s=v({email:"",first_name:"",last_name:"",patronymic:"",password:"",phone:"",photo:"",position:"",head_user_id:"",date_of_birth:new Date().toDateString(),company_id:0,department_id:0,department:{},role_id:0,permissions:{}});function y(){g.loadPositionList(),g.loadUserList(),u.loadDepartmentList()}function q(){var l;(l=s.value.department)!=null&&l.id&&(s.value.department_id=s.value.department.id),g.createAdmin(s.value),s.value={email:"",first_name:"",last_name:"",patronymic:"",password:"",phone:"",photo:"",position:"",head_user_id:"",date_of_birth:new Date().toDateString(),company_id:0,department_id:0,department:{},role_id:0,permissions:{}}}function A(){var l;(l=s.value.department)!=null&&l.id&&(s.value.department_id=s.value.department.id),g.createUser(s.value),s.value={email:"",first_name:"",last_name:"",patronymic:"",password:"",phone:"",photo:"",position:"",head_user_id:"",date_of_birth:new Date().toDateString(),company_id:0,department_id:0,department:{},role_id:0,permissions:{}}}const m=v(!1),U=v([]),B=()=>{s.value.position?U.value=g.get_position_list.filter(l=>l.name.toLowerCase().includes(s.value.position.toLowerCase())):U.value=g.get_position_list,m.value=!0},R=l=>{s.value.position=l,m.value=!1};function L(l){const o=l.target.files[0];o&&o.type.startsWith("image/")?(s.value.photo=o,x.value=URL.createObjectURL(o)):(s.value.photo=null,x.value=null)}const p=()=>{setTimeout(()=>{m.value=!1},200)};return(l,o)=>(r(),d("div",null,[t(f).current_user.permissions?(r(),V(T,{key:0,class:"max-md:w-full w-full text-sm",type:"golden",onClick:o[0]||(o[0]=C=>{var k;i.showCreateUser=!0,y(),((k=t(f).user.role)==null?void 0:k.name_en)==="admin"&&t(u).loadCompanyList({page:1,limit:1e3,query:""})})},{default:h(()=>[D(" + "+n(l.$t("Создать пользователя")),1)]),_:1})):b("",!0),i.showCreateUser?(r(),V(ne,{key:1,onShowModal:o[15]||(o[15]=C=>{i.showCreateUser=!i.showCreateUser,i.showCreateUser?s.value={}:s.value={}}),"show-create-user":i.showCreateUser},{default:h(()=>{var C,k;return[e("div",be,[_(re,{class:"!text-start font-bold !text-3xl"},{default:h(()=>[D(n(l.$t("Создание пользователя")),1)]),_:1}),e("form",{enctype:"multipart/form-data",onSubmit:o[14]||(o[14]=Q(a=>{var c;return((c=t(f).user.role)==null?void 0:c.name_en)==="admin"?q():A()},["prevent"]))},[e("div",ve,[e("div",ye,[_($,{type:"text",label:l.$t("Имя"),modelValue:t(s).first_name,"onUpdate:modelValue":o[1]||(o[1]=a=>t(s).first_name=a)},null,8,["label","modelValue"])]),e("div",ke,[_($,{type:"text",label:l.$t("Фамилия"),modelValue:t(s).last_name,"onUpdate:modelValue":o[2]||(o[2]=a=>t(s).last_name=a)},null,8,["label","modelValue"])]),e("div",$e,[_($,{type:"text",label:l.$t("Отчество"),modelValue:t(s).patronymic,"onUpdate:modelValue":o[3]||(o[3]=a=>t(s).patronymic=a)},null,8,["label","modelValue"])]),e("div",Ue,[e("p",Ce,n(l.$t("Дата рождения")),1),_($,{type:"date",class:"w-full rounded-lg outline-1",id:"date",placeholder:"Выбрать",modelValue:t(s).date_of_birth,"onUpdate:modelValue":o[4]||(o[4]=a=>t(s).date_of_birth=a)},null,8,["modelValue"])])]),e("div",Ve,[e("div",Le,[e("div",Ne,[Se,e("p",null,n(l.$t("Почта")),1)]),_($,{type:"text",modelValue:t(s).email,"onUpdate:modelValue":o[5]||(o[5]=a=>t(s).email=a)},null,8,["modelValue"])]),e("div",je,[e("div",qe,[De,e("p",null,n(l.$t("Номер телефона")),1)]),_($,{type:"tel",class:"w-full",id:"phone",placeholder:"+998 (__) ___-__-__",modelValue:t(s).phone,"onUpdate:modelValue":o[6]||(o[6]=a=>t(s).phone=a)},null,8,["modelValue"])]),e("div",Ie,[e("div",Me,[Pe,e("p",null,n(l.$t("Пароль")),1)]),_($,{type:"password",modelValue:t(s).password,"onUpdate:modelValue":o[7]||(o[7]=a=>t(s).password=a)},null,8,["modelValue"])])]),_(N,null,{default:h(()=>[e("div",Ae,[t(x)?(r(),d("div",Be,[e("img",{src:t(x),alt:"Превью",class:"mx-auto w-32 h-32 object-cover rounded-lg shadow-icons"},null,8,Re)])):b("",!0),e("p",Te,n(l.$t("Фото")),1),e("label",Fe,[e("input",{type:"file",name:"file",label:"Фото",class:"dark:text-white cursor-pointer",onInput:L},null,32)])])]),_:1}),_(N,null,{default:h(()=>[e("div",Ge,[e("p",Ee,n(l.$t("Должность")),1),M(e("input",{type:"text","onUpdate:modelValue":o[8]||(o[8]=a=>t(s).position=a),class:"dark:text-white w-full dark:bg-gray-300 bg-whiteSmoke rounded-full p-2 dark:border-none text-black border focus:outline-golden mt-2 outline-1",onFocus:o[9]||(o[9]=a=>m.value=!0),onBlur:p,onInput:B},null,544),[[ee,t(s).position]]),t(m)&&t(U).length?(r(),d("ul",Oe,[(r(!0),d(S,null,j(t(U),a=>(r(),d("li",{key:a.name,onMousedown:c=>R(a.name),class:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer"},n(a.name),41,We))),128))])):b("",!0)])]),_:1}),_(N,null,{default:h(()=>{var a;return[t(f).user.role.name_en==="company_admin"?(r(),d("div",ze,[e("p",He,n(l.$t("Отдел")),1),M(e("select",{type:"text","onUpdate:modelValue":o[10]||(o[10]=c=>t(s).department=c),class:"dark:text-white w-full dark:bg-gray-300 bg-whiteSmoke rounded-full p-2 dark:border-none text-black border focus:outline-golden mt-2 outline-1"},[(r(!0),d(S,null,j((a=t(u))==null?void 0:a.get_all_department.results,c=>(r(),d("option",{value:c},n(c.name),9,Je))),256))],512),[[F,t(s).department]])])):b("",!0)]}),_:1}),(k=(C=t(s).department)==null?void 0:C.participants)!=null&&k.length?(r(),V(N,{key:0},{default:h(()=>{var a;return[e("div",Ze,[e("p",Ke,n(l.$t("Руководитель")),1),(a=t(g))!=null&&a.get_position_list?b("",!0):(r(),V($,{key:0,type:"text",name:"text",label:"Руководитель",class:"dark:text-white cursor-pointer",modelValue:t(s).head_user_id,"onUpdate:modelValue":o[11]||(o[11]=c=>t(s).head_user_id=c)},null,8,["modelValue"])),M(e("select",{"onUpdate:modelValue":o[12]||(o[12]=c=>t(s).head_user_id=c),class:"dark:text-white w-full dark:bg-gray-300 bg-whiteSmoke rounded-full p-2 dark:border-none text-black border focus:outline-golden mt-2 outline-1"},[(r(!0),d(S,null,j(t(s).department.participants,c=>(r(),d("option",{key:c.id,value:c.id},n(c.first_name)+" "+n(c.last_name),9,Xe))),128))],512),[[F,t(s).head_user_id]])])]}),_:1})):b("",!0),_(N,null,{default:h(()=>[_(T,{class:"w-4/12 rounded-full flex items-center justify-center !text-black hover:!bg-gray-200 gap-3 py-2 !bg-porcelain !border transition-all ease-in-out duration-300",t:"button",onClick:o[13]||(o[13]=a=>i.showCreateUser=!1)},{default:h(()=>[D(n(l.$t("Отменить")),1)]),_:1}),_(T,{class:"w-4/12 rounded-full flex items-center justify-center !text-black hover:!shadow-golden gap-3 py-2 !bg-golden !border transition-all ease-in-out duration-300",t:"submit",type:"success"},{default:h(()=>[D(n(l.$t("Создать")),1)]),_:1})]),_:1})],32)])]}),_:1},8,["show-create-user"])):b("",!0)]))}},Qe=Ye,et={class:"flex items-center max-md:w-4/12 gap-x-2 max-lg:mx-auto pb-4 border-b"},tt={class:"flex items-center justify-center rounded-md px-1 w-[33px] h-[33px] shadow-md"},st=["src"],lt={class:"font-bold text-sm break-words"},ot={class:"mt-4 flex flex-col gap-2"},at={key:0,class:"flex items-start justify-between gap-10 min-h-10"},nt={class:"font-bold"},rt={class:"text-mediumGray text-right"},it={key:1,class:"flex items-start justify-between gap-10 min-h-10"},dt={class:"font-bold"},ut={class:"text-mediumGray text-right"},mt={class:"flex items-center justify-between gap-10 mt-2"},ct={class:"font-bold"},pt={class:"text-mediumGray"},_t=Z({__name:"UserContentList",props:{userItem:{type:Object,required:!0}},setup(i){const f=P();return(u,g)=>{const x=ue;return r(),V(x,{to:`/base/users/${i.userItem.id}`,class:"transition-all bg-white shadow-cards hover:shadow-hoverCards border border-white hover:border-golden dark:border-none dark:shadow-none dark:bg-gray-700 dark:hover:bg-gray-800 py-6 px-5 rounded-3xl items-center max-md:flex max-md:w-full max-sm:flex-col max-sm:gap-y-4"},{default:h(()=>[e("div",et,[e("div",tt,[e("img",{class:"w-[22px] h-[22px] rounded-full",src:i.userItem.photo,alt:"logo"},null,8,st)]),e("h2",lt,n(i.userItem.first_name+" "+i.userItem.last_name),1)]),e("div",ot,[t(f).user.role_en==="admin"?(r(),d("div",at,[e("p",nt,n(u.$t("Роль | Должность"))+": ",1),e("p",rt," ("+n(i.userItem.role)+") ",1)])):(r(),d("div",it,[e("p",dt,n(u.$t("Должность"))+": ",1),e("p",ut,n(i.userItem.position),1)]))]),e("div",mt,[e("p",ct,n(u.$t("Дата регистрации"))+": ",1),e("p",pt,n(new Date(i.userItem.created_at).toLocaleString().slice(0,10)),1)])]),_:1},8,["to"])}}}),ft={class:"flex flex-col gap-4"},gt={class:"text-lg flex gap-x-10"},ht={key:0,class:"dark:text-white text-3xl font-bold"},xt={key:1,class:"dark:text-white text-3xl font-bold"},wt={key:0,class:"flex gap-x-10"},bt={class:"w-full mt-4"},vt={class:"flex items-center justify-between gap-x-10 max-lg:flex-wrap max-md:justify-center"},yt={class:"text-mediumGray w-5/12"},kt={class:"w-5/12 flex items-center gap-3 h-10"},$t={class:"mt-8 grid grid-cols-4 gap-5 max-md:mt-10"},Ut={key:0},Ct={class:"text-center"},Vt={class:"w-full flex items-center justify-end border-t gap-4 pr-10 pb-5 pt-5 max-md:pr-3 max-md:flex-col max-md:items-end"},Lt={class:"flex items-center gap-3"},Nt=e("p",null,"Строк на странице:",-1),St=["value"],jt={__name:"UserContent",props:{userChecked:{type:String,default:"user-list"},showUserInfo:{type:Boolean,default:!1}},setup(i){const f=P(),u=X();v("");const g=le(),x=oe(),s=v(Number(g.query.page)||1),y=v(Number(g.query.limit)||10),q=v(0),A=v([5,10,20,30,50]),m={page:1,limit:10,query:v(""),user_type:"user-list"},U=p=>{s.value=p,L()},B=()=>{L()},R=()=>{s.value=1,L()},L=()=>{x.push({query:{page:s.value,limit:y.value,itemName:m.query.value||void 0}})};return J(()=>g.query,p=>{s.value=Number(p.page)||1,y.value=Number(p.limit)||10,m.query.value=p.itemName||"",u.loadUserList({page:s.value,limit:y.value,query:m.query.value})}),J(()=>u.user,p=>{q.value=Math.ceil(u.user.count/y.value)}),K(()=>{ae({params:{page:m.page}})}),te(()=>{var p,l;((p=f.user.role)==null?void 0:p.name_en)==="admin"?u.loadAdminList({page:m.page,limit:m.limit,query:m.query.value}):((l=f.user.role)==null?void 0:l.name_en)==="company_admin"&&u.loadUserList({page:m.page,limit:m.limit,query:m.query.value})}),(p,l)=>{var k,a,c,G,E,O,W,z,H;const o=Qe,C=_t;return r(),d("div",ft,[e("div",{class:I(["flex items-center justify-between gap-10",{"flex items-center justify-between":["company_admin","admin"].includes((k=t(f).user.role)==null?void 0:k.name_en)}])},[e("div",gt,[((a=t(f).user.role)==null?void 0:a.name_en)==="admin"?(r(),d("p",ht,n(p.$t("Список администраторов компании")),1)):(r(),d("p",xt,n(p.$t("Список всех пользователей компании")),1))]),e("div",{class:I({"flex items-center justify-evenly":((c=t(f).user.role)==null?void 0:c.name_en)==="admin","w-2/12 max-lg:w-4/12 max-sm:w-full max-sm:mb-6 max-sm:mx-auto":t(f).user.role_en!=="admin"})},[((G=t(f))==null?void 0:G.user.role)==="Администратор сайта"?(r(),d("div",wt,[e("button",{class:I(["p-2 rounded-xl dark:text-white tracking-widest font-bold",{"bg-blueDarkSemiLight text-white":i.userChecked==="user-list"}]),onClick:l[0]||(l[0]=w=>{i.userChecked="user-list",t(u).loadUserList({page:t(u).page,limit:m.limit,user_type:i.userChecked})})},n(p.$t("Все пользователи")),3),e("button",{class:I(["p-2 rounded-xl dark:text-white tracking-widest font-bold",{"bg-blueDarkSemiLight text-white":i.userChecked==="admin-list"}]),onClick:l[1]||(l[1]=w=>{i.userChecked="admin-list",t(u).loadAdminList({page:t(u).page,limit:m.limit})})},n(p.$t("Администраторы компаний")),3)])):b("",!0),_(o)],2)],2),e("div",bt,[e("div",vt,[e("p",yt,n(p.$t("Данная страница хранит информацию о пользователях данной платформы")),1),e("div",kt,[_(me,{class:"w-full","model-value":m.query,"onUpdate:modelValue":l[2]||(l[2]=w=>m.query=w),onSearch:R},null,8,["model-value"])])]),e("div",$t,[((E=t(u))==null?void 0:E.get_user_list.count)>0?(r(!0),d(S,{key:0},j((O=t(u))==null?void 0:O.get_user_list.results,w=>(r(),V(C,{"user-item":w,class:"max-md:w-full"},null,8,["user-item"]))),256)):b("",!0)]),(H=(z=(W=t(u))==null?void 0:W.get_user_list)==null?void 0:z.results)!=null&&H.length?b("",!0):(r(),d("div",Ut,[e("p",Ct,n(p.$t("По вашему запросу никого не найдено.")),1)]))]),e("div",Vt,[_(t(ce),{"page-count":t(q),"page-range":3,"margin-pages":2,"click-handler":U,"prev-text":"<","next-text":">","container-class":"pagination","page-class":"page-item","force-page":t(s)},null,8,["page-count","force-page"]),e("div",Lt,[Nt,M(e("select",{"onUpdate:modelValue":l[3]||(l[3]=w=>se(y)?y.value=w:null),onChange:B,class:"w-fit p-2.5 rounded-md border bg-white dark:bg-bgWhite text-black"},[(r(!0),d(S,null,j(t(A),w=>(r(),d("option",{value:w},n(w),9,St))),256))],544),[[F,t(y)]])])])])}}},qt=jt,Zt=Z({__name:"index",setup(i){const f=P();return pe({title:"Пользователи",description:"Список пользователей данной платформы"}),K(()=>{f.loadCurrentUserWorker()}),(u,g)=>{const x=qt;return r(),d("div",null,[_(x)])}}});export{Zt as default};
