import{_ as ee}from"./TheButton.vue.BDirOtev.js";import{_ as te}from"./nuxt-link.CSJ93Yb7.js";import{j as le,a as o,H as ae,b as S,N as d,O as b,Z as e,_ as u,L as i,V as M,aa as E,ab as se,u as s,x as N,$ as r,a4 as f,J as H,a3 as J,a2 as B,aj as ne,P as oe,a6 as ue}from"./swiper-vue.D8OdYOtj.js";import{b as re,c as ie}from"./entry.Di5bHZXA.js";import{P as me}from"./vuejs-paginate-next.es.YjZv_lpk.js";import{u as ce}from"./sales.BGqv3qLT.js";import{T as de}from"./ThePreloader.DzI-SVE5.js";import{u as pe}from"./companies.hh99nCn4.js";import{u as ge}from"./auth.D1G7iEsz.js";import{_ as T}from"./TheInput.vue.B9n9qFKm.js";import{_ as _e}from"./TheModal.vue.B87978z5.js";import"./nuxt-storage.jjXK-e5k.js";import"./_plugin-vue_export-helper.DlAUqK2U.js";const ve=""+globalThis.__publicAssetsURL("icons/export.svg"),be=""+globalThis.__publicAssetsURL("icons/filters.svg"),x=""+globalThis.__publicAssetsURL("icons/table-arrow.svg"),fe={class:"flex items-center justify-between"},xe={class:"dark:text-white text-3xl font-bold"},he={class:"ml-auto flex items-center gap-6"},we=e("img",{src:ve,alt:"export"},null,-1),ye={class:"text-azure font-medium"},ke=e("div",{class:"flex items-center gap-x-4 max-md:mt-10 max-md:flex-col max-md:items-start max-md:gap-y-4"},null,-1),Ce={class:"w-fit sales-up-table rounded-lg mt-10 overflow-hidden"},Ve={class:"flex items-center justify-between gap-3 mb-4"},Ne=e("img",{src:be,alt:"filters"},null,-1),$e={class:"w-4/12 max-md:w-full relative flex items-center"},Le=e("div",{class:"absolute rotate-90 ml-3"},[e("svg",{class:"dark:stroke-white stroke-black",width:"25px",height:"25px",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M14.9536 14.9458L21 21M17 10C17 13.866 13.866 17 10 17C6.13401 17 3 13.866 3 10C3 6.13401 6.13401 3 10 3C13.866 3 17 6.13401 17 10Z","stroke-width":"1.2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1),Se={class:"w-full sales-table rounded-3xl bg-white overflow-hidden"},Me={key:0},Ue={class:"bg-gray-200 dark:bg-bgWhite"},qe=e("th",null," № ",-1),je={key:1,class:"min-h-[300px] min-w-[89vw] bg-gray-200 dark:bg-bgWhite text-center flex items-center justify-center"},Be={key:2,class:"relative min-h-[400px] min-w-[89vw]"},Te=e("div",{class:"bg-black w-full h-full absolute top-0 left-0 opacity-40 rounded-lg"},null,-1),Pe={class:"w-full flex items-center justify-end gap-4 pr-10 pb-5 pt-5 max-md:pr-3 max-md:flex-col max-md:items-end"},Re={class:"flex items-center gap-3"},Fe=e("p",null,"Строк на странице:",-1),Ie=["value"],We={class:"flex flex-col gap-5"},ze=e("p",null," Фильтры: ",-1),lt=le({__name:"index",setup(Ae){const U=ge(),R=pe(),p=re(),$=ie(),m=ce(),q=o(!1),g=o(Number(p.query.page)||1),c=o(Number(p.query.limit)||5),h=o(p.query.itemName||""),y=o(Number(p.query.min_price)||""),k=o(Number(p.query.max_price)||""),C=o(Number(p.query.min_count)||""),V=o(Number(p.query.max_count)||""),O=o([5,10,20,30,50]),w=o([]),j=o(""),L=()=>{$.push({query:{page:g.value,limit:c.value,itemName:h.value||void 0,min_price:y.value||"",max_price:k.value||"",min_count:C.value||"",max_count:V.value||"",order_by:j.value||""}})},G=a=>{g.value=a,L()},K=()=>{L()},X=()=>{g.value=1,L()},F=()=>{q.value=!q.value},I=o(0),_=a=>{const t=w.value.findIndex(n=>n===a||n===`-${a}`);t!==-1?w.value[t]=w.value[t].startsWith("-")?a:`-${a}`:w.value.push(a),L()},v=a=>w.value.includes(a)?"rotate-0":(w.value.includes(`-${a}`),"rotate-180"),Y=()=>{m.loadSalesListFile()};return ae(()=>{m.loadSalesList({page:g.value,limit:c.value,name:h.value,min_price:y.value,max_price:k.value,min_count:C.value,max_count:V.value,order_by:j.value})}),S(w.value,a=>{j.value=a.join(",")}),S(()=>m.sales,a=>{I.value=Math.ceil(m.sales.count/c.value)}),S(()=>p.query,a=>{g.value=Number(a.page)||1,c.value=Number(a.limit)||5,h.value=a.itemName||"",m.loadSalesList({page:g.value,limit:c.value,name:h.value,min_price:y.value,max_price:k.value,min_count:C.value,max_count:V.value,order_by:j.value})}),S(()=>U.user,a=>{var t,n;((n=(t=U==null?void 0:U.user)==null?void 0:t.role)==null?void 0:n.name_en)==="admin"&&(window.history.length>1?$.push("/base/profile"):$.push("/"))}),S(()=>R.company,a=>{var n;((n=R.company.modules)==null?void 0:n.find(P=>P.name_en==="sales"))||(window.history.length>1?$.push("/base/profile"):$.push("/"))}),(a,t)=>{var W,z,A,D,Z;const n=ee,P=te;return d(),b("div",null,[e("div",fe,[e("p",xe,u(a.$t("Страница продаж")),1),e("div",he,[e("button",{onClick:Y,class:"flex items-center gap-3"},[we,e("p",ye,u(a.$t("Экспортировать в файл")),1)]),i(P,{to:"/base/sales/item-create",class:"ml-auto"},{default:M(()=>[i(n,{class:"border border-golden bg-golden py-3 px-10 rounded-full !text-black dark:!text-white"},{default:M(()=>[r(" + Добавить товар ")]),_:1})]),_:1})])]),e("div",null,[ke,e("div",Ce,[e("div",Ve,[i(n,{onClick:F,class:"border bg-white flex items-center gap-1 p-3 rounded-full !text-black dark:!text-white"},{default:M(()=>[Ne,r(" Фильтры ")]),_:1}),e("div",$e,[Le,E(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>N(h)?h.value=l:null),onInput:X,type:"text",class:"w-full rounded-full border dark:bg-gray-500 outline-none pl-12 h-[50px]",placeholder:"Найти товар..."},null,544),[[se,s(h)]])])]),e("div",Se,[(z=(W=s(m).sales)==null?void 0:W.results)!=null&&z.length?(d(),b("table",Me,[e("thead",Ue,[e("tr",null,[qe,e("th",null,[e("button",{onClick:t[1]||(t[1]=l=>_("name")),class:"flex items-center gap-3"},[r(" Наименование "),e("img",{class:f(v("name")),src:x,alt:"table-arrow"},null,2)])]),e("th",null,[e("button",{onClick:t[2]||(t[2]=l=>_("sales_count")),class:"flex items-center gap-3"},[r(" Кол-во продаж "),e("img",{class:f(v("sales_count")),src:x,alt:"table-arrow"},null,2)])]),e("th",null,[e("button",{onClick:t[3]||(t[3]=l=>_("price_per_count")),class:"flex items-center gap-3"},[r(" Цена за единицу "),e("img",{class:f(v("price_per_count")),src:x,alt:"table-arrow"},null,2)])]),e("th",null,[e("button",{onClick:t[4]||(t[4]=l=>_("total")),class:"flex items-center gap-3"},[r(" Сумма "),e("img",{class:f(v("total")),src:x,alt:"table-arrow"},null,2)])]),e("th",null,[e("button",{onClick:t[5]||(t[5]=l=>_("vat")),class:"flex items-center gap-3"},[r(" НДС "),e("img",{class:f(v("vat")),src:x,alt:"table-arrow"},null,2)])]),e("th",null,[e("button",{onClick:t[6]||(t[6]=l=>_("total_with_vat")),class:"flex items-center gap-3"},[r(" Сумма с НДС "),e("img",{class:f(v("total_with_vat")),src:x,alt:"table-arrow"},null,2)])]),e("th",null,[e("button",{onClick:t[7]||(t[7]=l=>_("company_sale_to")),class:"flex items-center gap-3"},[r(" Наименование компании "),e("img",{class:f(v("company_sale_to")),src:x,alt:"table-arrow"},null,2)])]),e("th",null,[e("button",{onClick:t[8]||(t[8]=l=>_("agent")),class:"flex items-center gap-3"},[r(" Агент "),e("img",{class:f(v("agent")),src:x,alt:"table-arrow"},null,2)])])])]),e("tbody",null,[(d(!0),b(H,null,J(s(m).sales.results,(l,Q)=>(d(),b("tr",null,[e("td",null,u(s(c)*(s(g)-1)+Q+1),1),e("td",null,u(l.name),1),e("td",null,u(l.sales_count),1),e("td",null,u(l.price_per_count),1),e("td",null,u(l.total),1),e("td",null,u(l.vat),1),e("td",null,u(l.total_with_vat),1),e("td",null,u(l.company_sale_to),1),e("td",null,u(l.agent.last_name+" "+l.agent.first_name+" "+l.agent.patronymic),1)]))),256))])])):B("",!0),((D=(A=s(m).sales)==null?void 0:A.results)==null?void 0:D.length)===0?(d(),b("div",je," Товаров пока нет ")):B("",!0),(Z=s(m).sales)!=null&&Z.results?B("",!0):(d(),b("div",Be,[Te,i(de)]))]),e("div",Pe,[i(s(me),{"page-count":s(I),"page-range":3,"margin-pages":2,"click-handler":G,"prev-text":"<","next-text":">","container-class":"pagination","page-class":"page-item","force-page":s(g)},null,8,["page-count","force-page"]),e("div",Re,[Fe,E(e("select",{"onUpdate:modelValue":t[9]||(t[9]=l=>N(c)?c.value=l:null),onChange:K,class:"w-fit p-2.5 rounded-md border bg-white dark:bg-bgWhite text-black"},[(d(!0),b(H,null,J(s(O),l=>(d(),b("option",{value:l},u(l),9,Ie))),256))],544),[[ne,s(c)]])])])])]),s(q)?(d(),oe(_e,{key:0,type:"resize",onShowModal:t[15]||(t[15]=()=>{})},{default:M(()=>[e("button",{class:"absolute top-3 right-3",onClick:F}," x "),e("div",We,[ze,e("form",{onSubmit:t[14]||(t[14]=ue(l=>{L(),q.value=!1},["prevent"])),class:"flex items-center gap-5 flex-col"},[i(T,{modelValue:s(y),"onUpdate:modelValue":t[10]||(t[10]=l=>N(y)?y.value=l:null),class:"bg-transparent bg-opacity-0 rounded-lg outline-none max-md:w-full",type:"number",label:"Минимальная цена"},null,8,["modelValue"]),i(T,{modelValue:s(k),"onUpdate:modelValue":t[11]||(t[11]=l=>N(k)?k.value=l:null),class:"bg-transparent bg-opacity-0 rounded-lg outline-none max-md:w-full",type:"number",label:"Максимальная цена"},null,8,["modelValue"]),i(T,{modelValue:s(C),"onUpdate:modelValue":t[12]||(t[12]=l=>N(C)?C.value=l:null),class:"bg-transparent bg-opacity-0 rounded-lg outline-none max-md:w-full",type:"number",label:"Минимальное количество"},null,8,["modelValue"]),i(T,{modelValue:s(V),"onUpdate:modelValue":t[13]||(t[13]=l=>N(V)?V.value=l:null),class:"w-full bg-transparent bg-opacity-0 rounded-lg outline-none",type:"number",label:"Максимальное количество"},null,8,["modelValue"]),i(n,{class:"mt-2 bg-golden rounded-full !p-3 !text-black dark:!text-white"},{default:M(()=>[r(" Сохранить ")]),_:1})],32)])]),_:1})):B("",!0)])}}});export{lt as default};
