import{d as s}from"./entry.C_V07BOh.js";import{a as e,n as o,l as n}from"./nuxt-storage.CgJyI38a.js";const c=s("current-company",{state:()=>({company:{id:"",name:"",address:"",created_at:"",description:"",email:"",logo_file:"",users_count:"",departments_count:"",objects_count:""},news:{title:"",description:"",photo:"",photo_url:""},department:{id:null,name:"",participants:[]},current_department:{id:"",name:"",participants:[]},company_administrators:{},modules:{}}),getters:{current_company(t){return this.company},get_all_company(t){return this.company},get_all_news(t){return this.news},get_all_department(t){return this.department},get_department(t){return this.current_department}},actions:{async loadCurrentCompany(){await e.get("company/current",{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(t=>{this.company=t.data})},async loadCompanyList(t){await e.get(`company/list?page=${t.page}&limit=${t.limit}&query=${t.query}`,{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(a=>{this.company=a.data})},async loadCompany(t){await e.get(`company/${t.id}`,{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(a=>{this.company=a.data})},async loadCompanyAdministrators(t){await e.get(`admin/user/company-admin/list?company_id=${t.company_id}`,{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(a=>{this.company_administrators=a.data})},async createAdministrator(t){await e.post("admin/user/company-admin/create",t.data,{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(a=>{n.success("Администратор успешно добавлен!",{autoClose:1500,theme:"auto"}),this.loadCompanyAdministrators(t)})},async loadModules(t){await e.get("company/modules/list",{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(a=>{this.modules=a.data})},async editModules(t){await e.patch(`company/modules/set-modules/${t.id}`,{modules:t.data},{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(a=>{n.success("Модули успешно изменены!",{autoClose:1500,theme:"auto"}),this.loadCompany({id:t.id})})},async loadDepartmentList(){await e.get("department/",{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(t=>{this.department=t.data})},async loadDepartment(t){await e.get(`department/${t.id}`,{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(a=>{this.current_department=a.data})},async loadNewsList(){await e.get("news/news-list",{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(t=>{this.news=t.data})},async loadNews(t){await e.get(`news/${t.id}`,{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(a=>{this.news=a.data})},async createCompany(t){await e.post("company/create",{name:t.name},{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(a=>{this.company=a.data,n.success("Компания успешно создана",{autoClose:1500,theme:"auto"}),this.loadCompanyList({page:1,limit:5,query:""})}).catch(a=>{n.error(a,{autoClose:1500,theme:"auto"})})},async createDepartment(t){await e.post("department/",{name:t.department.name},{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(a=>{this.department=a.data,this.loadDepartmentList()}).catch(a=>{n.error("Ошибка при создании",{theme:"auto",autoClose:1500})})},async deleteDepartment(t,a){await e.delete(`department/delete/${t.id}`,{headers:{Authorization:`Bearer ${o.localStorage.getData("token")}`}}).then(r=>{n.success("Успешно удалён",{autoClose:1500,theme:"auto"}),this.department=r.data,a.go(-1)})}}});export{c as u};
