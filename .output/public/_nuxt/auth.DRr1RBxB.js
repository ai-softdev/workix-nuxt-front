import{p as B}from"./entry.4BcKMLDh.js";import{a as l,n as a,l as _}from"./nuxt-storage.jjXK-e5k.js";var n={},U={BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0,SSR:!1},P={};const E=Object.create(null),u=e=>{var t;return n||U||((t=globalThis.Deno)==null?void 0:t.env.toObject())||globalThis.__env__||(e?E:globalThis)},o=new Proxy(E,{get(e,t){return u()[t]??E[t]},has(e,t){const s=u();return t in s||t in E},set(e,t,s){const r=u(!0);return r[t]=s,!0},deleteProperty(e,t){if(!t)return!1;const s=u(!0);return delete s[t],!0},ownKeys(){const e=u(!0);return Object.keys(e)}}),O=typeof process<"u"&&P&&"production"||"",m=[["APPVEYOR"],["AWS_AMPLIFY","AWS_APP_ID",{ci:!0}],["AZURE_PIPELINES","SYSTEM_TEAMFOUNDATIONCOLLECTIONURI"],["AZURE_STATIC","INPUT_AZURE_STATIC_WEB_APPS_API_TOKEN"],["APPCIRCLE","AC_APPCIRCLE"],["BAMBOO","bamboo_planKey"],["BITBUCKET","BITBUCKET_COMMIT"],["BITRISE","BITRISE_IO"],["BUDDY","BUDDY_WORKSPACE_ID"],["BUILDKITE"],["CIRCLE","CIRCLECI"],["CIRRUS","CIRRUS_CI"],["CLOUDFLARE_PAGES","CF_PAGES",{ci:!0}],["CODEBUILD","CODEBUILD_BUILD_ARN"],["CODEFRESH","CF_BUILD_ID"],["DRONE"],["DRONE","DRONE_BUILD_EVENT"],["DSARI"],["GITHUB_ACTIONS"],["GITLAB","GITLAB_CI"],["GITLAB","CI_MERGE_REQUEST_ID"],["GOCD","GO_PIPELINE_LABEL"],["LAYERCI"],["HUDSON","HUDSON_URL"],["JENKINS","JENKINS_URL"],["MAGNUM"],["NETLIFY"],["NETLIFY","NETLIFY_LOCAL",{ci:!1}],["NEVERCODE"],["RENDER"],["SAIL","SAILCI"],["SEMAPHORE"],["SCREWDRIVER"],["SHIPPABLE"],["SOLANO","TDDIUM"],["STRIDER"],["TEAMCITY","TEAMCITY_VERSION"],["TRAVIS"],["VERCEL","NOW_BUILDER"],["VERCEL","VERCEL",{ci:!1}],["VERCEL","VERCEL_ENV",{ci:!1}],["APPCENTER","APPCENTER_BUILD_ID"],["CODESANDBOX","CODESANDBOX_SSE",{ci:!1}],["STACKBLITZ"],["STORMKIT"],["CLEAVR"],["ZEABUR"],["CODESPHERE","CODESPHERE_APP_ID",{ci:!0}],["RAILWAY","RAILWAY_PROJECT_ID"],["RAILWAY","RAILWAY_SERVICE_ID"]];function y(){var e,t;if(n)for(const s of m){const r=s[1]||s[0];if(n[r])return{name:s[0].toLowerCase(),...s[2]}}return(n==null?void 0:n.SHELL)==="/bin/jsh"&&((t=(e=globalThis.process)==null?void 0:e.versions)!=null&&t.webcontainer)?{name:"stackblitz",ci:!1}:{name:"",ci:!1}}const g=y();g.name;function i(e){return e?e!=="false":!1}var h;const w=((h=globalThis.process)==null?void 0:h.platform)||"",N=i(o.CI)||g.ci!==!1;var f,C;const b=i(((f=globalThis.process)==null?void 0:f.stdout)&&((C=globalThis.process)==null?void 0:C.stdout.isTTY));i(o.DEBUG);const v=O==="test"||i(o.TEST),M=O==="production";i(o.MINIMAL);const Y=/^win/i.test(w);!i(o.NO_COLOR)&&(i(o.FORCE_COLOR)||(b||Y)&&o.TERM);var R,A;const c=(((A=(R=globalThis.process)==null?void 0:R.versions)==null?void 0:A.node)||"").replace(/^v/,"")||null;Number(c==null?void 0:c.split(".")[0]);const V=globalThis.process||Object.create(null),d={versions:{}};new Proxy(V,{get(e,t){if(t==="env")return o;if(t in e)return e[t];if(t in d)return d[t]}});var T,D;const k=((D=(T=globalThis.process)==null?void 0:T.release)==null?void 0:D.name)==="node";var S,L;const W=!!globalThis.Bun||!!((L=(S=globalThis.process)==null?void 0:S.versions)!=null&&L.bun),F=!!globalThis.Deno,G=!!globalThis.fastly,K=!!globalThis.Netlify,H=!!globalThis.EdgeRuntime;var p;const x=((p=globalThis.navigator)==null?void 0:p.userAgent)==="Cloudflare-Workers",z=!!globalThis.__lagon__,j=[[K,"netlify"],[H,"edge-light"],[x,"workerd"],[G,"fastly"],[F,"deno"],[W,"bun"],[k,"node"],[z,"lagon"]];function Z(){const e=j.find(t=>t[0]);if(e)return{name:e[1]}}const I=Z();I!=null&&I.name;const X=B("authUser",{state:()=>({current_user:{id:null,email:"",password:"",date_of_birth:"",first_name:"",last_name:"",company_id:"",phone:"",photo:"",position:"",role:{},status:"",passport:"",salary:{},permissions:[]},user:{},user_worker:{},permissions:[],exam_active:!1,openNotification:!1,openSettings:!1,my_scroll:0,activeNav:!1}),getters:{get_current_user(e){return this.current_user},get_user(e){return this.user},get_server_domain(){return"https://test-api-buildwithus.ai-softdev.com"}},actions:{async authorize(e,t){await l.post("auth/login",{email:e.email,password:e.password},{headers:{Authorization:`Bearer ${a.localStorage.getData("token")}`}}).then(s=>{a.localStorage.setData("token",s.data.access,M?30:1200),this.loadCurrentUser(),t.push("/base/companies").then(r=>{_.success("Успешная авторизация",{autoClose:1500,theme:"auto"})})}).catch(s=>{t.push("/"),_.error("Неверный логин или пароль",{autoClose:1500,theme:"auto"})})},async loadCurrentUserWorker(){await l.get("user/current-user-worker",{headers:{Authorization:`Bearer ${a.localStorage.getData("token")}`}}).then(e=>{this.user_worker=e.data})},async loadCurrentUser(){await l.get("user/current-user",{headers:{Authorization:`Bearer ${a.localStorage.getData("token")}`}}).then(e=>{this.user=e.data})},async update_my(e){let t=new FormData;const s=this.user;e.user.first_name!==s.first_name&&t.set("first_name",e.user.first_name),e.user.last_name!==s.last_name&&t.set("last_name",e.user.last_name),e.user.phone!==s.phone&&t.set("phone",e.user.phone),e.user.password!==s.password&&t.set("password",e.user.password),e.user.salary!==s.salary&&t.set("salary",e.user.salary),e.user.email!==s.email&&t.set("email",e.user.email),e.user.date_of_birth!==s.date_of_birth&&t.set("date_of_birth",e.user.date_of_birth),e.user.passport!==s.passport&&t.set("password",e.user.password),e.user.department_id!==s.department_id&&t.set("department_id",e.user.department_id),e.user.position.id!==s.position.id&&t.set("position",e.user.position.id),e.update_type!=="current-user"&&e.user.permissions_ids!==s.permissions_id&&t.set("permissions_ids",e.permissions_ids),e.update_type!=="current-user"&&e.user.role_id!==s.role_id&&t.set("role_id",e.user.role_id),typeof e.user.photo=="string"&&e.user.photo!==s.photo&&t.set("photo",e.user.photo),await l.patch("user/current-user",t,{headers:{Authorization:`Bearer ${a.localStorage.getData("token")}`}}).then(r=>{this.user=r.data,_.success("Данные успешно обновлены",{autoClose:1500,theme:"auto"})}).catch(r=>{_.error(r,{autoClose:1500,theme:"auto"})})}}});export{X as u};
